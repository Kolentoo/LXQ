/*! uzai - v0.1.11 - 2017 */

/*!
* 李云 2016-02-29 搜索Jd
* Copyright 2016,http://www.uzai.com/ JoJo
* History
* Author        Date        Descript
* 2016-06-08    JoJo     增加一个订单渠道源ID的传递
*/
function ValidateProductType(a,b){if(!a)return!1;for(var c=!1,d=0;d<a.length;d++)if(a[d]==b||parseInt(a[d],10)==b){c=!0;break}return c}function SearchNew(a){var b="http://search.uzai.com";$.trim(a)||(a=$.trim($("#hdDataReq").attr("data-keyword")));var c=$.trim($("#hdDataReq").attr("data-hostcity"));c||(c="sh"),window.location.href=b+"/"+c+"/SearchResult?keyword="+encodeURI($.trim(a))}function SetParam(a,b){var c=$(a);if(1==b&&(SetMenu(a),SearchParam()),3==b&&($("#txtdate1,#txtdate2").val(""),$("#tipError_date,#tipError_date_cruise").addClass("hide")),301==b&&($("#txtdate1_cruise,#txtdate2_cruise").val(""),$("#tipError_date,#tipError_date_cruise").addClass("hide")),3011==b){var d="cruise"==$.trim($(a).attr("data-tab"))?"_cruise":"";if(!$("#txtdate1"+d).val()&&!$("#txtdate2"+d).val())return $("#tipError_date"+d).removeClass("hide"),!1;$("#tipError_date"+d).addClass("hide"),c.siblings("a").removeClass("on"),c.parents("dd").find("a").eq(0).addClass("on")}var e=$.trim(c.text());"确定"!=e&&"清除"!=e&&(c.siblings("a").removeClass("on"),c.addClass("on")),"清除"==e&&(c.siblings("a").removeClass("on"),c.parents("dd").find("input[type=text]").val(""),c.siblings("a").first().addClass("on")),$("#hdDataReq").attr("data-PageIndex",1),SearchRoute()}function SortRoute(a,b){var c,d=$(a),e="";if(d.parents("li").siblings("li").removeClass("on"),d.parents("li").addClass("on"),(9==b||"txaSatisfy"==$.trim(d.attr("id")))&&(e=d.find(".sort-down").length>=1?0:1,c=d.find(".icon-sort"),0===e?c.removeClass("sort-down").addClass("sort-up"):c.removeClass("sort-up").addClass("sort-down")),(3==b||d.hasClass("sort-item"))&&(e=$.trim(d.attr("data-sort")),"auto"!==e&&(c=d.parents(".price-bar").find(".icon-sort"),"0"===e?c.removeClass("sort-down").addClass("sort-up"):c.removeClass("sort-up").addClass("sort-down"))),$("#hdDataReq").attr("data-DirectionColumnName",b),"auto"!=$.trim(d.attr("data-sort"))){var f=$.trim(d.attr("data-sort"))?$.trim(d.attr("data-sort")):1;$("#hdDataReq").attr("data-Direction",f)}$("#hdDataReq").attr("data-minPrice",$("#txtMinPrice").val()),$("#hdDataReq").attr("data-maxPrice",$("#txtMaxPrice").val()),$("#hdDataReq").attr("data-PageIndex",1),SearchRoute()}function SetMenu(a){var b=$(a),c=b.attr("data-producttypetag");c||(c=$.trim($("#tabMenu .on").attr("data-producttypetag"))),intReg.test(c)||(c=0),$("#tabMenu li").removeClass("on"),b.addClass("on");var d=ValidateProductType(CruisesClass,c),e=ValidateProductType(VisaProductClass,c),f=$("#j_TourItems"),g=$("#j_CruiseItems"),h=$("#j_VisaItems");d||e?(f.hide(),d?(g.show(),h.hide()):e&&(h.show(),g.hide())):(g.hide(),h.hide(),f.show(),f.removeAttr("style").removeClass("hide"),2==c||4==c||8==c||9==c||10==c?f.find("dl:first").hide():f.find("dl:first").show()),$("#hdDataReq").attr("data-productType",c)}function SearchParam(){var a=$("#hdDataReq"),b={};b.keyword=$.trim(a.attr("data-keyword")),b.productType=$.trim(a.attr("data-productType")),b.subType=$.trim(a.attr("data-subType")),"12"==b.productType?b.city=$.trim(a.attr("data-hostcitycode")):b.city=$.trim(a.attr("data-checkedCity")),$.ajax({type:"post",url:"/SearchMenuTab",data:b,cache:!1,async:!1,dataType:"json",success:function(a){if(a){var c=parseInt(a.exists,10);if(0===c)return;(new ShowParamUI).show(a,b.productType)}}})}function ShowParamUI(){var a,b=!1,c=!1,d=!0;this.show=function(e,f){return a=f,b=ValidateProductType(CruisesClass,a),c=ValidateProductType(VisaProductClass,a),d=!b&&!c,$("#j_TourItems,#j_CruiseItems,#j_VisaItems").css("display","none").addClass("hide"),c?(this.showVisaAreaHTML(e.VisaAreaObject),this.showVisaCountryHTML(e.VisaCountryObject),this.showVisaReceiveZoneHTML(e.VisaReceiveZoneObject),this.showVisaTypeHTML(e.VisaTypeObject),$("#j_TourItems,#j_CruiseItems").css("display","none").addClass("hide"),void $("#j_VisaItems").removeAttr("style").removeClass("hide")):b?(this.showStartCityHTML(e.StartCityObject),this.showCruisesRouteHTML(e.CruisesRouteObject),this.showCruisesCompanyHTML(e.CruisesCompanyObject),this.showGodateHTML(e.GoDateObject),this.showJourneyDayHTML(e.JourneyDayObject),this.showCruisePortHTML(e.CruisesPortObject),$("#choiceCruisePort,#choiceCruiseJourneyDay").parents("dl").addClass("hide"),$("#j_TourItems,#j_VisaItems").css("display","none").addClass("hide"),void $("#j_CruiseItems").removeAttr("style").removeClass("hide")):(this.showStartCityHTML(e.StartCityObject),this.showGodateHTML(e.GoDateObject),this.showProductGradeHTML(e.ProductGradeObject),this.showJourneyDayHTML(e.JourneyDayObject),this.showSubTypHTML(e.SubTypeObject),this.showPastAddressHTML(e.PastAddressObject),this.showZYBCityHTML(e,f),$("#choiceSubType,#choicePastAddress,#choiceSuitman").parents("dl").addClass("hide"),$("#j_CruiseItems,#j_VisaItems").css("display","none").addClass("hide"),void $("#j_TourItems").removeAttr("style").removeClass("hide"))},this.showStartCityHTML=function(a){if(!c){var d=$("#hdDataReq"),e=!1,f=b?$("#choiceCruiseCity"):$("#choiceCity");if(f.empty(),a){var g=$.trim(d.attr("data-checkedCity"));$.each(a,function(a,c){var d=document.createElement("a");d.className="pointer",c.CityId==g&&($(d).addClass("on"),e=!0),b?($(d).attr("data-tip","201"),$(d).attr("data-tab","cruise"),$(d).attr("onclick","SetParam(this,201)"),$(d).text(c.CityName+"出发")):($(d).attr("data-tip","2"),$(d).attr("data-tab","tour"),$(d).attr("onclick","SetParam(this,2)"),$(d).text(c.CityName)),$(d).attr("data-val",c.CityId),f.append(d)})}var h=document.createElement("a");h.className="pointer",e||$(h).addClass("on"),$(h).text("全部"),b?($(h).attr("id","txaCruiseCityAll"),$(h).attr("data-tip","201"),$(h).attr("data-tab","cruise"),$(h).attr("onclick","SetParam(this,201)")):($(h).attr("id","txaCityAll"),$(h).attr("data-tip","2"),$(h).attr("data-tab","tour"),$(h).attr("onclick","SetParam(this,2)")),f.prepend(h)}},this.showGodateHTML=function(a){if(!c){var d=b?$("#choiceCruiseGodate"):$("#choiceGodate");d.empty(),a&&$.each(a,function(a,c){var e=document.createElement("a");e.className="pointer",b?($(e).attr("data-tip","301"),$(e).attr("data-tab","cruise"),$(e).attr("onclick","SetParam(this,301)"),$(e).text(c.MonthTxt+"出发")):($(e).attr("data-tip","3"),$(e).attr("data-tab","tour"),$(e).attr("onclick","SetParam(this,3)"),$(e).text(c.MonthTxt)),$(e).attr("data-val",c.MonthVal),d.append(e)});var e=document.createElement("a");e.className="pointer",$(e).addClass("on"),$(e).text("全部");var f=[];f.push('<input type="text" onclick="begdate(\'txtdate1{tag}\',\'txtdate2{tag}\');" id="txtdate1{tag}" class="num-box tc vm" readonly="readonly" /><span class="pl10 pr10">至</span>'),f.push('<input type="text" onclick="enddate(\'txtdate1{tag}\',\'txtdate2{tag}\');" id="txtdate2{tag}" class="num-box tc vm" readonly="readonly" />'),f.push('<a href="javascript:;" data-tip="3011" data-tab="{tag2}" onclick="SetParam(this,3011);" class="confirm tc vm J_searchDateBtn">确定</a>'),f.push('<a href="javascript:;" data-tip="3012" data-tab="{tag2}" onclick="SetParam(this,3012);" class="cancel tc vm">清除</a>'),f.push('<span style="color: Red;" class="hide f12" id="tipError_date{tag}">请选择出发时间</span>');var g,h,i;b?($(e).attr("id","txaCruiseGodateAll"),$(e).attr("data-tip","301"),$(e).attr("data-tab","cruise"),$(e).attr("onclick","SetParam(this,301)"),g=f.join(""),h=_util.string.replaceAll(g,"{tag}","_cruise"),i=_util.string.replaceAll(h,"{tag2}","cruise"),d.append(i)):($(e).attr("id","txaGodateAll"),$(e).attr("data-tip","3"),$(e).attr("data-tab","tour"),$(e).attr("onclick","SetParam(this,3)"),g=f.join(""),h=_util.string.replaceAll(g,"{tag}",""),i=_util.string.replaceAll(h,"{tag2}","tour"),d.append(i)),d.prepend(e)}},this.showProductGradeHTML=function(a){if(!b&&!c){var d=$("#choiceProGrade");d.empty(),a&&$.each(a,function(a,b){var c=document.createElement("a");c.className="pointer",$(c).attr("data-tip","8"),$(c).attr("data-tab","tour"),$(c).attr("title",b.GradeDesc),$(c).attr("onclick","SetParam(this,8)"),$(c).text(b.GradeName),$(c).attr("data-val",b.Grade),d.append(c)}),d.prepend('<a class="on" href="javascript:;" data-tip="8" onclick="SetParam(this,8);" id="txaProductGrade">全部</a>'),d.append('<a href="http://www.uzai.com/Activity/Diamonds" target="_blank" class="blue u">钻级说明</a>')}},this.showJourneyDayHTML=function(a){if(!c){var d=b?$("#choiceCruiseJourneyDay"):$("#choiceJourneyDay");d.empty(),a&&$.each(a,function(a,c){var e=document.createElement("a");e.className="pointer",b?($(e).attr("data-tip","401"),$(e).attr("data-tab","cruise"),$(e).attr("onclick","SetParam(this,401)"),$(e).text(c.Day+"天")):($(e).attr("data-tip","4"),$(e).attr("data-tab","tour"),$(e).attr("onclick","SetParam(this,4)"),$(e).text(c.Day+"天")),$(e).attr("data-val",c.Day),d.append(e)});var e=document.createElement("a");e.className="pointer",$(e).addClass("on"),$(e).text("全部"),b?($(e).attr("id","txaCruiseDayAll"),$(e).attr("data-tip","401"),$(e).attr("data-tab","cruise"),$(e).attr("onclick","SetParam(this,401)")):($(e).attr("id","txaDayAll"),$(e).attr("data-tip","4"),$(e).attr("data-tab","tour"),$(e).attr("onclick","SetParam(this,4)")),d.prepend(e)}},this.showSubTypHTML=function(a){if(!b&&!c){var d=document.createElement("div");$(d).attr("class","theme-items"),$(d).attr("id","choiceSubTypeNav");var e=$("#choiceSubType");e.empty(),a&&(a.length>12&&e.append('<div class="fr"><a href="javascript:;" class="switch fr"><em>展开</em><span class="arrow-box pl5 vm"><i class="arrow-bottom">&nbsp;</i></span></a></div>'),$.each(a,function(a,b){var c=document.createElement("a");c.className="pointer",$(c).attr("data-tip","5"),$(c).attr("data-tab","tour"),$(c).attr("onclick","SetParam(this,5)"),$(c).text(b.Des),a+1>=12&&$(c).attr("class","hide"),$(c).attr("data-val",b.Des),$(d).append(c)})),$(d).prepend('<a id="txtSubTypeAll" href="javascript:;" class="on" data-tip="5" onclick="SetParam(this,5);">全部</a>'),e.append(d)}},this.showPastAddressHTML=function(a){if(!b&&!c){var d=document.createElement("div");$(d).attr("class","theme-items"),$(d).attr("id","choicePastAddressNav");var e=$("#choicePastAddress");e.empty(),a&&(a.length>12&&e.append('<div class="fr"><a href="javascript:;" class="switch fr"><em>展开</em><span class="arrow-box pl5 vm"><i class="arrow-bottom">&nbsp;</i></span></a></div>'),$.each(a,function(a,b){var c=document.createElement("a");c.className="pointer",$(c).attr("data-tip","6"),$(c).attr("data-tab","tour"),$(c).attr("onclick","SetParam(this,6)"),$(c).text(b.Des),a+1>=12&&$(c).attr("class","hide"),$(c).attr("data-val",b.Des),$(d).append(c)})),$(d).prepend('<a id="txtPastAddressAll" href="javascript:;" class="on" data-tip="6" data-tab="tour" onclick="SetParam(this,6);">全部</a>'),e.append(d)}},this.showCruisesRouteHTML=function(a){if(b){var c=$("#choiceCruiseRoute");c.empty(),a&&$.each(a,function(a,b){var d=document.createElement("a");d.className="pointer",$(d).attr("data-tip","9"),$(d).attr("data-tab","cruise"),$(d).attr("onclick","SetParam(this,9)"),$(d).text(b.Des.Length>20?b.Des.substring(0,20)+"...":b.Des),$(d).attr("data-val",b.Des),c.append(d)}),c.prepend('<a href="javascript:;" class="on" id="txaCruisesRouteAll" data-tip="9" data-tab="cruise" onclick="SetParam(this,9);">全部</a>')}},this.showCruisesCompanyHTML=function(a){if(b){var c=$("#choiceCruiseCompany");c.empty(),a&&$.each(a,function(a,b){var d=document.createElement("a");d.className="pointer",$(d).attr("data-tip","10"),$(d).attr("data-tab","cruise"),$(d).attr("onclick","SetParam(this,10)"),$(d).text(b.Des.Length>20?b.Des.substring(0,20)+"...":b.Des),$(d).attr("data-val",b.Des),c.append(d)}),c.prepend('<a href="javascript:;" class="on" id="txaCruisesCompAll" data-tip="10" data-tab="cruise" onclick="SetParam(this,10);">全部</a>')}},this.showCruisePortHTML=function(a){if(b){var c=$("#choiceCruisePort");c.empty(),a&&$.each(a,function(a,b){var d=document.createElement("a");d.className="pointer",$(d).attr("data-tip","11"),$(d).attr("data-tab","cruise"),$(d).attr("onclick","SetParam(this,11)"),$(d).text(b.Des.Length>20?b.Des.substring(0,20)+"...":b.Des),$(d).attr("data-val",b.Des),c.append(d)}),c.prepend('<a href="javascript:;" class="on" id="txaCruisesPortAll" data-tip="11" data-tab="cruise" onclick="SetParam(this,11);">全部</a>')}},this.showVisaAreaHTML=function(a){if(c){var b=$("#choiceVisaArea");b.empty(),a&&$.each(a,function(a,c){var d=document.createElement("a");d.className="pointer",$(d).attr("data-tip","13"),$(d).attr("data-tab","visa"),$(d).attr("data-id",c.Id),$(d).attr("onclick","SetParam(this,13)"),$(d).text(c.Des),$(d).attr("data-val",c.Des),b.append(d)}),b.prepend('<a href="javascript:;" class="on" id="txaVisaAreaAll" data-tip="13" data-tab="visa" onclick="SetParam(this,13);">全部</a>')}},this.showVisaCountryHTML=function(a){if(c){var b=$("#choiceVisaCountry");b.empty(),a&&$.each(a,function(a,c){var d=document.createElement("a");d.className="pointer",$(d).attr("data-tip","14"),$(d).attr("data-tab","visa"),$(d).attr("data-id",c.CountryId),$(d).attr("onclick","SetParam(this,14)"),$(d).text(c.CountryName),$(d).attr("data-val",c.CountryName),b.append(d)}),b.prepend('<a href="javascript:;" class="on" id="txaVisaCountryAll" data-tip="14" data-tab="visa" onclick="SetParam(this,14);">全部</a>')}},this.showVisaReceiveZoneHTML=function(a){if(c){var b=$("#choiceVisaReceiveZone");b.empty(),a&&$.each(a,function(a,c){var d=document.createElement("a");d.className="pointer",$(d).attr("data-tip","15"),$(d).attr("data-tab","visa"),$(d).attr("onclick","SetParam(this,15)"),$(d).text(c.Des),$(d).attr("data-val",c.Des),b.append(d)}),b.prepend('<a href="javascript:;" class="on" id="txaVisaZoneAll" data-tip="15" data-tab="visa" onclick="SetParam(this,15);">全部</a>')}},this.showVisaTypeHTML=function(a){if(c){var b=$("#choiceVisaType");b.empty(),a&&$.each(a,function(a,c){var d=document.createElement("a");d.className="pointer",$(d).attr("data-tip","16"),$(d).attr("data-tab","visa"),$(d).attr("data-id",c.Id),$(d).attr("onclick","SetParam(this,16)"),$(d).text(c.Des),$(d).attr("data-val",c.Des),b.append(d)}),b.prepend('<a href="javascript:;" class="on" id="txaVisaTypeAll" data-tip="16" data-tab="visa" onclick="SetParam(this,16);">全部</a>')}},this.showZYBCityHTML=function(a,b){if("12"==b.toString()){var c=a.ZYBCityBase;a.ZYBCityBaseQuick;$("#j_zybCityTitle,#j_zybCityContent").html(""),$.each($("#j_zybCity a[data-view]"),function(a,b){$(b).remove()}),$("#j_zybCity [data-last]").text("").css("display",""),$("#j_zybCity #txaCityAll").removeClass("on"),$("#choiceCityZYB .switch-box em").text("展开"),$("#choiceCityZYB .switch-box i").attr("class","arrow-bottom"),$("#choiceCityZYB").css("display","block").removeClass("hide"),$.each(a.ZYBCityBaseQuick.DepartureCityList||[],function(a,b){$("#j_zybCity a[data-last]").before($("<a>",{href:"javascript:;","data-tab":"tour",onclick:"SetParam(this,2)","class":"hot-list ",text:b.LocationNameReadOnly,"data-view":""}))});var d=a.StartCityName,e=0;$.each(a.ZYBCityBaseQuick.DepartureCityList||[],function(a,b){b.LocationNameReadOnly==d&&(e=a+1)}),$("#j_zybCity a:eq("+e+")").addClass("on"),$.each(c||[],function(a,b){$("#j_zybCityTitle").append($("<li>",{"class":(0===a?"on ":"")+"fl",text:b.title}));var c=$("<div>",{"class":"item item"+(a+1)+" "+(0!==a?"hide":"")});$("#j_zybCityContent").append(c),$.each(b.DepartureCityList||[],function(a,b){c.append($("<a>",{href:"javascript:;",text:b.LocationNameReadOnly}))})}),$("#j_jpbox a.on").removeClass("on"),$("#j_jpbox a:eq(0)").addClass("on")}else $("#choiceCityZYB").css("display","none").addClass("hide")}}function SearchRoute(){var a=$("#hdDataReq"),b={};b.domain=$.trim(a.attr("data-hostcity")),b.keyword=$.trim(a.attr("data-keyword")),b.productType=$.trim(a.attr("data-productType")),b.CurrentPageIndex=$.trim($("#hdDataReq").attr("data-PageIndex")),b.DirectionColumnName=$.trim(a.attr("data-DirectionColumnName")),b.Direction=$.trim(a.attr("data-Direction")),b.minPrice=$.trim($("#txtMinPrice").val()),b.maxPrice=$.trim($("#txtMaxPrice").val()),b.Promotion=$("#chkischeap").is(":checked")?1:0,b.UZXU=$("#chkisspike").is(":checked")?1:0,b.HalfTravel=$("#chkbzz").is(":checked")?1:0,0===parseInt(b.minPrice,10)&&0===parseInt(b.maxPrice,10)?$("#txtMaxPrice,#txtMinPrice").val(""):(0===parseInt(b.minPrice,10)||0===parseInt(b.maxPrice,10))&&(0===parseInt(b.minPrice,10)&&$("#txtMinPrice").val("0"),0===parseInt(b.maxPrice,10)&&$("#txtMaxPrice").val(""));var c=$("#j_TourItems"),d=$("#j_CruiseItems"),e=$("#j_VisaItems"),f=$("#j_zybCity").find("a.on").text().trim();c.get(0)&&c.is(":visible")?(b.city=$.trim($("#choiceCity a.on").attr("data-val")),b.date=$.trim($("#choiceGodate a.on").attr("data-val")),b.beginDate=$.trim($("#txtdate1").val()),b.endDate=$.trim($("#txtdate2").val()),b.productGrade=$.trim($("#choiceProGrade a.on").attr("data-val")),b.journeyDay=$.trim($("#choiceJourneyDay a.on").attr("data-val")),b.subType=$.trim($("#choiceSubTypeNav a.on").attr("data-val")),b.pastAddress=$.trim($("#choicePastAddressNav a.on").attr("data-val")),b.suitman=$.trim($("#choiceSuitman a.on").attr("data-val")),b.jpbox=$.trim($("#j_jpbox a.on").attr("data-val")),b.zybcity="全部"==f?"":f):d.get(0)&&d.is(":visible")?(b.city=$.trim($("#choiceCruiseCity a.on").attr("data-val")),b.cruiseRoute=$.trim($("#choiceCruiseRoute a.on").attr("data-val")),b.cruiseCompany=$.trim($("#choiceCruiseCompany a.on").attr("data-val")),b.date=$.trim($("#choiceCruiseGodate a.on").attr("data-val")),b.beginDate=$.trim($("#txtdate1_cruise").val()),b.endDate=$.trim($("#txtdate2_cruise").val()),b.cruisePort=$.trim($("#choiceCruisePort a.on").attr("data-val")),b.journeyDay=$.trim($("#choiceCruiseJourneyDay a.on").attr("data-val"))):e.get(0)&&e.is(":visible")&&(b.visaArea=$.trim($("#choiceVisaArea a.on").attr("data-val")),b.visaCountry=$.trim($("#choiceVisaCountry a.on").attr("data-val")),b.visaReceiveZone=$.trim($("#choiceVisaReceiveZone a.on").attr("data-val")),b.visaType=$.trim($("#choiceVisaType a.on").attr("data-id"))),$(".res-nocontent").hide(),$("#dvwait").show(),$("#ulliTour,#ulliVisa").empty(),$.ajax({type:"post",url:"/SearchRoute",data:b,cache:!1,async:!1,dataType:"json",success:function(a){(new ShowRouteUI).show(a,b.productType)}}),$("#dvwait").hide(),0===$("#ulliTour:visible,#ulliVisa:visible").find("li").length&&$(".res-nocontent").show(),uzLazy(["j_mainRoute"])}function ShowRouteUI(){var a,b=!1,c=!1,d=!0;this.show=function(e,f){a=f,b=ValidateProductType(CruisesClass,a),c=ValidateProductType(VisaProductClass,a),d=!b&&!c,c?(this.ShowVisaRouteHTML(e.RouteObject),$("#ulliTour").css("display","none").addClass("hide"),$("#ulliVisa").removeAttr("style").removeClass("hide"),$("#divsortlist").css("display","none").addClass("hide")):b?(this.ShowTourOrCruiseRouteHTML(e.RouteObject),$("#ulliVisa").css("display","none").addClass("hide"),$("#ulliTour").removeAttr("style").removeClass("hide"),$("#divsortlist").removeAttr("style").removeClass("hide")):(this.ShowTourOrCruiseRouteHTML(e.RouteObject),$("#ulliVisa").css("display","none").addClass("hide"),$("#ulliTour").removeAttr("style").removeClass("hide"),$("#divsortlist").removeAttr("style").removeClass("hide")),AddElement(),this.ShowTabChecked(),this.showPageHTML(e.PageObject)},this.ShowVisaRouteHTML=function(a){if(c){$("#ulliTour").empty().addClass("hide");var b=$("#ulliVisa");b.empty(),a&&$.each(a,function(a,c){b.append("<li data-pid='"+c.ProductId+"' data-price='"+parseInt(c.MinPrice,10).toFixed(0)+"' class='list-item clearfix'><div class='sort-line-sidebar tc fr'><p class='price-mod red'><i class='price'>￥<em class='f20'>"+parseInt(c.MinPrice,10).toFixed(0)+"</em></i>起</p></div><div class='sort-line-main clearfix'><div class='sort-line-pic fl'><a target='_blank' href='"+c.ProductURL+"' title='"+c.ProductNameLight+"'><img alt='' data-original='"+c.ProductVisa.ProductPic+"' src='//r01.uzaicdn.com/content/m/images/common/gray.gif' style='display: inline;' /></a></div><dl class='sort-line-cont f999 fl'><dt class='f14'><a target='_blank' href='"+c.ProductURL+"'>"+c.ProductNameLight+"</a></dt><dd class='f666 pt5'><label class='product-type product-gty mr5'>[签证]</label>编号:"+c.ProductCode+"<span class='f999 gap'>签证类型："+c.ProductVisa.TypeName+"</span></dd><dd class='pt10'><span class='f999'>办理时长：<em class='f666'>"+c.ProductVisa.ProcTime+"</em></span><span class='f999 gap'>面试：<em class='f666'>"+c.ProductVisa.FaceTypeName+"</em></span><span class='f999 gap'>签证有效期：<em class='f666'>"+c.ProductVisa.Valid+"</em></span></dd><dd class='pt5'><span class='f666'>入境次数：<em>"+(-1==c.ProductVisa.EntryNum?"多次":c.ProductVisa.EntryNum+" 次")+"</em></span><span class='f999 gap'>最长停留时间<em class='f666'>"+c.ProductVisa.RemainTime+"</em></span></dd></dl></div></li>")})}},this.ShowTourOrCruiseRouteHTML=function(a){if(!c){$("#ulliVisa").empty().addClass("hide");var b=$("#ulliTour");if(b.empty(),a){var d="";$.each(a,function(a,b){if(d+="<li data-pid='"+b.ProductId+"' data-price='"+b.MinPrice+"' class='list-item clearfix'>",b.MinPrice<=0)d+="<div class='sort-line-sidebar tc fr'><p class='price-mod gray'><span>价格请电询</span></p><p class='red'><span>1010-9898"+(11==b.ProductType?"":"-4")+"</span></p></div>";else{var c=0;$.trim(b.CheapTag)&&"正常"!==b.CheapTag&&(c=parseInt(b.CheapTag.replace("减￥",""),10)),d+="<div class='sort-line-sidebar tc fr'>",c>0&&(d+="<p class='price-old-mod'>原价<u class='price'>￥<em class='f12'>"+parseFloat(b.MinPrice+c).toFixed(0)+"</em></u></p>"),d+="<a class='price-mod block' href='javascript:;' target='_blank'><i class='price'>￥<em class='f20'>"+parseFloat(b.MinPrice).toFixed(0)+"</em></i>起</a>",c>0&&(d+="<p class='tab-favorable'><span class='tab-hd'>减</span><i class='tab-bd'>￥"+c+"</i></p>"),d+="</div>"}d+="<div class='sort-line-main clearfix'>";var e="product-gty";"跟团游"==b.UzaiTravelClassName?e="product-gty":"自由行"==b.UzaiTravelClassName?e="product-zzy":"自驾游"==b.UzaiTravelClassName?e="product-zjy":"公司游"==b.UzaiTravelClassName?e="product-gsy":"当地游"==b.UzaiTravelClassName?e="product-ddy":"邮轮"==b.UzaiTravelClassName&&(e="product-yl");var f="";f=3==b.ProductType||8==b.ProductType||9==b.ProductType||11==b.ProductType||12==b.ProductType?"【不限出发地】":16==b.ProductType?"【"+b.AbroadStartCity+"出发】":"【"+b.StartCityName+"出发】";var g=b.ProductURL;if("manager"==$.trim($("#hdDataReq").attr("data-uztype"))){var h=_util.url.get("userId"),i=_util.url.get("did");b.ProductURL.toLowerCase().lastIndexOf("youlun/p-")>=1&&(g="http://sh.uzai.com/tour-"+b.ProductId+".html"),"product-yl"==e||"product-gty"==e?g="http://manager.uzai.com/Manager/MenuPages/OffLine/NewOffLineQueryProduct.aspx?productURL="+encodeURIComponent(g)+"&uztype=manager&userId="+h+"&did="+i:"product-zzy"==e&&(g="http://manager.uzai.com/Manager/MenuPages/OffLine/NewOffLineTripQueryProduct.aspx?productURL="+encodeURIComponent(g)+"&uztype=manager&userId="+h+"&did="+i)}d+="<a class='sort-line-pic block fl' target='_blank' href='"+g+"' title='"+b.ProductName+"'><img alt='' data-original='"+b.RandomImgURL+"' src='//r01.uzaicdn.com/content/m/images/common/gray.gif' style='display: inline;' /></a>",d+="<dl class='sort-line-cont f999 fl'><dt class='f14'>",d+="<a data-tag='title' data-id='"+b.ProductId+"' data-type='"+e+"' target='_blank' href='"+g+"'>"+f+b.ProductName.replace("<","&lt;").replace(">","&gt;")+"</a>"+b.ShowIconHTML+"</dt><dd class='f666 pt5'><label class='product-type "+e+" mr5'>["+b.UzaiTravelClassName+"]</label>"+b.Content+"</dd>",$.trim(b.TreeJourney)&&(d+="<dd class='summary-bar mt5'><span class='f999'>"+("自由行"==b.UzaiTravelClassName?"推荐景点":"行程景点")+"：<em class='f666'>"+b.TreeJourney+"</em></span></dd>"),d+="<dd class='date-bar f666 mt5'><span class='f999'>出发班期：</span><em>"+b.GoDate+"</em><span class='btn-switch pointer ml10 btn-switch-on'><em class='switch-cont vm'>更多</em><span class='arrow-mod songti lh1 ml5 vm'><em>◆</em><i>◆</i></span></span></dd>",d+="</dl></div></li>"}),b.append(d)}}},this.ShowTabChecked=function(){$("#tabChecked").hide(),$("#tabChecked span[data-option=main]").empty();var b="<label class='tag-item'><span class='item-main pl5 vm'><q>${txt}</q>：<em class='red'>${val}</em></span><span class='tag-close pointer vm'><i class='close-icon'>×</i></span></label>",c=$("#j_TourItems"),d=$("#j_CruiseItems"),e=$("#j_VisaItems"),f=c.get(0)&&c.is(":visible"),g=f?$.trim($("#choiceCity a.on").text()):$.trim($("#choiceCruiseCity a.on").text()),h=$.trim($("#j_zybCity a.on").text()),i=f?$.trim($("#choiceGodate a.on").text()):$.trim($("#choiceCruiseGodate a.on").text()),j=f?$.trim($("#txtdate1").val()):$.trim($("#txtdate1_cruise").val()),k=f?$.trim($("#txtdate2").val()):$.trim($("#txtdate2_cruise").val()),l=f?$.trim($("#choiceJourneyDay a.on").text()):$.trim($("#choiceCruiseJourneyDay a.on").text()),m=$.trim($("#choiceSubTypeNav a.on").text()),n=$.trim($("#choicePastAddressNav a.on").text()),o=$.trim($("#choiceSuitman a.on").text()),p=$.trim($("#txtMinPrice").val()),q=$.trim($("#txtMaxPrice").val()),r=$.trim($("#j_jpbox a.on").text());"0"==q&&$("#txtMaxPrice").val("");var s="",t=$.trim($("#choiceCruiseRoute a.on").text()),u=$.trim($("#choiceCruiseCompany a.on").text()),v=$.trim($("#choiceCruisePort a.on").text()),w="";if(f)return 2==a||4==a||8==a||9==a||10==a||("全部"!==g&&"12"!=a.toString()&&(s+=b.replace("${txt}","出发城市").replace("${val}",g)),"全部"!=h&&"12"==a.toString()&&(s+=b.replace("${txt}","出发城市").replace("${val}",h))),j&&!k?s+=b.replace("${txt}","出发日期").replace("${val}",j+"以后"):!j&&k?s+=b.replace("${txt}","出发日期").replace("${val}",k+"之前"):j&&k?s+=b.replace("${txt}","出发日期").replace("${val}",j+" ~ "+k):"全部"!==i&&(s+=b.replace("${txt}","出发日期").replace("${val}",i)),p&&!q?s+=b.replace("${txt}","价格").replace("${val}",p+"元以上"):!p&&q?s+=b.replace("${txt}","价格").replace("${val}",q+"元以下"):p&&q&&(s+=b.replace("${txt}","价格").replace("${val}",p+"元 ~ "+q+"元")),"全部"!==l&&(s+=b.replace("${txt}","行程天数").replace("${val}",l)),"全部"!==m&&(s+=b.replace("${txt}","分类主题").replace("${val}",m)),"全部"!==n&&(s+=b.replace("${txt}","途经景点").replace("${val}",n)),"全部"!==o&&(s+=b.replace("${txt}","适合人群").replace("${val}",o)),"全部"!==r&&"12"==a.toString()&&(s+=b.replace("${txt}","产品类型").replace("${val}",r)),void(s&&($("#tabChecked span[data-option=main]").append(s),$("#tabChecked").show(),this.CloseCheckedTab()));if(d.get(0)&&d.is(":visible"))return"全部"!==g&&(w+=b.replace("${txt}","出发城市").replace("${val}",g)),"全部"!==t&&(w+=b.replace("${txt}","航线目的地").replace("${val}",t)),"全部"!==u&&(w+=b.replace("${txt}","邮轮公司").replace("${val}",u)),j&&!k?w+=b.replace("${txt}","出发日期").replace("${val}",j+"以后"):!j&&k?w+=b.replace("${txt}","出发日期").replace("${val}",k+"之前"):j&&k?w+=b.replace("${txt}","出发日期").replace("${val}",j+" ~ "+k):"全部"!==i&&(w+=b.replace("${txt}","出发日期").replace("${val}",i)),p&&!q?w+=b.replace("${txt}","价格").replace("${val}",p+"元以上"):!p&&q?w+=b.replace("${txt}","价格").replace("${val}",q+"元以下"):p&&q&&(w+=b.replace("${txt}","价格").replace("${val}",p+"元 ~ "+q+"元")),"全部"!==v&&(w+=b.replace("${txt}","出发港口").replace("${val}",v)),"全部"!==l&&(w+=b.replace("${txt}","行程天数").replace("${val}",l)),void(w&&($("#tabChecked span[data-option=main]").append(w),$("#tabChecked").show(),this.CloseCheckedTab()));if(e.get(0)&&e.is(":visible")){var x=$.trim($("#choiceVisaArea a.on").text()),y=$.trim($("#choiceVisaCountry a.on").text()),z=$.trim($("#choiceVisaReceiveZone a.on").text()),A=$.trim($("#choiceVisaType a.on").text()),B="";return"全部"!==x&&(B+=b.replace("${txt}","地区").replace("${val}",x)),"全部"!==y&&(B+=b.replace("${txt}","国家").replace("${val}",y)),"全部"!==z&&(B+=b.replace("${txt}","所属领区").replace("${val}",z)),"全部"!==A&&(B+=b.replace("${txt}","签证类型").replace("${val}",A)),p&&!q?B+=b.replace("${txt}","价格").replace("${val}",p+"元以上"):!p&&q?B+=b.replace("${txt}","价格").replace("${val}",q+"元以下"):p&&q&&(B+=b.replace("${txt}","价格").replace("${val}",p+"元 ~ "+q+"元")),void(B&&($("#tabChecked span[data-option=main]").append(B),$("#tabChecked").show(),this.CloseCheckedTab()))}},this.CloseCheckedTab=function(){$("#tabChecked i.close-icon").unbind("click").bind("click",function(){var a,b=$.trim($(this).parents("label").find("q").text()),c=$("#j_TourItems"),d=$("#j_CruiseItems"),e=$("#j_VisaItems");return a=d.is(":visible")?d.children("dl").children("dt"):e.is(":visible")?e.children("dl").children("dt"):c.children("dl").children("dt"),"价格"===b?($("#txtMinPrice,#txtMaxPrice").val(""),SortRoute(this,3),!1):void(a.length>=1&&$.each(a,function(a,c){if($.trim($(this).text())==b){var d=$(this).siblings("dd").find("div[class*=-items]").find("a");d.eq(0).get(0)?d.removeClass("on").eq(0).addClass("on").click():$(this).siblings("dd").find("a").removeClass("on").eq(0).addClass("on").click()}}))})},this.showPageHTML=function(a){return a&&0!==parseInt(a.TotalCount,10)?($("#tabChecked i[data-total=all]").text(a.TotalCount),$("#hjPages em[data-total=all]").text(a.TotalCount),$("#hjPages em[data-total=current]").text(a.CurrentPageIndex+"/"+a.PageCount),$("#hjPages span[data-total=nav]").html(a.PageHtmlToFoot),$("#hjPagesThumb").html(a.PageHtmlToHead),void $("#hjPages,#hjPagesThumb").show()):($("#tabChecked i[data-total=all]").text(0),$("#hjPages em[data-total=all]").text(0),$("#hjPages em[data-total=current]").text("1/0"),$("#hjPages em[data-total=nav],#hjPagesThumb").empty(),void $("#hjPages,#hjPagesThumb").hide())}}function page(a){$("#hdDataReq").attr("data-PageIndex",a),SearchRoute()}function SearchFold(){var a=$(".choice-items"),b=(a.find(".switch"),a.find(".more-switch"));a.on("click",".switch",function(){var a=$(this),b=a.find("em"),c=a.find("i");c.hasClass("arrow-bottom")?(b.text("收起"),a.parent().next().find(".hide").css({display:"inline-block"}),c.attr("class","arrow-top")):(b.text("展开"),a.parent().next().find(".hide").hide(),c.attr("class","arrow-bottom"))}),b.on("click",function(){var a=$(this),b=a.find(".switch-cont"),c=a.find(".arrow-mod"),d=a.parents(".choice-items");c.hasClass("on")?(b.text("更多筛选条件"),d.children("dl.hide").hide(),c.removeClass("on")):(b.text("收起筛选条件"),d.children("dl.hide").show(),c.addClass("on"))}),$("#j_sortBar").find(".price-bar").on("mouseenter",function(){var a=$(this);a.addClass("price-bar-on")}).on("mouseleave",function(){var a=$(this);a.removeClass("price-bar-on")})}function begdate(a,b){WdatePicker({errDealMode:1,el:a,dateFmt:"yyyy/MM/dd",minDate:"%y-%M-#{%d+1}",maxDate:"#F{$dp.$D('"+b+"')||'"+$.trim($("#hdDataReq").attr("data-maxDate"))+"'}"})}function enddate(a,b){var c="%y-%M-{%d+1}";$("#"+a).val()&&(c="#F{$dp.$D('"+a+"')}"),WdatePicker({errDealMode:1,el:b,dateFmt:"yyyy/MM/dd",minDate:c,maxDate:$.trim($("#hdDataReq").attr("data-maxDate"))})}function ShowProCalendar(){var a=$("#j_mainRoute");a.on("click",".btn-switch",function(){var a=$(this),b=a.children(".arrow-mod"),c=a.parents(".list-item"),d=c.attr("data-pid"),e=c.children(".after-calendar");if(e.get(0)||(c.append('<div class="after-calendar ca-norm ca-norm-multi"></div>'),e=c.children(".after-calendar")),b.hasClass("on"))return a.removeClass("btn-switch-on"),b.removeClass("on"),void e.hide();a.addClass("btn-switch-on"),b.addClass("on"),e.show();var f=e.find(".j_jsonMultiCalendarWrap");f.get(0)||e.jsonMultiCalendar({jsonpUrl:"http://sh.uzai.com/ashx/ashx_Calendar.ashx?pid="+d+"&type=1",isSmart:!0,latestDate:"",extCallBack:function(a,b){e.find(".item").on("click",function(){var a=$(this),b=a.hasClass("item-expiry")||a.hasClass("item-gray");if(!b){a.attr("data-year"),a.attr("data-month"),a.attr("data-day")}})},preCallback:function(a,b){}})})}function AddElement(){if("manager"==_util.url.get("uztype")){_util.url.get("userId");$("#ulliTour li").each(function(){var a=$(this),b=a.find("a[data-tag='title']"),c=$.trim(b.attr("data-stype"));if(c){var d=$("<p class='pt10'>"+c+"</p>");a.find(".sort-line-sidebar").append(d)}var e=$("<div class='zysx pt10'><a href=\"javascript:;\" style='color:#36c;' class=\"J_addAjax\" data-id='"+$.trim(b.attr("data-id"))+"'>销售注意事项</a></div>");a.find(".sort-line-sidebar").append(e)}),$(".zysx").css("z-index","1"),$(".J_itemtype").css("z-index","2"),$("body").append("<style>.c_ptext{border:1px solid #F9CC9F;position:absolute;top:28px;right:0;padding:10px;width:500px;background:#FFFCF8;display:none;line-height:1.4;text-align: left;}.zysx{float:right;margin-top:10px;position:relative;}</style>"),$(".J_addAjax").on("mouseover",function(a){var b=$(a.target);if(b.parent().css("z-index","99"),
b.nextAll(".J_Ptext").length>0)b.nextAll(".J_Ptext").find("p").length>0&&b.next().show();else{var c=$.trim($(this).attr("data-id")),d=$("<div class='c_ptext J_Ptext'></div>"),e="";b.parent().append(d),$.ajax({type:"GET",url:"http://aj.uzai.com/Product.ashx?ProductID="+c+"&rad="+Math.random(),dataType:"jsonp",jsonp:"orderJsonData",success:function(a){if(a[0].ProductNotice&&a[0].ProductNotice){for(var c=a[0].ProductNotice.split("#$%"),d=0;d<c.length;d++)e+="<p style='padding:3px 0;'>"+c[d]+"</p>";b.next().html(e).show()}}})}}),$(".J_addAjax").on("mouseout",function(){$(this).next().hide(),$(".zysx").css("z-index","1"),$(".J_itemtype").css("z-index","2")})}}function searchGuessLike(){window.guessLike||_util.file.load(_uzw.domain.cdnRandom()+"/content/v1/scripts/com/guesslike.js",function(){guessLike("j_guessLikeContainer")})}function ziyouban(){var a=$("#j_TourItems"),b=a.find(".recommend-city").find(".switch"),c=a.find(".zyb-city-box"),d=$("#j_jpbox").find(".pointer"),e=$("#j_zybCity");$("#j_zybCityContent").on("click","a",function(){var a=$(this),b=a.text().trim(),d=a.siblings(),f=a.parent(),g=f.siblings();c.find(".hot-list").removeClass("on");var h=e.find("a:not([class*='hide'])").map(function(a,c){var d=$(c).text().trim();return b===d&&""!==d?c:void 0});e.find("a").removeAttr("data-last").removeClass("on"),h.length>0?(h.addClass("on").attr("data-last",""),e.find(".hide").removeClass("on").removeAttr("data-last")):e.find(".hide").text(b).addClass("on").show().attr("data-last","").css({display:"inline-block"}),$(a).closest("dd").find("[data-last]").trigger("click"),a.addClass("on"),d.removeClass("on"),g.find("a").removeClass("on")}),$("#j_zybCity").on("click","a",function(){$(".bd-con").find(".item").children("a").removeClass("on")}),b.on("click",function(){$(".other-city-box").toggle()});var f=$(".jwct").siblings();$(".jwct").on("click",function(){$(".recommend-city").children(".switch-box").show(),$(".recommend-city").children(".hot-city-box").hide(),$(".product-label").show(),$(".zyb-city-box").show(),$("#choiceCity").closest("dl").hide(),$("#choiceCityZYB").closest("dl").show()}),f.on("click",function(){$(".product-label").hide(),$(".recommend-city").children(".switch-box").hide(),$(".recommend-city").children(".hot-city-box").show(),$(".other-city-box").hide(),$(".zyb-city-box").hide(),$("#choiceCity").closest("dl").show(),$("#choiceCityZYB").closest("dl").hide()}),d.on("click",function(){var a=$(this),b=a.siblings();a.addClass("on"),b.removeClass("on")})}function productInterest(a){if(_uzw.user.userid){var b={userId:_uzw.user.userid,city:0,channel:1,type:6,productIds:a};$.ajax({type:"post",url:_uzw.domain.wapi+"/api/UzaiInterest/InsertUserInterest",data:b,dataType:"jsonp",success:function(a){},error:function(){}})}}var intReg=/^[0-9]|[1-9][0-9]*$/,floatReg=/^[0-9]+(.[0-9]{1,3})?$/,ProductClass=new Array("1","2","3","4","5","8","9","10","11"),CruisesClass=new Array("6"),VisaProductClass=new Array("7");try{document.domain="uzai.com"}catch(e){}$(function(){uzLazy(["j_mainRoute"]),SearchFold(),ShowProCalendar(),(new ShowRouteUI).CloseCheckedTab(),AddElement(),searchGuessLike(),_uzw.ui.tab("other-city-tab"),ziyouban(),$("#ulliTour").on("click",".list-item",function(){var a=$(this);productInterest(a.attr("data-pid"))})});
//# sourceMappingURL=/sourcemaps/content/v1/scripts/search/jsearch.js.map