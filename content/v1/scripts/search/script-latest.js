/*! uzai - v0.1.11 - 2017 */

"use strict";function reloadpage(a){var b="http://search.uzai.com";$.trim(a)||(a=$.trim($("#hdDataReq").attr("data-keyword")));var c=$.trim($("#hdDataReq").attr("data-hostcity"));c||(c="sh"),window.location.href=b+"/"+c+"/SearchResult?keyword="+encodeURI($.trim(a))}function initChoiceItems(a){var b=a.find(".choice-items");b.each(function(){var a=$(this);a.height()>40&&!a.hasClass("items-cut")&&!a.hasClass("items-cut-close")&&(a.addClass("items-cut"),a.before('<span class="btn-switch pointer blue fr">更多</span>'))})}function contentSwitch(){var a=$("#j_productTypeTab"),b=a.find(".bd").children(".item");initChoiceItems(b.eq(0)),a.find(".choice-section").off("click",".btn-switch"),a.find(".choice-section").on("click",".btn-switch",function(){var a=$(this),b=a.siblings(".choice-items");a.hasClass("on")?(a.removeClass("on").text("更多"),b.addClass("items-cut")):(a.addClass("on").text("收起"),b.removeClass("items-cut"),b.addClass("items-cut-close"))}),a.off("click",".btn-bar .btn-switch"),a.on("click",".btn-bar .btn-switch",function(){var a=$(this),b=new App,c=a.find(".switch-cont"),d=a.parents(".btn-bar").siblings(".choice-section").eq(3).nextAll(".choice-section"),e=a.parents(".item");a.hasClass("on")?(a.removeClass("on"),c.text("更多筛选条件"),d.addClass("hide")):(a.addClass("on"),c.text("收起筛选条件"),d.removeClass("hide"),initChoiceItems(e)),b.filterbjarea()})}function saleCountdown(){var a=$("#j_searchSide").find(".side-pick-list").find(".timer"),b=_util.apis.getServerDate(),c=0,d=function(a,b){var c,e=parseInt(Date.parse(a.attr("data-endtime").replace(/-/g,"/")),10),f=a.find(".num-day"),g=a.find(".num-hour"),h=a.find(".num-minute"),i=a.find(".num-second"),j=e-b,k=function(a){var b=a/1e3,c=Math.floor(b/60),d=Math.floor(c/60),e=Math.floor(d/24);f.text(e),g.text(d%24),h.text(c%60),i.text(Math.floor(b%60))};b+=1e3,j>0?k(j):(a.parents(".list-item").remove(),clearTimeout(c)),c=setTimeout(function(){d(a,b)},1e3)};a.each(function(){var a=$(this);b.done(function(b){b=b.replace(/-/g,"/"),c=parseInt(Date.parse(b),10),d(a,c)})})}function multiCalendar(a,b){$(a).on("focus",function(){var a=$(this);$(".after-calendar").hide();var c=a.parent(),d=c.find(".after-calendar"),e="",f="";if(!d.get(0)){a.after('<div class="after-calendar ca-norm ca-norm-multi"></div>'),d=c.find(".after-calendar");var g={jsonpUrl:"",latestDate:"",extCallBack:function(g,h){var i=a.attr("data-selDate")||"",j=d.find(".item"),k=j.length,l="",m="",n="",o="",p="",q="";if(i){l=i.split("|"),m=l.length;for(var r=0;k>r;r++)for(var s=j.eq(r),t=parseInt(s.attr("data-year"),10),u=parseInt(s.attr("data-month"),10),v=parseInt(s.attr("data-day"),10),w=0;m>w;w++)n=l[w].split("-"),o=parseInt(n[0],10),p=parseInt(n[1],10),q=parseInt(n[2],10),o>t?s.addClass("item-disabled"):t===o&&(p>u?s.addClass("item-disabled"):u===p&&(q>v?s.addClass("item-disabled"):v===q&&s.addClass("item-sel")))}j.on("click",function(){var b=$(this),c=b.attr("data-year"),g=b.attr("data-month"),h=b.attr("data-day"),j=b.hasClass("item-expiry")||b.hasClass("item-gray")||b.hasClass("item-disabled"),k=d.find(".item-sel").length;!j&&2>k&&(k>0&&(e+="-",i+="|"),b.addClass("item-sel").prevAll(".item").addClass("item-disabled"),b.parent("tr").prevAll("tr").find(".item").addClass("item-disabled"),b.parents(".calendar-mod").prev(".calendar-mod").find(".item").addClass("item-disabled"),e+=g+"月"+h+"日",i+=c+"-"+g+"-"+h,f=i,a.attr("data-selDate",i))}),d.on("click",".btn-reset",function(){j.removeClass("item-sel").removeClass("item-disabled"),e="",i="",a.val("").removeClass("choice-on").attr("data-selDate","")}).on("click",".btn-confirm",function(){a.val(e).addClass("choice-on").parent().siblings(".choice-item").removeClass("choice-on"),d.hide(),c.css({"z-index":"auto"}),a.closest("dl").find(".choice-on[data-val]").removeClass("choice-on"),""===e?(a.removeClass("choice-on"),a.closest("dl").find("[data-val]:eq(0)").addClass("choice-on")):a.addClass("choice-on"),f=f,null!==b&&b()})},preCallback:function(a,b){}};d.jsonMultiCalendar(g).append('<p class="calendar-btn-bar tc"><input type="button" value="清除" class="btn-reset yahei" /><input type="button" value="确认" class="btn-confirm yahei" /></p>')}d.show(),c.css({"z-index":10}),blankFix("j_afterCalendarWrap","after-calendar",function(){c.css({"z-index":"auto"})})})}function searchPager(a){var b=$("#j_fnPager"),c=parseInt(b.attr("data-pagesize"),10),d=parseInt(b.attr("data-counts"),10);b.get(0)&&b.uzPager({pageSize:c,pageItems:d,onInit:function(){},onCallback:function(b,c){$("#hdDataReq").attr("data-PageIndex",b),setTimeout(function(){$("html,body").animate({scrollTop:$("#j_sortLine").offset().top},500)},1e3),null!==a&&a(b,c)}})}function searchGuessLike(){window.guessLike||_util.file.load(("dev"===_env?"":_uzw.domain.cdnRandom())+"/content/v1/scripts/com/guesslike.js",function(){window.guessLike("j_guessLikeContainer")}),$("#j_sortLine").on("click",".list-item",function(){var a=$(this);productInterest(a.attr("data-pid"))})}function productInterest(a){if(_uzw.user.userid){var b={userId:_uzw.user.userid,city:0,channel:1,type:6,productIds:a};$.ajax({type:"post",url:_uzw.domain.wapi+"/api/UzaiInterest/InsertUserInterest",data:b,dataType:"jsonp",success:function(a){},error:function(){}})}}try{document.domain="uzai.com"}catch(e){}$(function(){var a=function(){$("#hdDataReq").attr("data-PageIndex",1),b.search("panel",function(a,c){null===a&&(b.renderview(c),searchPager(function(){b.search("pager",function(a,c){null===a&&b.renderview(c)})}))})};uzLazy(["j_searchSide","j_sortLine","j_sortVisa","comm-line-mod","main-pop-list"]),_uzw.ui.tab("j_productTypeTab",function(c,d){var e=d.find(".bd").children(".item").eq(c);initChoiceItems(e),$("#hdDataReq").attr("data-PageIndex",1),$("#hdDataReq").attr("data-producttype",e.attr("data-producttypetag"));var f=b.getchoosepanel();f.is("[data-isload]")===!1?b.searchpanel(function(c,d){null===c&&(b.renderpanelview(d),initChoiceItems(e),contentSwitch(),_uzw.ui.tab("choice-tab"),multiCalendar($(f.find(".start-date")),a))}):b.initpanelviewselect(),a(),b.recommend.renderview()});var b=new App;_uzw.ui.tab("choice-tab"),contentSwitch(),searchPager(function(){b.search("pager",function(a,c){null===a&&b.renderview(c)})}),searchGuessLike(),saleCountdown(),multiCalendar($("#j_productTypeTab").find(".choice-items").find(".start-date"),a),initChoiceItems($("[data-isload]"))});var App=function(a){var b=($("#j_productTypeTab"),null),c=function(){if(null!==b)return b;this._bindevent();var a=$("#j_productTypeTab > ul > li[data-producttypetag][data-producttypetag!='0']"),c=$.map(a,function(a){return $(a).attr("data-producttypetag")});this.recommend=new d($("#j_recommend"),c,this),this.recommend.renderview(),this.history=new e($("#historycontainer")),this.history.renderhistory(),b=this};c.prototype.com={},c.prototype.isbjarea=function(a){return $.map(["北京","天津","石家庄","唐山","青岛","太原","沈阳","大连","长春","哈尔滨","郑州","长沙","武汉","厦门","西安","济南"],function(b){return b===a?1:null}).length>0?!0:!1},c.prototype.getchoosepanel=function(){var a=this.getchoosetab(),b=a.attr("data-tab"),c=$("#j_productTypeTab > div:eq(0) > div:eq("+b+")");return c},c.prototype.getchoosetab=function(){var a=$("#j_productTypeTab > ul:eq(0) > li.on");return a},c.prototype.getdetailpanel=function(){var a=$("#j_sortLine > ul");return a},c.prototype.getchoosetype=function(){var a=this.getchoosetab();return a.attr("data-producttypetag")},c.prototype.ischooseTour=function(){var a=this.getchoosetype();return"0"===a?!0:"1"===a?!0:"2"===a?!0:"3"===a?!0:"4"===a?!0:"5"===a?!0:"8"===a?!0:"9"===a?!0:"10"===a?!0:"11"===a?!0:!1},c.prototype.ischooseYL=function(){var a=this.getchoosetype();return"6"===a?!0:!1},c.prototype.ischooseVisa=function(){var a=this.getchoosetype();return"7"===a?!0:!1},c.prototype.ischooseZYB=function(){var a=this.getchoosetype();return"12"===a?!0:void 0},c.prototype.gensearchparam=function(a){var b,c,d={},e=this.getchoosepanel(),f=$("#hdDataReq");if(d.domain=$.trim(f.attr("data-hostcity")),d.keyword=$.trim(f.attr("data-keyword")),d.productType=$.trim(f.attr("data-productType")),d.CurrentPageIndex=$.trim(f.attr("data-PageIndex")),d.sortby=$.trim(f.attr("data-sortby")),d.minPrice=$.trim($("#txtMinPrice").val()),d.maxPrice=$.trim($("#txtMaxPrice").val()),d.Promotion=$(f).attr("data-ischeap"),0===parseInt(d.minPrice,10)&&0===parseInt(d.maxPrice,10)?$("#txtMaxPrice,#txtMinPrice").val(""):(0===parseInt(d.minPrice,10)||0===parseInt(d.maxPrice,10))&&(0===parseInt(d.minPrice,10)&&$("#txtMinPrice").val("0"),0===parseInt(d.maxPrice,10)&&$("#txtMaxPrice").val("")),!this.ischooseVisa()&&_util.url.get("time")){var g=_util.url.get("time").split(",");2==g.length&&(d.beginDate=g[0],d.endDate=g[1]),1==g.length&&(d.beginDate=g[0])}return this.ischooseTour()||this.ischooseZYB()?(d.city=$.trim($(e).find("[data-startcity] span.choice-on").attr("data-val")),b=$(e).find("[data-godate] .choice-on"),b.is(".start-date")?(c=b.attr("data-seldate").split("|"),1==c.length&&(d.beginDate=c[0]||d.beginDate),2==c.length&&(d.beginDate=c[0]||d.beginDate,d.endDate=c[1]||d.endDate)):d.date=$.trim($(e).find("[data-godate] .choice-on").attr("data-val")),d.journeyDay=$.trim($(e).find("[data-journeyday] span.choice-on").attr("data-val")),d.subType=$.trim($(e).find("[data-subtype] span.choice-on").attr("data-val")),d.pastAddress=$.trim($(e).find("[data-pastaddress] span.choice-on").attr("data-val")),d.suitman=$.trim($(e).find("[data-suitman] span.choice-on").attr("data-val")),d.jpbox=$.trim($(e).find("[data-rbltype] span.choice-on").attr("data-val")),d.zybcity=$.trim($(e).find("[data-startcityzyb] span.choice-on").attr("data-val"))):this.ischooseYL()?(d.city=$.trim($(e).find("[data-startcity] span.choice-on").attr("data-val")),d.cruiseRoute=$.trim($(e).find("[data-route] span.choice-on").attr("data-val")),d.cruiseCompany=$.trim($(e).find("[data-company] span.choice-on").attr("data-val")),b=$(e).find("[data-godate] .choice-on"),b.is(".start-date")?(c=b.attr("data-seldate").split("|"),1==c.length&&(d.beginDate=c[0]||d.beginDate),2==c.length&&(d.beginDate=c[0]||d.beginDate,d.endDate=c[1]||d.endDate)):d.date=$.trim($(e).find("[data-godate] .choice-on").attr("data-val")),d.cruisePort=$.trim($(e).find("[data-port] span.choice-on").attr("data-val")),d.journeyDay=$.trim($(e).find("[data-journeyday] span.choice-on").attr("data-val"))):this.ischooseVisa()&&(d.visaArea=$.trim($(e).find("[data-startcity] span.choice-on").attr("data-val")),d.visaCountry=$.trim($(e).find("[data-visacountry] span.choice-on").attr("data-val")),d.visaReceiveZone=$.trim($(e).find("[data-visareceivezone] span.choice-on").attr("data-val")),d.visaType=$.trim($(e).find("[data-visatype] span.choice-on").attr("data-id"))),d},c.prototype.gensearchpanelparam=function(){var a=$("#hdDataReq"),b={};return b.keyword=$.trim(a.attr("data-keyword")),b.productType=$.trim(a.attr("data-productType")),b.subType=$.trim(a.attr("data-subType")),b.city=$.trim(a.attr("data-hostcitycode")),b},c.prototype.search=function(a,b){this.filterbjarea();var c=this.gensearchparam(a);$.ajax({url:"/SearchRoute",type:"POST",data:c,cache:!1,async:!1,dataType:"json",success:function(a){b(null,a)},error:function(){}})},c.prototype.searchpanel=function(a){var b=this.gensearchpanelparam();$.ajax({url:"/SearchMenuTab",type:"POST",data:b,cache:!1,async:!1,dataType:"json",success:function(b){a(null,b)},error:function(){}})},c.prototype.searchrecommend=function(a,b){var c={},d=(this.getchoosepanel(),$("#hdDataReq"));c.domain=$.trim(d.attr("data-hostcity")),c.keyword=$.trim(d.attr("data-keyword")),c.productType=a,c.CurrentPageIndex=1,c.sortby=0,c.istj=1,c.city=$("#hdDataReq").attr("data-hostcitycode"),$.ajax({url:"/SearchRoute",type:"POST",data:c,cache:!1,dataType:"json",success:function(a){b(null,a)},error:function(){}})},c.prototype._bindevent=function(){var a=this;$(document).on("click","span[data-val]",function(b){var c=$(b.target||b),d=(c.attr("data-val"),c.closest("dl"));d.find(".choice-on").is(".start-date")&&d.find(".choice-on").siblings(".after-calendar").find(".btn-reset").click(),d.find(".choice-on").val(""),d.find(".choice-on").removeClass("choice-on"),c.addClass("choice-on"),$("#hdDataReq").attr("data-PageIndex",1),a.search("head",function(b,c){null===b&&(a.renderview(c),searchPager(function(){a.search("pager",function(b,c){null===b&&a.renderview(c)})}))})}),$(document).on("click","span[data-zybval]",function(a){var b=$(a.target||a),c=b.attr("data-zybval"),d=b.closest("dl");d.find(".choice-items > .choice-on").removeClass("choice-on");var e=d.find(".choice-items > span[data-val='"+c+"']");if(0===e.length){var f=d.find(".newButton");if(0===f.length){var g=$("<span>",{"class":"choice-item newButton choice-on","data-val":c,text:c});d.find(".choice-tab").before(g),g.trigger("click")}else f.attr("data-val",c),f.text(c),f.addClass("choice-on"),f.trigger("click")}else e.addClass("choice-on"),e.trigger("click");b.closest(".bd .choice-on").removeClass("choice-on"),b.addClass("choice-on")}),$(document).on("click","li[data-sort]",function(b){var c=$(b.currentTarget||b),d=c.closest("ul"),e=d.find(".on"),f=c.attr("data-sort");c.is(e)&&c.is("[data-order='price']")&&("2"===f?(f="3",c.removeClass("sort-on")):(f="2",c.addClass("sort-on")),c.attr("data-sort",f)),d.find(".on").removeClass("on"),c.addClass("on"),$("#hdDataReq").attr("data-sortby",f),$("#hdDataReq").attr("data-PageIndex",1),a.search("head",function(b,c){null===b&&(a.renderview(c),searchPager(function(){a.search("pager",function(b,c){null===b&&a.renderview(c)})}))})}),$(document).on("click","input[data-cx]",function(b){var c=$(b.currentTarget||b),d=c.hasClass("on");d?($("#hdDataReq").attr("data-ischeap","0"),c.removeClass("on")):($("#hdDataReq").attr("data-ischeap","1"),c.addClass("on")),console.log($("#hdDataReq").attr("data-ischeap")),$("#hdDataReq").attr("data-PageIndex",1),a.search("head",function(b,c){null===b&&(a.renderview(c),searchPager(function(){a.search("pager",function(b,c){null===b&&a.renderview(c)})}))})})},c.prototype.renderview=function(a){var b=this,c=(this.getchoosetab(),this.getdetailpanel());c.html(""),(this.ischooseTour()||this.ischooseYL())&&$.each(a.RouteObject||[],function(a,d){var e=b.$createdetailtourrow(d);c.append(e)}),this.ischooseVisa()&&$.each(a.RouteObject||[],function(a,d){var e=b.$createdetailvisarow(d);c.append(e)}),this.ischooseZYB()&&$.each(a.RouteObject||[],function(a,d){var e=b.$createdetailzybrow(d);c.append(e)}),(a.RouteObject||[]).length>0?($(".hideview").addClass("hide"),$("#j_fnPager").removeClass("hide")):($(".hideview").removeClass("hide"),$("#j_fnPager").addClass("hide"));var d=a.PageObject;$("#j_fnPager").attr({"data-counts":d.TotalCount}),uzLazy(["j_sortLine"])},c.prototype.initpanelviewselect=function(){var a,b=this.getchoosepanel(),c=b.find("dl.choice-section");$.each(c,function(b,c){var d=$(c),e=d.find("span.choice-all"),f=d.find(".choice-item"),g=d.is("[data-startcity]"),h=d.is("[data-visareceivezone]");e.removeClass("choice-on"),f.removeClass("choice-on"),g?(a=$("#hdDataReq").attr("data-checkedCity"),d.find(".choice-item[data-val='"+a+"']").length>0?d.find(".choice-item[data-val='"+a+"']").addClass("choice-on"):e.addClass("choice-on")):h?(a=$("#hdDataReq").attr("data-hostcityname"),e.addClass("choice-on")):(e.addClass("choice-on"),d.find(".choice-item.choice-on").removeClass("choice-on"))})},c.prototype.renderpanelview=function(a){var b,c,d,e,f,g,h,i,j,k,l=(this.getchoosetab(),this.getchoosepanel()),m=0,n=$("#hdDataReq").attr("data-checkedCity");if(this.ischooseTour()&&(null!==a.SubTypeObject&&a.SubTypeObject instanceof Array&&a.SubTypeObject.length>0&&(h=this.$createheadrow({prop:"data-subtype",title:"游玩主题"}),$.each(a.SubTypeObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.Id,text:b.Name}))}),l.append(h),m++),null!==a.StartCityObject&&a.StartCityObject instanceof Array&&a.StartCityObject.length>0&&(h=this.$createheadrow({prop:"data-startcity",title:"出发城市",dataval:"0"}),k=0,h.find(".choice-items").append($("<div>",{"class":"choice-box"})),$.each(a.StartCityObject,function(a,b){i="",b.CityId.toString()===n&&(k=1,i="choice-on"),h.find(".choice-box").append($("<span>",{"class":"choice-item "+i,"data-val":b.CityId,text:b.CityName}))}),0!==k&&h.find(".choice-all").removeClass("choice-on"),l.append(h),m++),null!==a.JourneyDayObject&&a.JourneyDayObject instanceof Array&&a.JourneyDayObject.length>0&&(h=this.$createheadrow({prop:"data-journeyday",title:"行程天数"}),$.each(a.JourneyDayObject,function(a,b){var c,d;b.StartDay&&b.EndDay?(c=b.StartDay+"-"+b.EndDay+"天",d=b.StartDay+"-"+b.EndDay):b.StartDay&&!b.EndDay?(c=b.StartDay+"天及以上",d=b.StartDay):b.EndDay&&(c=b.EndDay+"天及以上",d="-"+b.EndDay),h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":d,text:c}))}),l.append(h),m++),null!==a.GoDateObject&&a.GoDateObject instanceof Array&&a.GoDateObject.length>0&&(h=this.$createheadrow({prop:"data-godate",title:"出发日期"}),$.each(a.GoDateObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.MonthVal,text:b.MonthTxt}))}),g=this.$createtimecontrol(),h.find(".choice-items").append(g),l.append(h),m++),null!==a.PastAddressObject&&a.PastAddressObject instanceof Array&&a.PastAddressObject.length>0&&(h=this.$createheadrow({prop:"data-pastaddress",title:"途经景观",hide:!0}),$.each(a.PastAddressObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.Des,text:b.Des}))}),l.append(h),m++),null!==a.SuitManObject&&a.SuitManObject instanceof Array&&a.SuitManObject.length>0),this.ischooseVisa()){if(null!==a.VisaAreaObject&&a.VisaAreaObject instanceof Array&&a.VisaAreaObject.length>0&&(h=this.$createheadrow({prop:"data-visaarea",title:"地区"}),$.each(a.VisaAreaObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.Des,text:b.Des}))}),l.append(h),m++),null!==a.VisaCountryObject&&a.VisaCountryObject instanceof Array&&a.VisaCountryObject.length>0&&(h=this.$createheadrow({prop:"data-visacountry",title:"国家"}),$.each(a.VisaCountryObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.CountryName,text:b.CountryName}))}),l.append(h),m++),null!==a.VisaReceiveZoneObject&&a.VisaReceiveZoneObject instanceof Array&&a.VisaReceiveZoneObject.length>0){h=this.$createheadrow({prop:"data-visareceivezone",title:"所属领区"});$("#hdDataReq").attr("data-hostcityname");$.each(a.VisaReceiveZoneObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item "+j,"data-val":b.Des,text:b.Des}))}),h.find(".choice-item").removeClass("choice-on"),l.append(h),m++}null!==a.VisaTypeObject&&a.VisaTypeObject instanceof Array&&a.VisaTypeObject.length>0&&(h=this.$createheadrow({prop:"data-visatype",title:"签证类型"}),$.each(a.VisaTypeObject,function(a,b){var c;switch(b.Des){case"旅游签证":c=1;break;case"商业签证":c=2;break;case"探亲访友":c=3;break;default:c=4}h.find(".choice-items").append($("<span>",{"class":"choice-item","data-id":c,"data-val":b.Des,text:b.Des}))}),l.append(h),m++)}if(this.ischooseYL()&&(null!==a.CruisesRouteObject&&a.CruisesRouteObject instanceof Array&&a.CruisesRouteObject.length>0&&(h=this.$createheadrow({prop:"data-route",title:"航线目的地"}),$.each(a.CruisesRouteObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.Des,text:b.Des}))}),l.append(h),m++),null!==a.StartCityObject&&a.StartCityObject instanceof Array&&a.StartCityObject.length>0&&(h=this.$createheadrow({prop:"data-startcity",title:"出发城市",dataval:"0"}),k=0,$.each(a.StartCityObject,function(a,b){i="",b.CityId.toString()===n&&(k=1,i="choice-on"),h.find(".choice-items").append($("<span>",{"class":"choice-item "+i,"data-val":b.CityId,text:b.CityName}))}),0!==k&&h.find(".choice-all").removeClass("choice-on"),l.append(h),m++),null!==a.CruisesCompanyObject&&a.CruisesCompanyObject instanceof Array&&a.CruisesCompanyObject.length>0&&(h=this.$createheadrow({prop:"data-company",title:"邮轮公司"}),$.each(a.CruisesCompanyObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.Des,text:b.Des}))}),l.append(h),m++),null!==a.GoDateObject&&a.GoDateObject instanceof Array&&a.GoDateObject.length>0&&(h=this.$createheadrow({prop:"data-godate",title:"出发日期"}),$.each(a.GoDateObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.MonthVal,text:b.MonthTxt}))}),g=this.$createtimecontrol(),h.find(".choice-items").append(g),l.append(h),m++),null!==a.CruisesPortObject&&a.CruisesPortObject instanceof Array&&a.CruisesPortObject.length>0&&(h=this.$createheadrow({prop:"data-port",title:"出发港口",hide:!0}),$.each(a.CruisesPortObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.Real,text:b.Des}))}),l.append(h),m++),null!==a.JourneyDayObject&&a.JourneyDayObject instanceof Array&&a.JourneyDayObject.length>0&&(h=this.$createheadrow({prop:"data-journeyday",title:"行程天数",hide:!0}),$.each(a.JourneyDayObject,function(a,b){var c,d;b.StartDay&&b.EndDay?(c=b.StartDay+"-"+b.EndDay+"天",d=b.StartDay+"-"+b.EndDay):b.StartDay&&!b.EndDay?(c=b.StartDay+"天及以上",d=b.StartDay):b.EndDay&&(c=b.EndDay+"天及以上",d="-"+b.EndDay),h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":d,text:c}))}),l.append(h),m++)),this.ischooseZYB()&&(null!==a.SubTypeObject&&a.SubTypeObject instanceof Array&&a.SubTypeObject.length>0&&(h=this.$createheadrow({prop:"data-subtype",title:"游玩主题"}),$.each(a.SubTypeObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.Id,text:b.Name}))}),l.append(h),m++),(null!==a.ZYBCityBaseQuick&&a.ZYBCityBaseQuick.length>0||null!==a.ZYBCityBase&&a.ZYBCityBase.length>0)&&(h=this.$createheadrow({prop:"data-startcityzyb",title:"出发城市",dataval:""}),k=0,$.each(a.ZYBCityBaseQuick.DepartureCityList||[],function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.LocationNameReadOnly,text:b.LocationNameReadOnly}))}),b=$("<div>",{"class":"choice-tab mt10","data-event":"hover1"}),e=$("<div>",{"class":"bd"}),c=$("<ul>",{"class":"hd clearfix"}),$.each(a.ZYBCityBase||[],function(a,b){var g=0===a?"on":"";d=$("<li>",{"class":"hd-item "+g,text:b.title}),c.append(d),g=0===a?"":" hide ";var h=0===a?"display: block":"display: none";f=$("<div>",{"class":"item"+g,style:h}),$.each(b.DepartureCityList,function(a,b){f.append($("<span>",{"class":"choice-item",text:b.LocationNameReadOnly,"data-zybval":b.LocationNameReadOnly}))}),e.append(f)}),0!==(a.ZYBCityBase||[]).length&&(b.append(c).append(e),h.find(".choice-items").append(b)),l.append(h),m++),null!==a.RBLTypeObject&&a.RBLTypeObject instanceof Array&&a.RBLTypeObject.length>0&&(h=this.$createheadrow({prop:"data-rbltype",title:"产品类型"}),$.each(a.RBLTypeObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.Name,text:b.Name}))}),l.append(h),m++),null!==a.JourneyDayObject&&a.JourneyDayObject instanceof Array&&a.JourneyDayObject.length>0&&(h=this.$createheadrow({prop:"data-journeyday",title:"行程天数"}),$.each(a.JourneyDayObject,function(a,b){var c,d;b.StartDay&&b.EndDay?(c=b.StartDay+"-"+b.EndDay+"天",d=b.StartDay+"-"+b.EndDay):b.StartDay&&!b.EndDay?(c=b.StartDay+"天及以上",d=b.StartDay):b.EndDay&&(c=b.EndDay+"天及以上",d="-"+b.EndDay),h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":d,text:c}))}),l.append(h),m++),null!==a.GoDateObject&&a.GoDateObject instanceof Array&&a.GoDateObject.length>0&&(h=this.$createheadrow({prop:"data-godate",title:"出发日期",hide:!0}),$.each(a.GoDateObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.MonthVal,text:b.MonthTxt}))}),g=this.$createtimecontrol(),h.find(".choice-items").append(g),l.append(h),m++),null!==a.PastAddressObject&&a.PastAddressObject instanceof Array&&a.PastAddressObject.length>0&&(h=this.$createheadrow({prop:"data-pastaddress",title:"途经景观",hide:!0}),$.each(a.PastAddressObject,function(a,b){h.find(".choice-items").append($("<span>",{"class":"choice-item","data-val":b.Des,text:b.Des}))}),l.append(h),m++),null!==a.SuitManObject&&a.SuitManObject instanceof Array&&a.SuitManObject.length>0),l.find("dl").length>4){var o=this.$createheadmore();l.append(o),l.find("dl").slice(0,4).removeClass("hide")}l.attr("data-isload","")},c.prototype.filterbjarea=function(){if(this.ischooseYL()){var a=this.getchoosepanel(),b=a.find("[data-startcity]"),c=a.find("[data-port]"),d=a.find("[data-company]"),e=b.find(".choice-on"),f=e.text().trim();this.isbjarea(f)?(c.find(".choice-all").addClass("choice-on"),c.find(".choice-item").removeClass("choice-on"),c.addClass("hide"),d.addClass("hide")):a.find(".btn-switch").is(".on")?a.find("dl").removeClass("hide"):a.find("dl").slice(0,4).removeClass("hide")}},c.prototype.flushchoose=function(){this.getchoosepanel()},c.prototype.$createheadrow=function(a){var b=$("<dl>",{"class":"choice-section clearfix "+(a.hide===!0?"hide":"")});b.attr(a.prop,"");var c=$("<dt>",{"class":"section-hd f999 fl"});c.text(a.title);var d=$("<dd>",{"class":"section-bd clearfix"}),e=$("<div>",{"class":"choice-items"});return d.append("<span class='choice-all fl choice-on' data-val='"+(a.dataval||"")+"'>全部</span>").append(e),b.append(c).append(d),b},c.prototype.$createheadmore=function(){var a=$("<p>",{"class":"btn-bar tc"}),b=$("<span>",{"class":"btn-switch blue pointer"}),c=$("<em>",{"class":"switch-cont",text:"更多筛选条件"}),d=$("<span>",{"class":"arrow-wrap f12 songti lh1 ml5 vm"});return d.append("<i class='arrow-icon'>◆</i>"),b.append(c).append(d),a.append(b),a},c.prototype.$createdetailtourrow=function(a){var b,c,d,e,f,g,h,i,j,k="";k=3==a.ProductType||8==a.ProductType||9==a.ProductType||11==a.ProductType||12==a.ProductType?"不限出发地":16==a.ProductType?" "+(a.AbroadStartCity||"")+"出发 ":" "+a.StartCityName+"出发 ";var l=(a.TreeJourney||"").replace(/\^/g,"、"),m="product-gty";"跟团游"==a.UzaiTravelClassName?m="product-gty":"自由行"==a.UzaiTravelClassName?m="product-zzy":"自驾游"==a.UzaiTravelClassName?m="product-zjy":"公司游"==a.UzaiTravelClassName?m="product-gsy":"当地游"==a.UzaiTravelClassName?m="product-ddy":"邮轮"==a.UzaiTravelClassName&&(m="product-yl");var n=16==a.ProductType?"境外参团":a.UzaiTravelClassName,o=a.ProductURL;if("manager"==$.trim($("#hdDataReq").attr("data-uztype"))){var p=_util.url.get("userId"),q=_util.url.get("did");a.ProductURL.toLowerCase().lastIndexOf("youlun/p-")>=1&&(o="http://sh.uzai.com/tour-"+a.ProductId+".html"),"product-yl"==m||"product-gty"==m?o="http://manager.uzai.com/Manager/MenuPages/OffLine/NewOffLineQueryProduct.aspx?productURL="+encodeURIComponent(o)+"&uztype=manager&userId="+p+"&did="+q:"product-zzy"==m&&(o="http://manager.uzai.com/Manager/MenuPages/OffLine/NewOffLineTripQueryProduct.aspx?productURL="+encodeURIComponent(o)+"&uztype=manager&userId="+p+"&did="+q)}b=$("<li>",{"class":"list-item clearfix",style:"display:block","data-pid":a.ProductId}),c=$("<a>",{href:o,"class":"item-pic fl",target:"_blank"}),d=$("<img>",{"data-original":a.PictureUrl,src:"//r01.uzaicdn.com/content/m/images/common/gray.gif","class":"g10",style:"display: inline"}),e=$("<span>",{"class":"tag-type white f14 tc"}),e.html("<em>"+n+"</em>"),f=$("<div>",{"class":"info-bar"}),(0!==a.Satisfaction||0!==a.CommentNumber)&&(g=$("<p>",{"class":"info-mask"}),f.append(g),g=$("<p>",{"class":"info-cont white"}),a.Satisfaction=0===a.Satisfaction?100:a.Satisfaction,g.html("满意度：<i>"+a.Satisfaction+"% </i>       |       <i> "+a.CommentNumber+"</i> 人点评")),f.append(g),c.append(d).append(e).append(f),b.append(c),f=$("<div>",{"class":"item-side tc fr"}),g=$("<p>",{"class":"item-price f666 f16"}),a.MinPrice>0?g.html("<i class='price red f22'>¥<em>"+a.MaxPrice+"</em></i> 起"):g.html("<i class='price red f22'>价格请电询<em></em></i>"),f.append(g),g=$("<p>",{"class":"mt5"}),c=$("<a>",{href:o,"class":"btn-detail f14",text:"查看详情",target:"_blank"}),g.append(c),f.append(g),b.append(f),h=$("<dl>",{"class":"item-main"}),i=$("<dt>",{"class":"item-hd f16 b"}),c=$("<a>",{href:o,text:a.ProductName.replace(/\&lt;/g,"<").replace(/\&gt;/g,">"),target:"_blank",title:a.ProductNameFull}),i.append(c),h.append(i),j=$("<dd>",{"class":"item-favorable ellipsis"}),$.each(a.ShowIconHTMLES||[],function(a,b){e=$("<span>",{"class":"tag-item mr10",text:b}),j.append(e)}),h.append(j),""!==l&&(l="| "+l),j=$("<dd>",{"class":"item-info ellipsis f666 f14",title:l,text:k+l}),h.append(j),j=$("<dd>",{"class":"item-date f14"});var r="";if(a.IsUtourSelf&&(r='<span class="uzai-self">众信自营｜</span>',j.append(r)),e=$("<span>",{"class":"date-info f999",text:"团期："+a.GoDate}),c=$("<a>",{"class":"more-date blue",href:o,text:"更多班期",target:"_blank"}),j.append(e).append(c),h.append(j),(a.TagNameDisp||[]).length>0){j=$("<dd>",{"class":"item-favorable ellipsis modify_12"}),e=$("<span>",{"class":"tag-item mr10 left",text:"优惠"}),f=$("<div>",{"class":"modify_13"});var s=$("<span>",{});f.append(s),$.each(a.TagNameDispHover||[],function(a,b){g=$("<p>",{html:b}),f.append(g)}),e.append(f),j.append(e),e=$("<span>",{"class":"right",text:a.TagNameDisp}),j.append(e),f=$("<div>",{"class":"clear"}),j.append(f),h.append(j)}return b.append(h),b},c.prototype.$createdetailzybrow=function(a){var b,c,d,e,f,g,h,i,j,k="";k=3==a.ProductType||8==a.ProductType||9==a.ProductType||11==a.ProductType||12==a.ProductType?"不限出发地":16==a.ProductType?" "+(a.AbroadStartCity||"")+"出发 ":" "+a.StartCityName+"出发 ";var l=(a.TreeJourney||"").replace(/\^/g,"、"),m="product-gty";"跟团游"==a.UzaiTravelClassName?m="product-gty":"自由行"==a.UzaiTravelClassName?m="product-zzy":"自驾游"==a.UzaiTravelClassName?m="product-zjy":"公司游"==a.UzaiTravelClassName?m="product-gsy":"当地游"==a.UzaiTravelClassName?m="product-ddy":"邮轮"==a.UzaiTravelClassName&&(m="product-yl");var n=16==a.ProductType?"境外参团":a.UzaiTravelClassName,o=a.ProductURL;if("manager"==$.trim($("#hdDataReq").attr("data-uztype"))){var p=_util.url.get("userId"),q=_util.url.get("did");a.ProductURL.toLowerCase().lastIndexOf("youlun/p-")>=1&&(o="http://sh.uzai.com/tour-"+a.ProductId+".html"),"product-yl"==m||"product-gty"==m?o="http://manager.uzai.com/Manager/MenuPages/OffLine/NewOffLineQueryProduct.aspx?productURL="+encodeURIComponent(o)+"&uztype=manager&userId="+p+"&did="+q:"product-zzy"==m&&(o="http://manager.uzai.com/Manager/MenuPages/OffLine/NewOffLineTripQueryProduct.aspx?productURL="+encodeURIComponent(o)+"&uztype=manager&userId="+p+"&did="+q)}b=$("<li>",{"class":"list-item clearfix",style:"display:block","data-pid":a.ProductId}),c=$("<a>",{href:o,"class":"item-pic fl",target:"_blank"}),d=$("<img>",{"data-original":a.PictureUrl,src:"//r01.uzaicdn.com/content/m/images/common/gray.gif","class":"g10",style:"display: inline"}),e=$("<span>",{"class":"tag-type white f14 tc"}),e.html("<em>"+n+"</em>"),f=$("<div>",{"class":"info-bar"}),(0!==a.Satisfaction||0!==a.CommentNumber)&&(g=$("<p>",{"class":"info-mask"}),f.append(g),g=$("<p>",{"class":"info-cont white"}),a.Satisfaction=0===a.Satisfaction?100:a.Satisfaction,g.html("满意度：<i>"+a.Satisfaction+"% </i>       ｜       <i> "+a.CommentNumber+"</i> 人点评")),f.append(g),c.append(d).append(e).append(f),b.append(c),f=$("<div>",{"class":"item-side tc fr"}),g=$("<p>",{"class":"item-price f666 f16"}),a.MinPrice>0?g.html("<i class='price red f22'>¥<em>"+a.MaxPrice+"</em></i> 起"):g.html("<i class='price red f22'>价格请电询<em></em></i>"),f.append(g),g=$("<p>",{"class":"mt5"}),c=$("<a>",{href:o,"class":"btn-detail f14",text:"查看详情",target:"_blank"}),g.append(c),f.append(g),b.append(f),h=$("<dl>",{"class":"item-main"}),i=$("<dt>",{"class":"item-hd f16 b"}),c=$("<a>",{href:o,text:a.ProductName.replace(/\&lt;/g,"<").replace(/\&gt;/g,">"),target:"_blank",title:a.ProductNameFull}),i.append(c),h.append(i),j=$("<dd>",{"class":"item-favorable ellipsis"}),$.each(a.ShowIconHTMLES||[],function(a,b){e=$("<span>",{"class":"tag-item mr10",text:b}),j.append(e)}),""!==l&&(l="| "+l),j=$("<dd>",{"class":"item-info ellipsis f666 f14",title:l,text:k+l}),h.append(j),j=$("<dd>",{"class":"item-date f14"});var r="";if(a.IsUtourSelf&&(r='<span class="uzai-self">众信自营｜</span>',j.append(r)),e=$("<span>",{
"class":"date-info f999",text:"团期："+a.GoDate}),c=$("<a>",{"class":"more-date blue",href:o,text:"更多班期",target:"_blank"}),j.append(e).append(c),h.append(j),(a.TagNameDisp||[]).length>0){j=$("<dd>",{"class":"item-favorable ellipsis modify_12"}),e=$("<span>",{"class":"tag-item mr10 left",text:"优惠"}),f=$("<div>",{"class":"modify_13"});var s=$("<span>",{});f.append(s),$.each(a.TagNameDispHover||[],function(a,b){g=$("<p>",{html:b}),f.append(g)}),e.append(f),j.append(e),e=$("<span>",{"class":"right",text:a.TagNameDisp}),j.append(e),f=$("<div>",{"class":"clear"}),j.append(f),h.append(j)}return b.append(h),b},c.prototype.$createdetailvisarow=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n=a.ProductURL;return b=$("<li>",{"class":"list-item clearfix",style:"display:block","data-pid":a.ProductId}),c=$("<a>",{href:n,"class":"item-pic fl",target:"_blank"}),d=$("<img>",{"data-original":a.ProductVisa.ProductPic,src:"//r01.uzaicdn.com/content/m/images/common/gray.gif","class":"g10",style:"display: inline"}),e=$("<div>",{"class":"info-bar"}),c.append(d).append(e),b.append(c),e=$("<div>",{"class":"item-side tc fr"}),f=$("<p>",{"class":"item-price f666 f16"}),a.MinPrice>0?f.html("<i class='price red f22'>¥<em>"+a.MaxPrice+"</em></i> 起"):f.html("<i class='price red f22'>价格请电询<em></em></i>"),e.append(f),f=$("<p>",{"class":"mt5"}),c=$("<a>",{href:n,"class":"btn-detail f14",text:"马上办理",target:"_blank"}),f.append(c),e.append(f),b.append(e),g=$("<dl>",{"class":"item-main"}),h=$("<dt>",{"class":"item-hd f16 b"}),c=$("<a>",{href:n,text:a.ProductName.replace(/\&lt;/g,"<").replace(/\&gt;/g,">"),target:"_blank",title:a.ProductNameFull}),h.append(c),g.append(h),i=$("<dd>",{"class":"item-favorable ellipsis"}),g.append(i),i=$("<dd>"),j=$("<table>",{"class":"info-table f666 f14 g10"}),k=$("<tbody>"),l=$("<tr>"),m=$("<td>",{text:"最长停留:"+(a.ProductVisa.RemainTime||"")}),l.append(m),m=$("<td>",{text:"是否面试:"+(a.ProductVisa.FaceTypeName||"")}),l.append(m),k.append(l),l=$("<tr>"),m=$("<td>",{text:"入境次数:"+(-1==a.ProductVisa.EntryNum?"多次":a.ProductVisa.EntryNum+" 次")}),l.append(m),m=$("<td>",{text:"办理周期:"+(a.ProductVisa.ProcTime||"")}),l.append(m),k.append(l),j.append(k),i.append(j),g.append(i),b.append(g),b},c.prototype.$createtimecontrol=function(){var a=$("<span>",{"class":"date-wrap j_afterCalendarWrap"}),b=$("<input>",{type:"text","class":"textbox start-date f14 yahei tc",placeholder:"自定义出发日期","data-val":"",readonly:"readonly"});return a.append(b),a};var d=function(a,b,c){this.container=$(a),this.producttypes=b,this.app=c};d.prototype.renderview=function(){var a=this;this.container.html("");var b=this.app.getchoosetype();$.each(this.producttypes,function(c,d){var e=d.toString();e!==b&&a.app.searchrecommend(d,function(b,c){if(null===b){var d=c.PageObject.TotalCount;if(d>0){var f=a.$createrecommand({producttype:e,obj:c});$("#j_recommend").append(f),uzLazy(["j_recommend"])}}})})},d.prototype.geturl=function(a){var b="http://search.uzai.com",c=$.trim($("#hdDataReq").attr("data-keyword")),d=$.trim($("#hdDataReq").attr("data-hostcity"));d||(d="sh");var e=b+"/"+d+"/SearchResult?keyword="+encodeURI($.trim(c))+"&travelClass="+a;return e},d.prototype.$createrecommand=function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=a.obj,n=m.PageObject.TotalCount,o=m.RouteObject.slice(0,3),p=o[0],q=a.producttype,r=p.ProductURL;b=$("<div data-producttype='"+q+"'>"),f=$("#j_productTypeTab > ul > li[data-producttypetag='"+q+"']");var s=f.text()+"推荐";d=$("<h2>",{"class":"main-hd box-fix clearfix"}),b.append(d),g=$("<em>",{"class":"hd-cont f16 fl",text:s}),h=$("<a>",{"class":"look-link blue f14 fr",href:l.geturl(q),text:"查看全部"+n+"条产品"}),d.append(g).append(h),c=$("<div>",{"class":"comm-line-mod box-fix clearfix"}),h=$("<a>",{href:r,"class":"mod-pic fl",target:"_blank"});var t;try{t=p.ProductVisa.ProductPic}catch(u){t=p.PictureUrl}try{t=t.split("?")[0]+"?imageView2/1/w/230/h/172"}catch(u){}return i=$("<img>",{src:"//r01.uzaicdn.com/content/m/images/common/gray.gif","data-original":t,alt:"","class":"g10",style:"display: inline"}),h.append(i),c.append(h),e=$("<ul>",{"class":"line-list f14 fl"}),$.each(o,function(a,b){r=b.ProductURL,f=$("<li>",{"class":"list-item clearfix "+(0===a?"first":"")}),j=$("<span>",{"class":"item-price f666 fr"}),b.MinPrice>0?j.html("<i class='price red f18'>¥<em>"+b.MinPrice+"</em></i> 起"):j.html("<i class='price red f18'>价格请电询</i>"),f.append(j),k=$("<p>",{"class":"item-hd"}),h=$("<a>",{href:r,"class":"ellipsis",text:b.ProductName.replace(/\&lt;/g,"<").replace(/\&gt;/g,">"),target:"_blank"}),k.append(h),f.append(k),e.append(f)}),c.append(e),b.append(c),b};var e=function(a){this.container=$(a)};return e.prototype.renderhistory=function(){var a=this;this.gethistory(function(b,c){null===b&&c instanceof Array?(a.container.show(),$.each(c,function(b,c){var d=a.$createhistoryrow(c);a.container.find(".side-browsed-list").append(d)})):a.container.hide()})},e.prototype.gethistory=function(a){$.ajax({url:"//aj.uzai.com/api/UzaiScanRecords/GetUzaiScanRecordsTop3",type:"GET",dataType:"jsonp",success:function(b){null===b||0===b.length?a("没有数据"):a(null,b)}})},e.prototype.$createhistoryrow=function(a){var b;b=$("<a>",{"class":"list-item",href:a.ProductURL,target:"_blank"});var c=a.ProductName||"";return c=c.replace(/\&lt;/,"<").replace(/\&gt;/,">"),b.append($("<p>",{"class":"item-hd",text:c})),b.append($("<p class='item-ft tr'><ins class='price red'>¥"+a.ProductPrice+"</ins></p>")),b},c}(window);$(function(){var a=new App;a.filterbjarea()});
//# sourceMappingURL=/sourcemaps/content/v1/scripts/search/script-latest.js.map