/*! uzai - v0.1.11 - 2017 */

"use strict";function fixInputErr(){$(document).on("blur",".input-err",function(){var a=$(this);a.removeClass("input-err");var b=$("#j_lrfTips");b.text("")})}function jipiaoSlides(){var a=$("#j_bannerSlides");a.get(0)&&(a.slides({preload:!0,preloadImage:"//r.uzaicdn.com/content/v1/images/common/preload.gif",currentClass:"on",fadeSpeed:300,effect:"fade",crossfade:!0,hoverPause:!0,pause:1e3,play:6e3,generatePagination:!0}),a.find(".slides_control").css({width:"100%"}))}function multiCalendar(){var a=$("#j_formsListing"),b=$("#j_roundTrip");a.get(0)||(a=$("#j_jipiaoListSearch")),b.get(0)||(b=$("#j_switchWay")),$("input[data-multi-calendar]").on("focus",function(){$("#j_lrfTips").html(""),$(".cities-select-mod").hide(),$("#j_jpAllCityFilter").hide();var c=$(this),d=c.attr("data-tag");$(".after-calendar").hide();var e=c.parent(),f=e.find(".after-calendar");if(!f.get(0)){c.after('<div class="after-calendar ca-norm ca-norm-multi"></div>'),f=e.find(".after-calendar");var g={jsonpUrl:"",latestDate:"",extCallBack:function(a,b){f.find(".item").on("click",function(){var a=$(this),b=a.hasClass("item-expiry")||a.hasClass("item-gray");if(!b){var d=a.attr("data-year"),g=a.attr("data-month"),h=a.attr("data-day");c.val(d+"-"+g+"-"+h),f.hide(),e.css({"z-index":"auto"})}})},preCallback:function(a,b){}};f.jsonMultiCalendar(g)}if(f.show(),e.css({"z-index":10}),blankFix("j_afterCalendarWrap","after-calendar",function(){e.css({"z-index":"auto"})}),"end"==d){var h=b.find('.control-radio[data-trip="round"]');h.get(0)||(b.val("round"),h=b),_switchRoundTrip(h,a),f.show()}})}function _switchRoundTrip(a,b){if(a.get(0)&&b.get(0)){var c=a,d=c.children("input"),e=c.siblings(".control-radio"),f=c.attr("data-trip");f||(f=c.val()),b.find(".after-calendar").hide(),e.removeClass("control-radio-on"),e.find("input").val("0"),c.addClass("control-radio-on"),d.val("1"),"single"==f?(b.find(".fade").addClass("fade-on"),b.find('input[data-tag="end"]').val("")):b.find(".fade").removeClass("fade-on")}}function searchControlBar(){var a=$("#j_jpCityListNode"),b=$("#j_formsListing"),c=$("#j_roundTrip"),d=$("#j_switchCity"),e=$("#j_jipiaoListSearch"),f=$("#j_switchWay");if(e.get(0)){var g=e.parent(".jipiao-list-search-wrap"),h=e.height(),i=function(){var a=$(window),b=a.scrollTop(),c=g.offset().top;b>=c?(_util.check.isIE6&&//!window.XMLHttpRequest
e.css({top:b}),e.addClass("search-fixed")):e.removeClass("search-fixed")};g.height(h),i(),$(window).scroll(function(){i()})}$("input[data-cities-trigger]").on("focus",function(){var b=$(this),c=b.next("input[type=hidden]");$(".cities-select-mod").hide(),$("#j_jpAllCityFilter").remove();var d=b.parent(".cities-select-wrap"),e=b.siblings(".cities-select-mod");e.after('<ul class="hide city-filter-mod" id="j_jpAllCityFilter"></ul>'),globalCitySelect=$("#j_jpAllCityFilter");var f=e.find(".cities-select-tab");f.get(0)||(e.html(a.html()),_uzw.ui.tab("cities-select-tab"),e.find(".select-item").on("click",function(){var a=$(this),f=a.text(),g=a.attr("data-code");b.val(f),c.val(g),e.hide(),d.css({"z-index":"auto"})})),e.show(),d.css({"z-index":10}),blankFix("cities-select-wrap","cities-select-mod",function(){d.css({"z-index":"auto"}),$.trim(b.val())&&globalCitySelect.find("li").not(".li-none").eq(0).click(),globalCitySelect.remove()}),e.find(".close-wrap").on("click",function(){e.hide(),d.css({"z-index":"auto"})})}),d.on("click",function(){var a=$(this),b=a.parents(".g2"),c=b.prev(".g4").find("input[data-cities-trigger]"),d=c.siblings("input:hidden"),e=b.next(".g4").find("input[data-cities-trigger]"),f=e.siblings("input:hidden"),g=c.val(),h=e.val(),i=d.val(),j=f.val();c.val(h),e.val(g),d.val(j),f.val(i)}),c.find(".control-radio").on("click",function(){var a=$(this);_switchRoundTrip(a,b)}),f.on("change",function(){var a=$(this);_switchRoundTrip(a,e)}),b.find(".cabin-select").children("li").on("click",function(){var a=$(this),b=a.parents(".select-wrap"),c=b.prev(".db-info-bar"),d=c.children("input");d.val(a.text()),b.hide()});var j=b.find("input[data-cities-trigger]").eq(0);if(j.get(0)){var k=_ug.cityCN,l=b.find("input[name=startcity]"),m=function(){for(var a=window.listRealGlobalCity.length,b=0;a>b;b++){var c=window.listRealGlobalCity[b],d=c.a.toUpperCase(),e=c.b.toUpperCase();if(e.indexOf(k)>-1)return d}};j.val(k),l.val(m()),j.val()&&l.val()||(j.val("北京"),l.val("BJS"))}}function listFilter(){var a=$("#j_slideFilterBar"),b=$("#j_flightFiltrateMod"),c=b.find(".filtrate-list");a.find("label").on("click",function(){var a=$(this),b=(a.parents("dd"),a.children(".control-checkbox"));b.hasClass("control-checkbox-on")?b.removeClass("control-checkbox-on"):b.addClass("control-checkbox-on"),unitFilter()}),a.find(".clear-all").on("click",function(){$(this);a.find(".control-checkbox").removeClass("control-checkbox-on"),unitFilter()}),b.find(".sort-bar").find(".btn-switch").on("click",function(){var a=$(this),b=a.find("em");a.hasClass("on")?(a.removeClass("on"),b.text("不含税价格")):(a.addClass("on"),b.text("含税价格"))}),c.on("click",".btn-switch",function(){var a=$(this),b=a.parents(".flight-info").next(".other-info-items");a.hasClass("on")?(a.removeClass("on"),b.hide()):(a.addClass("on"),b.show()),fixIe8(a.parents(".main-box"))}),c.on("mouseenter",".transfer-list",function(){var a=$(this);a.find(".transfer-info-items").show(),a.parents(".flight-info").css({"z-index":10})}).on("mouseleave",".transfer-list",function(){var a=$(this);a.find(".transfer-info-items").hide(),a.parents(".flight-info").css({"z-index":"auto"})})}function unitFilter(){var a=$("#j_flightFiltrateMod"),b=getFilteredParams(),c=a.find(".bar-main").children(".on"),d=c.attr("rel"),e=c.children("i");"data-index"==d?initSorter(b,"data-index","asc"):initSorter(b,d,e.hasClass("sort-up")?"asc":"desc")}function listFilterSorter(){var a=$("#j_flightFiltrateMod"),b=a.find(".bar-main").find("span");b.on("click",function(a,b){var c=$(this),d=c.siblings(".sort-item");getFilteredParams();d.removeClass("on"),c.addClass("on"),d.find(".icon-sort").removeClass("sort-up").removeClass("sort-down");var e=c.find(".icon-sort");e.hasClass("sort-down")?(e.removeClass("sort-down"),e.addClass("sort-up")):e.hasClass("sort-up")?(e.removeClass("sort-up"),e.addClass("sort-down")):e.addClass("sort-down"),unitFilter()})}function tipsInfo(){var a=($(".jipiao-order-detail"),function(a,b){a.on("mouseenter","."+b,function(){var a=$(this);a.addClass(b+"-on")}).on("mouseleave","."+b,function(){var a=$(this);a.removeClass(b+"-on")})});a($("#j_sortList"),"hover-wrap"),a($(".travel-order"),"hover-wrap"),a($(".jipiao-order-detail"),"detail-info");var b=$(".j_powerFloat");b.get(0)&&b.powerFloat({reverseSharp:!0});var c=$("#j_sortList"),d=$("#j_tgqRule");c.on("mouseenter",".j_powerFloat",function(){var a=$(this),b=a.parents(".ii-main").find(".rule-explain-items").clone();d.empty().append(b)})}function getFilteredParams(){var a=[];return $("#j_slideFilterBar").find(".filter-item").each(function(b,c){var d=$(this),e=[];d.find(".control-checkbox-on").each(function(a,b){var c=$(this),d=c.attr("rel");e.push(d)}),e.length&&a.push(e.join("|"))}),a.join(",")}function initSorter(a,b,c){var d=$("#j_sortList");$("#j_slideFilterBar");if(d.get(0)){if(_util.check.isIE6)return;d.find(".btn-switch").removeClass("on"),d.find(".other-info-items").hide(),d.uzSorter({sortBy:a||"",sortAscTag:b||"",sortAscKey:c||"asc",targetNull:"<div class='fruitless-box bg-white tc yahei'><i class='icon-uz vm icon-hotels png'></i><span class='f666 f24'>抱歉!暂无信息</span></div>",tragetAjaxText:"<p class='lh3 tc yahei f24 f666'>数据载入中...</p>",onInit:function(){},onCallback:function(){fixIe8($(".main-box"));var a=d.children(".filtrate-list").children(".filtrate-item"),b=a.length,c=$("#j_filterNums");c.find(".i1").text(b),c.find(".i2").text(a.filter("[data-zturn=0]").length);var e=d.find(".j_powerFloat");e.get(0)&&e.powerFloat({reverseSharp:!0})}})}}function indexSubmit(){var a=$("#flightForm"),b=$("#j_lrfTips"),c=a.find("input[name=startcity]"),d=a.find("input[name=endcity]"),e=c.prev(".textbox"),f=d.prev(".textbox"),g=a.find("input[name=fromDate]"),h=a.find("input[name=retDate]"),i=a.find("select[name=adult]"),j=a.find("select[name=child]");b.text(""),b.get(0)||(b={text:function(a){a&&window.alert(a)}}),i.on("focus",function(){$(this);b.text("")}),j.on("focus",function(){$(this);b.text("")}),a.on("submit",function(){var a=parseInt($.trim(i.val()),10),k=parseInt($.trim(j.val()),10);if(!$.trim(e.val()))return e.focus(),!1;if(!$.trim(c.val()))return b.text("出发城市不存在！"),e.focus(),!1;if(!$.trim(f.val()))return f.focus(),!1;if(!$.trim(d.val()))return b.text("抵达城市不存在！"),f.focus(),!1;if(!$.trim(g.val()))return g.focus(),!1;if($.trim(e.val())===$.trim(f.val()))return b.text("出发城市与到达城市不能相同！"),!1;if($.trim(h.val())&&Date.parse($.trim(g.val()).replace(/-/g,"/"))>Date.parse($.trim(h.val()).replace(/-/g,"/")))return b.text("返回日期必须大于等于出发日期！"),!1;if(!a&&!k)return b.text("请选择出行人数！"),!1;if(!a&&k)return b.text("儿童单独乘机需直接向航空公司购票！"),!1;if(a){if(a+k>9)return b.text("乘客人数须小于等于9人！"),!1;if(k/2>a)return b.text("目前只支持1个成人最多携带2名儿童！"),!1}return!0})}function pageOrder(){try{document.domain="uzai.com"}catch(a){}var b=(location.href.toLowerCase(),_util.url.get("startcity")),c=_util.url.get("endcity"),d=_util.url.get("fromdate"),e=_util.url.get("retdate");$("#fromCity").val(window.getCityByCode(b)),$("#em-fromcity").text(window.getCityByCode(b)),$("#toCity").val(window.getCityByCode(c)),$("#em-tocity").text(window.getCityByCode(c)),e&&($("#j_jipiaoListSearch").find(".fade-on").removeClass("fade-on").removeClass("fade"),$("#j_switchWay").val("round")),$("input[name=fromDate]").val(d),$("input[name=retDate]").val(e);var f=$("#j_sortList");f.on("click",".btn-order",function(){if(!_uzw.user.userid)return void _uzw.iframe.pop("http://u.uzai.com/QuickLogin?actionName=DoSubmit&tel=",640,315);var a=$(this).attr("token"),b=$("#hid_FlightClass").val(),c=$("#hid_AdultNum").val(),d=$("#hid_ChildNum").val();$.ajax({type:"POST",dataType:"json",url:"/UzaiFlight/Verify",data:{token:a,flightClass:b,adultNum:c,childNum:d},beforeSend:function(){initPop("pop-check")},success:function(b){if(1==b.status){initPop("pop-disable");var c=$(".pop-disable"),d=c.find(".downcount"),e=(parseInt(d.text(),10),5),f=setInterval(function(){d.text(--e),0===e&&(_uzw.ui.mask.hide(),c.hide(),d.text(5),clearInterval(f),$("#flightForm").submit())},1e3)}else $("#hid_token").val(a),$("#bookFrom").submit()}})})}function contentSwitch(){var a=$("#j_formsListing"),b=$("#j_slideFilterBar").find(".side-filter").find(".switch"),c=b.parent("dt").next("dd").children("p"),d=c.length;a.find(".btn-switch").on("click",function(){var a=$(this),b=a.parents(".ft-bar").find(".advanced-search");a.hasClass("on")?(b.hide(),a.removeClass("on")):(b.show(),a.addClass("on"))}),b.on("click",function(){var a=$(this),b=a.find(".border-arrow"),c=a.parent("dt").next("dd").children("p").eq(4).nextAll();b.hasClass("on")?(b.removeClass("on"),c.hide()):(b.addClass("on"),c.show())}),d>5?c.eq(4).nextAll().hide():b.hide()}function DoSubmit(){_uzw.user.refresh()}function closePop(){$(".pop-close").on("click",function(){var a=$(this),b=a.parent(".pop-tips-mod");_uzw.ui.mask.hide(),b.hide()})}function initPop(a){$(".pop-tips-mod").hide(),_uzw.ui.mask.show();var b=$("."+a);b.show(),closePop()}function fixIe8(a){_util.check.isIE678&&(a.hasClass("visibility-fix")?a.removeClass("visibility-fix"):a.addClass("visibility-fix"))}var globalCitySelect=null;winLoadFix(searchControlBar),$(function(){jipiaoSlides(),multiCalendar(),listFilter(),listFilterSorter(),tipsInfo(),_uzw.ui.tab("j_specialTicketTab"),window.comGlobalCity&&window.comGlobalCity(),indexSubmit(),pageOrder(),fixInputErr(),contentSwitch()});
//# sourceMappingURL=/sourcemaps/content/v1/scripts/jipiao/script.js.map