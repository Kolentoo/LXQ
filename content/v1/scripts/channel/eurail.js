/*! uzai - v0.1.11 - 2017 */

function fixInputErr(){$(document).on("blur",".input-err",function(){var a=$(this);a.removeClass("input-err");var b=$("#j_lrfTips");b.text("")})}function searchControlBar(){var a=$("#j_jpCityListNode"),b=$(".j_switchCity");b.on("click",function(){var a=$(this),b=a.parents(".item-city"),c=b.find(".cities-select-wrap").eq(0).find(".fill"),d=c.siblings("input:hidden"),e=b.find(".cities-select-wrap").eq(1).find(".fill"),f=e.siblings("input:hidden"),g=c.val(),h=e.val(),i=d.val(),j=f.val();c.val(h),e.val(g),d.val(j),f.val(i)}),$("input[data-cities-trigger]").on("focus",function(){var b=$(this),c=b.next("input[type=hidden]");$(".cities-select-mod").hide(),$("#j_jpAllCityFilter").remove();var d=b.parent(".cities-select-wrap");$(".cities-select-wrap").css({"z-index":"auto"});var e=b.siblings(".cities-select-mod");e.after('<ul class="hide city-filter-mod" id="j_jpAllCityFilter"></ul>'),trainSelect=$("#j_jpAllCityFilter");var f=e.find(".cities-select-tab");f.get(0)||(e.html(a.html()),_uzw.ui.tab("cities-select-tab"),e.find(".select-item").on("click",function(){var a=$(this),f=a.text(),g=a.attr("data-code");b.val(f),c.val(g),e.hide(),d.css({"z-index":"auto"})})),e.show(),d.css({"z-index":10}),blankFix("cities-select-wrap","cities-select-mod",function(){d.css({"z-index":"auto"}),trainSelect.find("li").not(".li-none").eq(0).click(),trainSelect.remove()}),e.find(".close-wrap").on("click",function(){e.hide(),d.css({"z-index":"auto"})})})}function countryControl(){var a=$("#j_jpCountryListNode");$("input[data-countries-trigger]").on("focus",function(){var b=$(this),c=b.next("input[type=hidden]");$(".countries-select-mod").hide(),$("#j_jpAllCountryFilter").remove();var d=b.parent(".countries-select-wrap"),e=b.siblings(".countries-select-mod");e.after('<ul class="hide city-filter-mod" id="j_jpAllCountryFilter"></ul>'),trainCountrySelect=$("#j_jpAllCountryFilter");var f=e.find(".countries-select-tab");f.get(0)||(e.html(a.html()),_uzw.ui.tab("countries-select-tab"),e.find(".select-item").on("click",function(){var a=$(this),f=a.find(".s1").text(),g=a.attr("data-code");b.val(f),c.val(g),e.hide(),d.css({"z-index":"auto"})})),e.show(),d.css({"z-index":10}),blankFix("countries-select-wrap","countries-select-mod",function(){d.css({"z-index":"auto"}),trainCountrySelect.find("li").not(".li-none").eq(0).click(),trainCountrySelect.remove()}),e.find(".close-wrap").on("click",function(){e.hide(),d.css({"z-index":"auto"})})})}function eurailPager(){var a=$(".fn-pager");a.get(0)&&a.each(function(){var a=$(this),b=parseInt(a.attr("data-pagesize"),10),c=parseInt(a.attr("data-counts"),10);a.uzPager({pageSize:b,pageItems:c,targetNode:a.siblings(".pager-target-node"),onInit:function(){},onCallback:function(a,b){}})})}function eurailSlides(){var a=$("#j_bannerSlides");a.get(0)&&(a.slides({currentClass:"on",fadeSpeed:300,effect:"fade",crossfade:!0,hoverPause:!0,pause:1e3,play:6e3,generatePagination:!0}),a.find(".slides_control").css({width:"100%"}));var b=$("#j_dateSlides"),c=0,d=b.find(".slide-item").find("li.on"),e=d.parent(".slide-item").index();b.get(0)&&b.slides({currentClass:"on",next:"btn-next",prev:"btn-prev",slideSpeed:300,slideEasing:"easeOutQuad",effect:"slide",hoverPause:!1,pause:1e3,start:e+1||1,play:0,generateNextPrev:!1,generatePagination:!1,slidesLoaded:function(){var a=b.find(".slide-item");a.width(b.width()-70),c=b.find(".slide-item").length,b.find(".btn-item").removeClass("btn-off"),0===e&&b.find(".ds-btn-prev").addClass("btn-off"),b.find(".ds-btn-next").on("click",function(){var a=$(this);a.hasClass("btn-off")||b.find(".btn-next").click()}),b.find(".ds-btn-prev").on("click",function(){var a=$(this);a.hasClass("btn-off")||b.find(".btn-prev").click()})},animationComplete:function(a){b.find(".btn-item").removeClass("btn-off"),a===c?b.find(".ds-btn-next").addClass("btn-off"):1===a&&b.find(".ds-btn-prev").addClass("btn-off")}})}function eurailPop(){$(".j_ageExplain").on("click",function(){uiPop("j_popAgeExplain")}),$("#j_passStates").on("click",function(){uiPop("j_popPassStates",".pop-eurail")})}function eurailSearch(){var a=$("#j_bannerTab"),b=a.find(".j_roundTrip"),c=$("#j_eurailSizer").find(".eurail-search"),d=$("#j_switchWay");b.find(".control-radio").on("click",function(){var b=$(this);_switchRoundTrip(b,a)}),d.on("change",function(){var a=$(this);_switchRoundTrip(a,c)})}function multiCalendar(){var a=$("#j_bannerTab"),b=a.find(".j_roundTrip");a.get(0)||(a=$("#j_eurailSizer").find(".eurail-search")),b.get(0)||(b=a.find("#j_switchWay")),$("input[data-multi-calendar]").on("focus",function(){$("#j_lrfTips").html("");var c=$(this),d=c.attr("data-tag"),e=c.parent(),f=e.find(".after-calendar");if($(".after-calendar").hide(),$(".j_afterCalendarWrap").css({"z-index":"auto"}),!f.get(0)){c.after('<div class="after-calendar ca-norm ca-norm-multi"></div>'),f=e.find(".after-calendar");var g={jsonpUrl:"",latestDate:"",skipDays:7,extCallBack:function(a,b){f.find(".item").on("click",function(){var a=$(this),b=a.hasClass("item-expiry")||a.hasClass("item-gray")||a.hasClass("item-unused");if(!b){var d=a.attr("data-year"),g=a.attr("data-month"),h=a.attr("data-day");c.val(d+"-"+g+"-"+h),f.hide(),e.css({"z-index":"auto"})}})},preCallback:function(a,b){}};f.jsonMultiCalendar(g)}if("end"==d){var h=b.find('.control-radio[data-trip="round"]');h.get(0)||(b.val("0"),h=b),_switchRoundTrip(h,a),f.show()}f.show(),e.css({"z-index":10}),blankFix("j_afterCalendarWrap","after-calendar",function(){e.css({"z-index":"auto"})})})}function _switchRoundTrip(a,b){if(a.get(0)&&b.get(0)){var c=a,d=(c.children("input"),c.siblings(".control-radio")),e=c.attr("data-trip");e||(e=c.val()),b.find(".after-calendar").hide(),d.removeClass("control-radio-on"),c.addClass("control-radio-on"),c.find("input").prop("checked",!0),"single"==e||1==e?(b.find(".fade").addClass("fade-on"),b.find('input[data-tag="end"]').val("")):b.find(".fade").removeClass("fade-on")}}function tipsInfo(){var a=function(a){a.on("mouseenter",".hover-wrap",function(){var a=$(this);a.addClass("hover-wrap-on")}).on("mouseleave",".hover-wrap",function(){var a=$(this);a.removeClass("hover-wrap-on")})};a($(".j_infoTable")),a($("#j_eurailSizer")),a($("#j_passIntroTab"));var b=$(".j_powerFloat");b.get(0)&&b.powerFloat({reverseSharp:!0})}function contentSwitch(){var a=$("#j_eurailSizer");a.find(".searched-bar").on("click",".btn-switch",function(){var a=$(this),b=a.parents(".searched-bar").siblings(".eurail-search");a.hasClass("on")?(a.removeClass("on"),b.hide()):(a.addClass("on"),b.show())}),$(".j_infoTable").on("click",".btn-switch",function(){var a=$(this),b=a.find(".switch-cont"),c=a.find(".arrow-mod"),d=a.parents(".item-row").siblings(".hide");c.hasClass("on")?(c.removeClass("on"),b.text("更多"),d.hide()):(c.addClass("on"),b.text("收起"),d.show());var e=$(".main-box");_util.check.isIE678&&e.get(0)&&(e.hasClass("visibility-fix")?e.removeClass("visibility-fix"):e.addClass("visibility-fix"))})}function uiPop(a,b,c,d){var e=$("#"+a);d=d||$(window).height()/2,b=b||".ui-pop",e=e.get(0)?e:$("."+a),_uzw.ui.mask.show(),e.show(),e.on("click",".j_popClose",function(){var a=$(this);a.parents(b).hide(),_uzw.ui.mask.hide()}),c&&c(e),_util.check.isIE6&&(e.css("top",$(document).scrollTop()+d),$(window).on("scroll",function(){e.css("top",$(document).scrollTop()+d)}))}function fixIe6(a,b){var c=$("#"+a);c=c.get(0)?c:$("."+a),b=b||$(window).height()/2,_util.check.isIE6&&(c.css("top",$(document).scrollTop()+b),$(window).on("scroll",function(){c.css("top",$(document).scrollTop()+b)}))}function indexSubmit(){var a=function(){var a=$(".j_roundTrip");a.get(0)&&(a.find(".control-radio").removeClass("control-radio-on"),a.find("input[name=roundtripMode]").prop("checked",!1),a.each(function(a,b){var c=$(this);c.find(".control-radio").first().addClass("control-radio-on"),c.find("input[name=roundtripMode]").first().prop("checked",!0)}),$("input[name=returnDate]").val(""))};a();var b=$("#onewayform"),c=$("#tongpiaoform"),d=$("#seatform"),e=function(a){if(a.get(0)){var b=$("#j_lrfTips");b.text(""),b.get(0)||(b={text:function(a){alert(a)}});var c=a.find("input[name=fromcity]"),d=a.find("input[name=endcity]"),e=c.prev("input"),f=d.prev("input"),g=a.find("input[name=departureDate]"),h=a.find("input[name=returnDate]"),i=0;a.on("submit",function(){if("onewayform"==a.attr("id")||"seatform"==a.attr("id")){var j=a.find("select[name=roundtripMode]");j.get(0)||(j=a.find("input[name=roundtripMode]:checked"));var k=j.val();if(!$.trim(e.val()))return e.focus(),!1;if(!$.trim(c.val()))return b.text("出发城市不存在！"),e.focus(),!1;if(!$.trim(f.val()))return f.focus(),!1;if(!$.trim(d.val()))return b.text("抵达城市不存在！"),f.focus(),!1;if(!$.trim(g.val()))return g.focus(),!1;if($.trim(e.val())==$.trim(f.val()))return b.text("出发城市与到达城市不能相同！"),!1;if(!("0"!=k&&"round"!=k||$.trim(h.val())))return h.focus(),!1;if($.trim(h.val())&&Date.parse($.trim(g.val()).replace(/-/g,"/"))>Date.parse($.trim(h.val()).replace(/-/g,"/")))return b.text("返回日期必须大于等于出发日期！"),!1;for(var l=a.find("input[name=passenger]").val(),m=l.split("|"),n=0;n<m.length;n++)i+=parseInt(m[n],10)}if("onewayform"==a.attr("id")){if(0===i)return b.text("人数不能为0"),!1;if(i>9)return b.text("人数不能超过9人"),!1;h.val()?a.attr("action","/RoundWaySearch/GoRoundSearch"):a.attr("action","/OneWay/OneWaySearch")}else if("seatform"==a.attr("id")){if(0===i)return b.text("人数不能为0"),!1;h.val()?a.attr("action","/SeatRoundWay/GoSeatSearch"):a.attr("action","/SeatOneWay/OneWaySearch")}else if("tongpiaoform"==a.attr("id")){var o=a.find("input[name=countryName]"),p=o.prev("input");if(!$.trim(p.val()))return p.focus(),!1;if(!$.trim(o.val()))return b.text("通票国家不存在！"),p.focus(),!1}return!0})}};e(b),e(c),e(d)}function checkDataStatus(){var a=$("#j_erLoading"),b=$("#j_sortList_loader");return a.get(0)||b.get(0)?(alert("数据载入中，请稍等"),!1):!0}function ticketList(a,b){var c=(location.href.toLowerCase(),$("#j_switchWay").parents("form")),d=c.find("input[name=fromcity]"),e=c.find("input[name=endcity]"),f=d.prev("input"),g=e.prev("input"),h=(c.find("input[name=departureTimeLow]"),c.find("input[name=returnTimeLow]"));h.on("focus",function(){$(this).parents(".fade").removeClass("fade-on"),$("#j_switchWay").val("0")});var i=_util.url.get("fromcity").toUpperCase()||$("#hdfromCityCode").val().toUpperCase(),j=_util.url.get("endcity").toUpperCase()||$("#hdtoCityCode").val().toUpperCase();d.val(i),g.val(j),f.val(getCityByCode(i)),g.val(getCityByCode(j));var k=_util.url.get("passenger"),l="";l=$("#hdadult").get(0)?parseInt($("#hdadult").val(),10)+"|"+parseInt($("#hdchild").val(),10)+"|"+parseInt($("#hdyouth").val(),10)+"|"+parseInt($("#hdsenior").val(),10):$("#hdnPassHolders").get(0)?$("#hdnPassHolders").val():decodeURI(k);var m=l,n=_util.url.get("roundtripmode")||$("#hdroundtripMode").val(),o=_util.url.get("departuredate")||$("#hddepartureDate").val(),p=_util.url.get("returndate")||$("#hdreturnDate").val(),q=_util.url.get("departuretimelow")||$("#departureTimeLow").val(),r=_util.url.get("returntimelow")||$("#returnTimeLow").val();$("#j_switchWay").val(n),"0"===n?c.find(".fade").removeClass("fade-on"):c.find(".fade").addClass("fade-on");var s=n,t=o,u=p,v=q,w=r,x=$("#hdgotrain").val(),y=$("#hdgojounery").val(),z="",A="",B=$("#j_sortList").children("ul"),C=$("#j_moreTrainInfo"),D=$("#j_piaoSwitcher"),E=function(){var a=$("#j_sortList_copy");a.get(0)||(a=$("#j_sortList"));var b=a.children(".filtrate-list").children("li").length,c=a.children(".filtrate-list").children("li[data-piao=0]").length,d=a.children(".filtrate-list").children("li[data-piao=1]").length;b>0&&(c==b||d==b)?(D.find(".bs-item").hide(),D.attr("rel","")):0===b?(D.find(".bs-item").hide(),D.attr("rel","")):(D.find(".bs-item").show(),D.attr("rel","data-piao=1"))},F=function(){$("#j_sortList_null").remove();var a=$("#j_sortConditions"),b=a.find(".sort-list");b.find("li").removeClass("on");var c=b.find("li").find("input:checkbox");b.find("li").eq(0).addClass("on"),b.find("li").eq(0).find("i").removeClass("sort-down").addClass("sort-up"),c.prop("checked",!1),c.parent(".item-cont").attr("rel",""),D.attr("rel","data-piao=1")},G=function(c,d,e){$("#j_erNull").remove();var f={};"0"!=m&&(f.passenger=m),s&&(f.roundtripMode=s),t&&(f.departureDate=t),u&&(f.returnDate=u),i&&(f.fromCityCode=i),j&&(f.toCityCode=j),v&&(f.departureTimelow=v),w&&(f.returnTimeLow=w),d&&(f.latestTrainNumber=d),e&&(f.latestTrainDepartureTime=e),c&&(f.searchtype=c),b&&(f.type=b),x&&(f.hdgotrain=x),y&&(f.hdgojounery=y);var g=$.ajax({url:"/"+a+"/GetMoreTrain",type:"POST",dataType:"json",cache:!1,beforeSend:function(){$("#j_erLoading").remove(),B.append("<div id='j_erLoading'><p class='tc yahei f24 f666'><img src='//r.uzaicdn.com/content/v1/images/common/loader.gif' />数据载入中...</p></div>")},data:f});return g},H=function(a){if($("#j_erLoading").remove(),tipsInfo(),a||a.length){$("#j_erNull").remove();var b=a.state;parseInt(b,0)?C.show():C.remove(),B.append(a.html),z=a.latestTrainNumber,A=a.latestTrainDepartureTime}else C.remove(),$("#j_erNull").remove(),$("#j_sortList_null").remove(),B.after("<div id='j_erNull'><div class='fruitless-box bg-white tc yahei'><i class='icon-uz vm icon-hotels png'></i><span class='f666 f24'>很抱歉!暂时无法找到您要的欧铁信息</span></div></div>"),D.find(".bs-item").hide(),D.attr("rel","");E()};G(1,"","").done(function(a){H(a)}),$(".j_infoTable").parent().on("click","#getmore",function(){F(),$("#j_sortList_copy").get(0)&&(B.html($("#j_sortList_copy").find("ul").html()),$("#j_sortList_copy").remove()),C.hide(),G(2,z,A).done(function(a){H(a)})}),$("#j_dateSlides").find("li").click(function(){if(checkDataStatus()!==!1){var a=$(this),b=a.attr("data-date"),c=$("#j_dateSlides").find("li");c.removeClass("on"),a.addClass("on"),$("#j_moreTrainInfo").get(0)||($(".j_infoTable").after("<p  id='j_moreTrainInfo' class='more-train-info tc mt10'><span class='btn-more f16' id='getmore' data-page='2'>点击查看更多...</span></p>"),C=$("#j_moreTrainInfo")),C.hide(),B.empty(),$("#j_sortList_copy").remove(),t=b,F(),G(1,"","").done(function(a){$("#hddepartureDate").val(t),H(a)})}})}function listFilter(){var a=($("#j_eurailSizer"),$("#j_sortConditions")),b=$("#j_piaoSwitcher"),c=a.find(".sort-list").find("label.item-cont");c.find("input:checkbox").on("change",function(){var a=$(this);return checkDataStatus()?($("#j_erLoading").remove(),$("#j_sortList_loader").remove(),a.prop("checked")?c.attr("rel","data-zhida=0"):c.attr("rel",""),void unitFilter()):(a.prop("checked",!a.prop("checked")),!1)}),b.find(".bs-item").on("click",function(){if(!checkDataStatus())return!1;$("#j_erLoading").remove(),$("#j_sortList_loader").remove();var a=$(this),c=a.index(),d=a.siblings(".bs-item");a.hasClass("on")||(d.removeClass("on"),a.addClass("on"),0===c?b.attr("rel","data-piao=1"):b.attr("rel","data-piao=0"),unitFilter())})}function unitFilter(){var a=$("#j_sortConditions"),b=getFilteredParams(),c=a.find(".sort-list").children(".on").find("span.sort-cont"),d=c.attr("rel"),e=c.children("i");$("#j_moreTrainInfo").hide(),"data-index"==d?initSorter(b,"data-index","asc"):initSorter(b,d,e.hasClass("sort-up")?"asc":"desc")}function listFilterSorter(){var a=$("#j_sortConditions").find(".sort-list").find("span.sort-cont");a.on("click",function(a,b){if(!checkDataStatus())return!1;var c=$(this),d=c.parent(".sort-item"),e=d.siblings(".sort-item");getFilteredParams();e.removeClass("on"),d.addClass("on"),e.find(".icon-sort").removeClass("sort-up").removeClass("sort-down");var f=c.find(".icon-sort");f.hasClass("sort-down")?(f.removeClass("sort-down"),f.addClass("sort-up")):f.hasClass("sort-up")?(f.removeClass("sort-up"),f.addClass("sort-down")):f.addClass("sort-down"),unitFilter()})}function getFilteredParams(){var a=[],b=$("#j_sortConditions").find("label.item-cont");b.attr("rel")&&a.push(b.attr("rel"));var c=$("#j_piaoSwitcher");return"block"==c.children(".bs-item").eq(0).css("display")&&a.push(c.attr("rel")),a.join(",")}function initSorter(a,b,c){var d=$("#j_sortList");if(d.get(0)){if(_util.check.isIE6)return;d.uzSorter({sortBy:a||"",sortAscTag:b||"",sortAscKey:c||"asc",targetNull:"<div class='fruitless-box bg-white tc yahei'><i class='icon-uz vm icon-hotels png'></i><span class='f666 f24'>很抱歉!暂时无法找到您要的欧铁信息</span></div>",tragetAjaxText:"<p class='tc yahei f24 f666'><img src='//r.uzaicdn.com/content/v1/images/common/loader.gif' />数据载入中...</p>",onInit:function(){$("#j_erNull").remove()},onCallback:function(){fixIe8($(".main-box")),$("#j_moreTrainInfo").show(),$("#j_erNull").remove()}})}}function onwaySearchSubmit(a){if(_uzw.user.userid){var b=$(a).parent().parent().find("input.hidseat").val();console.info("单程座位内容"),console.info(b);var c=$(a).parent().parent().find("input.hidjounery").val();console.info("单程行程内容");var d=$(a).parent().parent().find("input.hidorderpost").val();console.info(d),$("#TrainJson").val(d),console.info(c),$("#trainform").submit()}else _uzw.iframe.pop("http://u.uzai.com/QuickLogin?actionName=_uzw.user.refresh",640,315)}function roundsubmit(a){if(_uzw.user.userid){var b=$("#hdgotrain").val();console.info("去程座位内容"),console.info(b);var c=$("#hdgojounery").val();console.info("去程行程内容"),console.info(c);var d=$(a).parent().parent().find("input.hidseat").val();console.info("回程座位内容"),console.info(d);var e=$(a).parent().parent().find("input.hidjounery").val();console.info("回程行程内容"),console.info(e),$("#hdbacktrain").val(d),$("#hdbackjounery").val(e);var f=$(a).parent().parent().find("input.hidorderpost").val();console.info(f),$("#TrainJson").val(f),$("#trainform").submit()}else _uzw.iframe.pop("http://u.uzai.com/QuickLogin?actionName=_uzw.user.refresh",640,315)}function gotrain(a){if(_uzw.user.userid){var b=($("#hdadult").val(),$("#hdyouth").val(),$("#hdchild").val(),$("#hdsenior").val(),$("#hddepartureDate").val(),$("#hddepartureTimeLow").val(),$("#hdfromCityCode").val(),$("#hdtoCityCode").val(),$("#hdroundtripMode").val(),$("#hdreturnDate").val(),$("#hdreturnTimeLow").val(),$(a).parent().parent().find("input.hidseat").val()),c=$(a).parent().parent().find("input.hidjounery").val();$("#hdgotrain").val(b),$("#hdjounery").val(c),$("#trainform").submit()}else _uzw.iframe.pop("http://u.uzai.com/QuickLogin?actionName=_uzw.user.refresh",640,315)}function euSelector(){var a=$(".tb-wrap-selector");a.find("li").find("span").on("click",function(){var a=$(this),c=a.siblings("input"),d=parseInt(c.val(),10);if(a.hasClass("num-cut"))d>=1&&c.val(d-1);else{var e=a.parents("ul").find("input"),f=0;e.each(function(a,b){var c=$(this);f+=parseInt(c.val(),10)}),8>=d&&8>=f&&c.val(d+1)}var g=a.parents(".eu-selector");b(g)});var b=function(a){var b=a.find("input"),c=[],d=[];b.each(function(){var a=$(this),b=a.attr("data-tag"),e=parseInt(a.val(),10);e>0&&c.push(e+b+" "),d.push(e)});var e=a.siblings(".passenger");e.val(c.join("")),e.next("input:hidden").val(d.join("|"))};a.find(".passenger").on("focus",function(){var a=$(this);a.siblings(".eu-selector").show(),blankFix("tb-wrap-selector","eu-selector",function(){})}),a.find(".rules").on("click",function(){uiPop("j_popAgeExplain")})}function euTimer(){var a=$("#j_eurailSizer").find(".timelow");a.on("focus",function(){var a=$(this),b=a.siblings(".eu-timer");b.show();var c=function(){var a=b.find(".hours").find(".on"),c=a.index();b.find(".hours").scrollTop(25*(c-2))};c(),b.find("li").on("click",function(){var d=$(this),e=d.parent(),f=(d.text(),d.siblings("li"));f.removeClass("on"),d.addClass("on"),e.hasClass("minutes")&&b.hide();var g=b.find(".on");a.val(g.eq(0).text()+":"+g.eq(1).text()),c()}),blankFix("tb-wrap-timer","eu-timer",function(){})})}function fixIe8(a){_util.check.isIE678&&(a.hasClass("visibility-fix")?a.removeClass("visibility-fix"):a.addClass("visibility-fix"))}var trainCountrySelect=null,trainSelect=null;try{document.domain="uzai.com"}catch(e){}var eurailLoader={show:function(){var a=$("#j_ajaxLoader");a.get(0)||($("body").append('<div id="j_ajaxLoader"><img src="//r.uzaicdn.com/content/v1/images/common/loader.gif" alt="loader"></div>'),a=$("#j_ajaxLoader")),a.show(),fixIe6("j_ajaxLoader")},hide:function(){$("#j_ajaxLoader").hide()}};$(function(){"undefined"!=typeof comTrainCity&&(comTrainCity(),searchControlBar()),"undefined"!=typeof comTrainCountry&&(comTrainCountry(),countryControl()),_uzw.ui.tab("j_bannerTab",function(a,b){$("#j_lrfTips").html("")}),_uzw.ui.tab("j_passIntroTab"),tipsInfo(),contentSwitch(),eurailPager(),eurailSlides(),eurailPop(),eurailSearch(),multiCalendar(),indexSubmit(),euSelector(),euTimer(),listFilter(),listFilterSorter(),fixInputErr()});var eurailPageLoad=function(){$("#j_popPassStates").get(0)&&FourCountry.Init("eurail")};window.addEventListener?window.addEventListener("load",function(){eurailPageLoad()},!1):window.attachEvent("onload",function(){eurailPageLoad()});var FourCountry={Init:function(a){$.ajax({type:"GET",dataType:"json",url:"/PassTicket/GetTicketCountry",success:function(a){a&&FourCountry.BindSelect(a.fourCountryList)},error:function(a,b,c){}})},BindSelect:function(a){for(var b=$("#firstCountry"),c=$("#secondCountry"),d=$("#thirdCountry"),e=$("#fourthCountry"),f="",g=0;a.length>g;g++)f+="<option value="+a[g].countryCode+">"+a[g].countryName+"</option>";b.append(f),b.change(function(){var f=[];f.push($(this).find("option:selected").text()),FourCountry.SelectAppend(c,a,f),FourCountry.BtnStatus(b,c,d,e)}),c.change(function(){var f=[];f.push($(this).find("option:selected").text()),f.push(b.find("option:selected").text()),FourCountry.SelectAppend(d,a,f),FourCountry.BtnStatus(b,c,d,e)}),d.change(function(){var f=[];f.push($(this).find("option:selected").text()),f.push(b.find("option:selected").text()),f.push(c.find("option:selected").text()),FourCountry.SelectAppend(e,a,f),FourCountry.BtnStatus(b,c,d,e)}),e.change(function(){FourCountry.BtnStatus(b,c,d,e),FourCountry.GoSearch(b,c,d,e)})},SelectAppend:function(a,b,c){var d=FourCountry.CountryArray(b,c);if(d&&d.length){a.empty();for(var e='<option value="">请选择</option>',f=0;d.length>f;f++)e+="<option value="+d[f].countryCode+">"+d[f].countryName+"</option>";a.append(e)}},CountryArray:function(a,b){var c=[],d={};if(a&&b.length){for(var e=0;b.length>e;e++)for(var f=0;a.length>f;f++)if(a[f].countryName!=b[e]);else for(var g=0;a[f].fourCountryList.length>g;g++)d[a[f].fourCountryList[g].countryName]||(c.push(a[f].fourCountryList[g]),d[a[f].fourCountryList[g].countryName]=!0);for(var h=0;b.length>h;h++)for(var i=0;c.length>i;++i)b[h]==c[i].countryName&&c.splice(i,1)}return c},BtnStatus:function(a,b,c,d){a.val()&&b.val()&&c.val()&&d.val()?$(".btn-affirm").hasClass("btn-off")&&($(".btn-affirm").removeClass("btn-off"),$(".btn-affirm").removeAttr("disabled")):$(".btn-affirm").hasClass("btn-off")||($(".btn-affirm").addClass("btn-off"),$(".btn-affirm").attr("disabled","true"))},GoSearch:function(a,b,c,d){var e=a.find("option:selected").val(),f=b.find("option:selected").val(),g=c.find("option:selected").val(),h=d.find("option:selected").val();e&&f&&g&&h&&$(".btn-affirm").on("click",function(){var a="/PassDetails?countryCode="+e+"-"+f+"-"+g+"-"+h;window.location.href=a})}};
//# sourceMappingURL=/sourcemaps/content/v1/scripts/channel/eurail.js.map