/*! uzai - v0.1.11 - 2017 */

function customCarousel(){var a=$(".scenic-carousel"),b=screen.width,c=6;a.find(".scenic-carousel-inner").on("jcarousel:reload jcarousel:create",function(){var d=$(this);1152>=b&&(a.css("width",400),d.css("width",400),c=4)}).jcarousel(),a.find(".prev").on("jcarouselcontrol:active",function(){$(this).removeClass("inactive")}).on("jcarouselcontrol:inactive",function(){$(this).addClass("inactive")}).jcarouselControl({target:"-="+c}),a.find(".next").on("jcarouselcontrol:active",function(){$(this).removeClass("inactive")}).on("jcarouselcontrol:inactive",function(){$(this).addClass("inactive")}).jcarouselControl({target:"+="+c})}function skipStep(a,b){var c=$("#j_customStep"),d=c.find("li");d.find("a").removeClass("on"),d.eq(a-1).find("a").addClass("on"),d.eq(a-1).addClass("ok");var e=$("#j_customMod"),f=e.find(".custom-bd").find(".custom-block");f.hide(),f.eq(a-1).show(),b&&b()}function skipStepExt(){var a=$("#j_customStep"),b=$("#j_customMod");a.find("li").on("click",function(){var a=$(this);if(a.hasClass("ok")){var c=a.index(),d=a.siblings("li");d.find("a").removeClass("on"),a.find("a").addClass("on");var e=b.find(".custom-bd").find(".custom-block");e.hide(),e.eq(c).show()}})}function fillData(a,b){for(var c=$("#"+a).find(".info-bd"),d=b.split("|"),e=[],f=0;f<d.length;f++){var g=d[f];e.push("<label class='tag-item'>"+g+"</label>")}c.html(e.join(""))}function customDestination(){var a=$("#j_destinationBox"),b=$("#txtDestiation"),c=$("#j_siteBox");c.find(".custom-type").find(".type-item").on("click",function(){var a=$(this);a.addClass("on").siblings(".type-item").removeClass("on")}),$(".scenic-list").find("li").on("click",function(){var c=[],d=$(this),e=(d.siblings("li"),d.find("a").attr("title"));if(d.hasClass("on")){var f=$.trim(b.val());if(f.indexOf(e)>-1){var g=f.replace(e,"");b.val($.trim(g))}d.removeClass("on")}else d.addClass("on");var h=a.find("li.on");h.each(function(){var a=$(this),b=a.find("a").attr("title");c.push(b)});var i=$.trim(b.val());if(i){var j=c.join(" ")+" "+i,k=_util.array.unique($.trim(j).split(" "));b.val(k.join(" "))}else b.val(c.join(" "))}),a.find(".btn-next").off("click","**").on("click",function(){var a=c.find(".custom-type").find(".on"),d=b;if(!$.trim(d.val()))return void alert("请输入目的地");var e=$("#txtCity");if(!$.trim(e.val()))return void alert("请输入出发城市");var f=$.trim(d.val()).split(" ");return f.length>=5?void alert("目的地不能多于4个"):(fillData("j_reCustom",$.trim(a.text())),fillData("j_reDest",$.trim(d.val())),fillData("j_reCity",$.trim(e.val())),$("#customType").val($.trim(a.text())),$("#LocationName").val($.trim(d.val())),$("#StartCityName").val($.trim(e.val())),void skipStep(2,customDate))}),b.off("blur","**").on("blur",function(){var b=$(this),c=$.trim(b.val());if(c){var d=c;d=_util.string.replaceAll(d,"，"," "),d=_util.string.replaceAll(d,"｜"," "),d=_util.string.replaceAll(d,"＼"," "),d=_util.string.replaceAll(d,"、"," "),d=_util.string.replaceAll(d,"　"," "),d=_util.string.replaceAll(d,"。"," "),d=_util.string.replaceAll(d,","," "),d=_util.string.replaceAll(d,"/"," "),b.val(d)}for(var e=[],f=b.val().split(" "),g=(_util.array.unique(f),0);g<f.length;g++){var h=f[g];e.push(h)}b.val(e.join(" "));var i=a.find("li");i.removeClass("on"),i.each(function(){var a=$(this),b=a.find("a").attr("title"),c=$.inArray(b,e);c>=0&&a.addClass("on")})}),a.find(".hd").find(".site-type").find(".type-item").on("click",function(){var a=$(this),c=a.index(),d=a.siblings(".type-item"),e=(a.parent(".site-type"),a.parents(".hd").siblings(".bd").children(".item"));d.removeClass("on"),a.addClass("on"),e.hide().eq(c).show(),$(".scenic-list").find("li").removeClass("on"),b.val(""),renderInitAllNode(c)})}function customDate(){var a=$("#j_dateCaledar"),b={jsonpUrl:"",extCallBack:function(b,c){var d=a.find(".item");d.on("click",function(){var a=$(this);return a.hasClass("item-expiry")?!1:(d.removeClass("item-on"),void a.addClass("item-on"))})},preCallback:function(a,b){}};a.get(0)&&a.jsonCalendar(b),$("#j_dateBox").find(".days-items").find("li").off("click","**").on("click",function(){var a=$(this),b=a.siblings("li");b.removeClass("on"),a.addClass("on")}),$("#j_dateBox").find(".btn-next").off("click","**").on("click",function(){var a=$("#j_dateCaledar"),b=a.find(".item-on");if(b.length<=0)return void alert("请选择出发日期");var c=b.attr("data-year"),d=b.attr("data-month"),e=b.attr("data-day"),f=c+"年"+d+"月"+e+"日",g=parseInt(d,10)>9?parseInt(d,10):"0"+parseInt(d,10),h=parseInt(e,10)>9?parseInt(e,10):"0"+parseInt(e,10),i=c+"-"+$.trim(g)+"-"+h,j=new Date,k=j.getFullYear(),l=j.getMonth()+1,m=j.getDate(),n=k+"-"+l+"-"+m,o=new Date(i).getTime(),p=new Date(n).getTime();if(p>o)return void alert("请选择正确的日期");var q=$("#j_dateBox").find(".days-items").find(".on").text();fillData("j_reDate",f+"|"+$.trim(q)),$("#GoDate").val($.trim(f)),$("#DayInfo").val($.trim(q)),skipStep(3,customBuddy)})}function customBuddy(){var a=$("#j_buddyBox");a.find(".buddy-items").find("li").off("click","**").on("click",function(){var a=$(this),b=a.siblings("li");b.removeClass("on"),a.addClass("on")}),$("#j_buddyBox").find(".btn-next").off("click","**").on("click",function(){var a=$("#j_buddyBox"),b=a.find(".buddy-items").find("li.on");if(b.length<=0)return void alert("请选择同游伙伴");var c=$("#txtAdult");if(!c.val())return void alert("请输入成人数量");var d=$("#txtChild"),e="";d.val()&&(e="|儿童"+d.val());var f=$.trim(b.find(".item-hd").text())+"|成人"+$.trim(c.val())+$.trim(e);fillData("j_reBuddy",f),$("#PerSonName").val(b.find(".item-hd").text()),$("#Person").val($.trim(c.val())),$("#Clild").val($.trim(d.val())),skipStep(4,customHotel)})}function customHotel(){var a=$("#j_hotelBox");a.find(".hotel-items").find("li").off("click","**").on("click",function(){var a=$(this),b=a.siblings("li");b.removeClass("on"),a.addClass("on"),fillData("j_reHotel",$.trim(a.find(".item-hd").text())),$("#HotelInfo").val($.trim(a.find(".item-hd").text())),skipStep(5,customBudget)})}function customBudget(){var a=$("#j_budgetBox");a.find(".budget-items").find("li").off("click","**").on("click",function(){var a=$(this),b=a.siblings("li");b.removeClass("on"),a.addClass("on"),fillData("j_reBudget",$.trim(a.find(".item-hd").text())),$("#YuSuan").val($.trim(a.find(".item-hd").text())),skipStep(6,customContact)})}function customContact(){var a=$("#j_contactBox");a.find(".btn-next").off("click","**").on("click",function(){var a=$.trim($("#txtName").val());if(!a)return void alert("请输入您的姓名");var b=$.trim($("#txtMobile").val());if(!b)return void alert("请输入您的手机号码");if(!_uzw.regexForm.mobile(b))return void alert("请输入正确的手机号码");var c=$.trim($("#txtEmail").val());return c?_uzw.regexForm.email(c)?(fillData("j_reContact",a+"|"+b),fillData("j_reContactEmail",c),$("#UserName").val(a),$("#Tel").val(b),void $("#Email").val(c)):void alert("请输入正确的电子邮箱"):void alert("请输入您的电子邮箱")})}function popMod(a,b){var c=$("#"+a);c.get(0)||(c=$("."+a));var d=c.parent();d.find(".mask").height(document.body.clientHeight),d.show().siblings(".pop-mod").hide(),c.show(),c.find(".pop-close").on("click",function(){d.hide(),c.hide()}),$(window).bind("scroll",function(){fixIe6(a,b)})}function fixIe6(a,b){var c=$("#"+a);c.get(0)||(c=$("."+a)),window.XMLHttpRequest||c.css("top",$(document).scrollTop()+b)}function customSubmitForm(){var a=(location.href,_util.url.get("type"));$(".btn-submit").click(function(){var b=$(this),c={customType:$("#customType").val(),LocationName:$("#LocationName").val(),StartCityName:$("#StartCityName").val(),GoDate:$("#GoDate").val(),DayInfo:$("#DayInfo").val(),PerSonName:$("#PerSonName").val(),Person:$("#Person").val(),Clild:$("#Clild").val(),HotelInfo:$("#HotelInfo").val(),YuSuan:$("#YuSuan").val(),UserName:$("#UserName").val(),Tel:$("#Tel").val(),Email:$("#Email").val(),IsOut:$("#IsOut").val(),Token:$("#txtValidator").val(),ref:$("#ref").val(),type:a};return b.hasClass("btn-off")?!1:void(c.UserName&&c.Tel?$.ajax({type:"post",data:c,url:"/PrivateOrder",dataType:"json",beforeSend:function(a){b.addClass("btn-off")},success:function(a){null!==a&&200==a.ErrorCode?popMod("j_popFinish",5):alert(a.ErrorMsg),b.removeClass("btn-off")},error:function(a,c,d){b.removeClass("btn-off")}}):alert("请填写相关信息再定制！"))}),2==a&&($(".header").hide(),$(".side").find(".contact-us").hide(),$("#j_globalSidebar").hide()),$(".close-icon").click(function(){location.reload()})}function renderInitAllNode(a){var b=$("#j_sjCustomAutocomp"),c=b.parent(),d=$("#IsOut"),e=function(a){var d=a.length,e="";b.empty().hide(),c.css({"z-index":"auto"});for(var f=0;d>f;f++)e+="<li><span class='s0'>"+a[f].cityurl+"</span><span class='s1'>"+a[f].name+"</span></li>";b.append(e)};1===a?(d.val(0),e(sjCityList.data.domestic.cityList)):(d.val(1),e(sjCityList.data.intercity.cityList)),b.find("li").on("mouseenter",function(){var a=$(this);b.find("li").removeClass("on"),a.addClass("on")})}function customFilter(){var a=($("#j_siteBox"),$("#j_sjCustomAutocomp")),b=a.parent(),c=$("#txtDestiation");renderInitAllNode(0);var d=function(c){var d=a.find("li"),e=$.trim(c.val().toUpperCase());if(!e)return c.focus(),a.hide(),void b.css({"z-index":"auto"});c.offset().top,c.offset().left,c.height();a.show(),b.css({"z-index":10}),a.find(".li-none").remove(),d.each(function(a,b){var c=$(this),d=c.text().toUpperCase();c.find("s0").text();d.indexOf(e)>-1?c.show():c.hide()});var f=a.find("li:visible"),g=f.length;0===g?(a.hide(),b.css({"z-index":"auto"})):1===g?f.find(".s1").text()===$.trim(c.val().toUpperCase())&&(a.hide(),b.css({"z-index":"auto"})):g>15&&f.each(function(a,b){var c=$(this);a>=15&&c.hide()}),d.off("click"),a.find("li:visible").on("click",function(){var d=$(this),e=d.find(".s1").text();c.val(e),a.hide(),b.css({"z-index":"auto"}),a.find(".on").removeClass("on")})};c.on("keyup",function(a){var b=$(this);d(b)});var e=function(b,c){var d=a.find("li:visible");if("down"===b)if(d.filter(".on").length){var e=d.filter(".on").nextAll("li:visible").eq(0);a.find("li").removeClass("on"),e.get(0)?e.addClass("on"):d.eq(0).addClass("on")}else d.removeClass("on"),d.eq(0).addClass("on");else if("up"===b)if(d.filter(".on").length){var f=d.filter(".on").prevAll("li:visible").eq(0);a.find("li").removeClass("on"),f.get(0)?f.addClass("on"):d.filter(":visible").last("li").addClass("on")}else d.removeClass("on"),d.filter(":visible").last("li").addClass("on");else"enter"===b&&a.find(".on").click()};c.on("keydown",function(a){var b=$(this),c=a.keyCode?a.keyCode:a.which;if("9"!=c&&"16"!=c&&"17"!=c&&"18"!=c)if("38"==c)e("up",b);else if("40"==c)e("down",b);else if("13"==c)return e("enter",b),!1}),$(document).click(function(c){"txtDestiation"!=$(c.target).attr("id")&&(a.hide(),b.css({"z-index":"auto"}))})}function customResize(){var a=screen.width;1152>=a&&$("#j_customMod").addClass("custom-mod-min")}$(function(){customCarousel(),customDestination(),skipStepExt(),customSubmitForm(),customFilter(),customResize()});
//# sourceMappingURL=/sourcemaps/content/v1/scripts/sijia/custom.js.map