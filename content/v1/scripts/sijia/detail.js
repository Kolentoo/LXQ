/*! uzai - v0.1.11 */

function sjCloneTemplate(){var a=$("#j_popFinish").html();$("body").append('<div id="j_popFinishClone">'+a+"</div>");var b=$("#j_popPrompt").html();$("body").append('<div id="j_popPromptClone">'+b+"</div>");var c=$("#j_popHotelIntro").html();$("body").append('<div id="j_popHotelIntroClone">'+c+"</div>");var d=$("#j_popHotelAlbum").html();$("body").append('<div id="j_popHotelAlbumClone">'+d+"</div>")}function detailTab(a){var b=$("#"+a);b.get(0)||(b=$("."+a)),b.find(".bd").find(".item").eq(0).show(),b.find(".hd").on("click","li",function(){var a=$(this),b=a.index();a.addClass("on").siblings().removeClass("on"),a.parent(".hd").next(".bd").find(".item").hide().eq(b).show()})}function navFix(){var a=$("#j_products"),b=$("#j_sjProeuctNav"),c=a.find(".product-sidebar").find("ul"),d=b.outerHeight(),e=b.find(".btn-order"),f=$("#pdtbtnbar").offset().top-d-c.height(),g=a.find(".product-item-tag"),h=b.offset().top;b.find("li").on("click","a",function(){var a=$(this),b=a.parent(),c=b.index(),e=g.eq(c),f=e.offset().top;$("body,html").animate({scrollTop:f-d+5},800)});var i=function(a){var c=b.find("li");c.removeClass("on"),c.eq(a).addClass("on")},j=function(){var a=$(window),j=a.scrollTop();j>=h?(_util.check.isIE6?(b.css({position:"absolute",top:j}),c.css({position:"absolute",top:j+d})):(b.css({position:"fixed",top:"0"}),c.css({position:"fixed",top:d})),e.css({display:"block"})):(b.css({position:"static",top:"auto"}),c.css({position:"static",top:"auto"}),e.css({display:"none"})),j>f&&(b.css({position:"absolute",top:f}),c.css({position:"absolute",top:f+d})),g.each(function(a,b){var c=$(this),e=c.offset().top;j>=e-d&&i(a)})};$(window).scroll(function(){j()}),j()}function lightspotNav(){var a=$("#j_brightSpot"),b=$("#j_detailEntry"),c=(b.find("ul").height(),$("#j_sjProeuctNav")),d=c.outerHeight(),e=a.find(".bs-item");a.offset().top;b.find("li").on("click",function(){var a=$(this),b=a.index(),c=e.eq(b),f=c.offset().top;$("body,html").animate({scrollTop:f-d+10},800)})}function routeNav(){var a=$("#j_productRouting"),b=$("#j_routeNav"),c=b.height(),d=$("#j_sjProeuctNav"),e=d.outerHeight(),f=a.find(".listing-item"),g=b.offset().top-e-10,h=a.next(".product-item-tag").offset().top-c-e-30,i=b.find("li").outerHeight(!0);b.find("li").on("click",function(){var a=$(this),b=a.index(),c=f.eq(b),d=c.offset().top;$("body,html").animate({scrollTop:d-e-i*b-16},800)});var j=function(a){var c=b.find("li");c.removeClass("on"),c.eq(a).addClass("on")},k=function(){var a=$(window),c=a.scrollTop();c>=g&&h>=c?(_util.check.isIE6?b.css({position:"absolute",top:c+e+10}):b.css({position:"fixed",top:e+10}),f.each(function(a,b){var d=$(this),f=d.offset().top;c>=f-e-i*a-17&&j(a)})):c>h?b.css({position:"absolute",top:h+e}):b.css({position:"static",top:"auto"})};$(window).scroll(function(){k()}),k()}function routeSum(){var a=$("#j_overviewMain"),b=a.find(".routing-list"),c=b.find("li").eq(0).outerHeight(),d=a.innerHeight(),e=200,f=d-e,g=function(a){b.stop();var d=function(){var d=b.css("margin-top").replace("px","");return d=0|Number(d),Math.abs(d)>f&&"next"==a?!1:d>0&&"prev"==a?!1:void b.stop().animate({marginTop:("next"==a?"-=":"+=")+c+"px"},250,function(){})};return d()};a.find(".next").on("click",function(){g("next")}),a.find(".prev").on("click",function(){g("prev")})}function detailPop(){var box=$("#j_routingMainBd");$("#j_sjProeuctNav").on("click",".btn-order",function(){var a=$("#j_popHotelCalendarBox"),b={jsonpUrl:"",extCallBack:function(b,c){var d=a.find(".item");d.on("click",function(){var a=$(this),b=(a.find(".day"),a.attr("data-year")+"-"+a.attr("data-month")+"-"+a.attr("data-day")),c=new Date,e=c.getFullYear(),f=c.getMonth()+1,g=c.getDate(),h=e+"-"+f+"-"+g,i=new Date(b).getTime(),j=new Date(h).getTime();if(!(j>i)){d.removeClass("item-on"),a.addClass("item-on"),popMod("j_popInfoWrite",5);var k=$("#txtValidator").parents("li").find("img");k&&k.attr("src",_uzw.domain.buy+"/FamilyTravel/CreateValidateCode?"+Math.random()),$("#txtOdGoDate").val(b),$("#txtDate").val(b);var l=new UZValidator,m=[];m.push({id:"txtAdult",showName:"成人数",dataType:DataType.Number,minValue:1}),m.push({id:"txtOrderUserName",showName:"姓名",dataType:DataType.String,maxLength:20}),m.push({id:"txtPhone",showName:"手机",dataType:DataType.Mobile}),l.init(m,null,PromptModel.DefaultAlert);var n=!1,o=function(){if(n=!0,!l.validate())return n=!1,$("#btnSubmitOrder").parent().removeClass("preload"),void $("#btnSubmitOrder").show();var a=0|Number($("#txtAdult").val().trim()),c=0|Number($("#txtChild").val().trim()),d=0|Number($("#txtOdProductID").val().trim()),e=$("#txtOrderUserName").val().trim(),f=$("#txtPhone").val().trim(),g=$("#txtEmail").val().trim(),h=$("#txtOtherRequire").val().trim(),i=$("#txtValidator").val().trim();if(0>=d)return void alert("未知产品");if($("#txtChild").val().trim()&&!checkNumber($("#txtChild").val().trim()))return void alert("儿童人数格式不正确");if(1>a)return void alert("必须有一个成人才可出行");if(g.trim()&&!checkEmail(g))return void alert("电子邮箱格式不正确");if(!$.trim(i))return void alert("请输入验证码");if(h.length>100)return void alert("其他需求不能超过100字，具体需求客服会再次和您确认");$("#btnSubmitOrder").parent().addClass("preload"),$("#btnSubmitOrder").hide();var j=!1,k="vldCode="+i+"&adultCount="+a+"&childCount="+c+"&orderUserName="+encodeURIComponent(encodeURIComponent(e))+"&mobile="+f+"&email="+encodeURIComponent(encodeURIComponent(g))+"&pid="+d+"&goDate="+b+"&otherrq="+encodeURIComponent(encodeURIComponent(h));$.ajax({type:"GET",dataType:"jsonp",url:_uzw.domain.buy+"/FamilyTravel/SubmitIntendOrder",data:k,jsonp:"callback",jsonpCallback:"callback",success:function(a){$("#imgvdt").click();var b="提交失败!",c=a.result,d="";if(a&&a.result?"success"==c?(j=!0,b="提交成功!",d="<p>您已成功提交预订信息，旅游管家会在1个工作小时内联系您，请您保持手机畅通。</p>"):"yi_error"==c?d="<p>Sorry，您下单失败，如果客服妹子没有翘班的话，会和您联系的哟！</p>":"phonechongfu"==c?d="<p>Sorry，您已被系统拉黑了，禁止下单</p>":"productdisabled"==c?d="<p>Sorry，产品已经失效，不可下单，看看其他产品吧！</p>":"exception"==c?d="<p>Sorry，您下单失败，如果客服妹子没有翘班的话，会和您联系的哟！</p>":"peoplecounterror"==c?d="<p>Sorry，必须有一个成人才可出行！</p>":"validatecodeerror"==c?d="<p>Sorry，您输入的验证码错误！</p>":"producttypeerror"==c?d="<p>Sorry，非私家团产品不可在此下单！</p>":"validateparamerror"==c&&(d="<p>Sorry，请检查您提交的数据格式（如：手机号）是否正确！</p>"):(b="提交成功!",d=""),j){var e=$("#j_popFinishClone").html();e=e.replace("@{title}",b),e=e.replace("@{content}",d),$("#j_popFinish").html(e),popMod("j_popFinish",5)}else{var f=$("#j_popPromptClone").html();f=f.replace("@{title}",b),f=f.replace("@{content}",d),$("#j_popPrompt").html(f),$("#j_popInfoWrite").parents(".pop-mod").show(),$("#j_popPrompt").parents(".pop-mod").show(),$("#j_popPrompt").find(".pop-close").on("click",function(){var a=$(this);a.parents(".pop-mod").hide()})}n=!1,$("#btnSubmitOrder").parent().removeClass("preload"),$("#btnSubmitOrder").show()},error:function(a,b,c){$("#imgvdt").click();var d="提交失败!",e="悠哉君不知道怎么了，请稍后再试!",f=$("#j_popPromptClone").html();f=f.replace("@{title}",d),f=f.replace("@{content}",e),$("#j_popPrompt").html(""),$("#j_popPrompt").html(f),$("#j_popInfoWrite").parents(".pop-mod").show(),$("#j_popPrompt").parents(".pop-mod").show(),$("#j_popPrompt").find(".pop-close").on("click",function(){var a=$(this);a.parents(".pop-mod").hide()}),n=!1,$("#btnSubmitOrder").parent().removeClass("preload"),$("#btnSubmitOrder").show()},complete:function(){$("#imgvdt").click(),$("#btnSubmitOrder").parent().removeClass("preload"),$("#btnSubmitOrder").show()}})};document.getElementById("btnSubmitOrder").onclick=function(){o()}}})},preCallback:function(a,b){}};return a.get(0)&&a.jsonCalendar(b),popMod("j_popHotelCalendar",5),!1}),$("#j_popInfoWrite").find(".return-calendar").on("click",function(){popMod("j_popHotelCalendar",5)});var _amapObj;box.find(".listing-item-cont").find(".hotel-link").on("click",function(){$("#j_popHotelIntro").removeClass("hotel-intro-nobg"),$("#j_popHotelIntro .intro-box .hotel-hd").hide(),$("#j_popHotelIntro .intro-box .tab .bd").hide(),popMod("j_popHotelIntro",5);var o=$(this),index=o.index(),hotelID=0|Number($.trim(o.attr("hotelID"))),hoteldetailspop=$("#j_popHotelIntro"),hoteldetailstmpt=$("#j_popHotelIntroClone").html(),hotelAlbumpop=$("#j_popHotelAlbum"),hotelAlbumtmpt=$("#j_popHotelAlbumClone").html();return hotelID>0&&$.ajax({type:"GET",url:"/GetHotelDetails/"+hotelID,success:function(resp){var hotelDetail=null;try{hotelDetail=eval("("+resp+")")}catch(ex){}if(hotelDetail){var hname="",hintro="",fwss="",address="",hotelWebUrl="",hotelWebUrlShowName="",himghtml="",halbumimghtml="",firstHotelImgUrl="",firstHotelImgName="",hotellng="",hotellat="",ImgCount=0;if(hotelDetail.hname&&(hname=hotelDetail.hname),hotelDetail.hsynopsis&&(hintro=hotelDetail.hsynopsis),hotelDetail.fwss&&$.trim(hotelDetail.fwss)){var fwssarr=hotelDetail.fwss.split(",");if(fwssarr&&fwssarr.length)for(var i=0;i<fwssarr.length;i++)fwss+="<span class='facility-item'><i>√</i>"+fwssarr[i]+"</span>"}if(hotelDetail.address&&(address=hotelDetail.address),hotelDetail.url&&(hotelWebUrl=hotelDetail.url,$.trim(hotelWebUrl)&&(hotelWebUrlShowName="官网")),hotelDetail.jd&&(hotellat=hotelDetail.jd),hotelDetail.wd&&(hotellng=hotelDetail.wd),hotelDetail.HotelPic&&hotelDetail.HotelPic.HotelImgList.length){ImgCount=hotelDetail.HotelPic.HotelImgList.length;var firstImg=hotelDetail.HotelPic.HotelImgList[0];firstHotelImgUrl=firstImg.ImageUrl,firstHotelImgName=firstImg.ImageName;for(var k=0,j=0;j<hotelDetail.HotelPic.HotelImgList.length;j++)k>0&&6>=k&&(himghtml+="<dd class='fl'><a href='#'><img alt='"+hotelDetail.HotelPic.HotelImgList[j].ImageName+"' src='"+hotelDetail.HotelPic.HotelImgList[j].ImageUrl+"'></a></dd>"),halbumimghtml+="<div class='item'><img alt='' src='"+hotelDetail.HotelPic.HotelImgList[j].ImageUrl+"'><p class='txt f14'>"+hotelDetail.HotelPic.HotelImgList[j].ImageName+"</p></div>",k++}hoteldetailstmpt=hoteldetailstmpt.replace(/\{HotelName\}/g,hname),hoteldetailstmpt=hoteldetailstmpt.replace(/\{FirstImgUrl\}/g,firstHotelImgUrl),hoteldetailstmpt=hoteldetailstmpt.replace(/\{FirstImgName\}/g,firstHotelImgName),hoteldetailstmpt=hoteldetailstmpt.replace(/\{ImgCount\}/g,ImgCount),hoteldetailstmpt=hoteldetailstmpt.replace(/\{HotelIntroduction\}/g,hintro),hoteldetailstmpt=hoteldetailstmpt.replace(/\{HotelService\}/g,fwss),hoteldetailstmpt=hoteldetailstmpt.replace(/\{HotelWebUrl\}/g,hotelWebUrl),hoteldetailstmpt=hoteldetailstmpt.replace(/\{HotelWebUrlShowName\}/g,hotelWebUrlShowName),hoteldetailstmpt=hoteldetailstmpt.replace(/\{HotelImgList\}/g,himghtml),hoteldetailspop.html(hoteldetailstmpt),hotelAlbumtmpt=hotelAlbumtmpt.replace(/\{HotelName\}/g,hname),hotelAlbumtmpt=hotelAlbumtmpt.replace(/\{HotelWebUrl\}/g,hotelWebUrl),hotelAlbumtmpt=hotelAlbumtmpt.replace(/\{HotelWebUrlShowName\}/g,hotelWebUrlShowName),hotelAlbumtmpt=hotelAlbumtmpt.replace(/\{HotelImgList\}/g,halbumimghtml),hotelAlbumpop.html(hotelAlbumtmpt);var num=$("#j_popHotelAlbum").find(".album-slides").find(".item").length,numInfo=$("#j_popHotelAlbum").find(".album-num-info"),numC=numInfo.find("em"),numA=numInfo.find("i");numA.text(num),$(".album-slides").slides({preload:!0,preloadImage:"//r.uzaicdn.com/content/v1/images/common/preload.gif",currentClass:"on",effect:"slide",slideSpeed:500,hoverPause:!1,pause:3e3,play:0,generatePagination:!1,animationComplete:function(a){numC.text(a)}}),$("#j_popHotelIntro").find(".hotel-album").find("img").on("click",function(){$(this);return popMod("j_popHotelAlbum",5),$("#j_popHotelAlbum").find(".icon-sijia").show(),$(".toolbar").find("prev").show(),!1}),$("#j_popHotelAlbum").find(".toolbar").find(".back").on("click",function(){return popMod("j_popHotelIntro",5),!1}),$("#j_popHotelIntro").find(".tab").find("li").on("click",function(){var a=$(this),b=a.parents(".tab"),c=a.index(),d=b.find(".bd").find(".item"),e=d.eq(c),f=a.siblings("li");if(a.addClass("on"),f.removeClass("on"),d.hide(),e.show(),1==c&&hotellng&&hotellat){if(!_amapObj||!_amapObj){var g={doubleClickZoom:!1,scrollWheel:!0,view:new AMap.View2D({center:new AMap.LngLat(hotellng,hotellat)}),zoom:9};_amapObj=new AMap.Map("hotelmap",g),_amapObj.plugin(["AMap.ToolBar"],function(){toolBar=new AMap.ToolBar,_amapObj.addControl(toolBar)})}hotelMapInit(_amapObj,hotellng,hotellat,hname)}}),$(".hotel-hd .site").each(function(){var a=$(this),b=a.attr("data-href");b&&a.attr("href",b)}),$(".intro-box .frthtlimg").each(function(){var a=$(this),b=a.attr("data-url");b&&a.attr("src",b)}),$("#j_popHotelIntro").addClass("hotel-intro-nobg"),popMod("j_popHotelIntro",5),$("#j_popHotelIntro .intro-box .hotel-hd").show(),$("#j_popHotelIntro .intro-box .tab .bd").show()}},error:function(){}}),!1})}function popMod(a,b){var c=$("#"+a);c.get(0)||(c=$("."+a));var d=c.parent();d.children(".mask").height(document.body.clientHeight),d.show().siblings(".pop-mod").hide(),c.show(),c.find(".pop-close").on("click",function(){d.hide(),c.hide()}),$(window).bind("scroll",function(){fixIe6(a,b)})}function fixIe6(a,b){var c=$("#"+a);c.get(0)||(c=$("."+a)),window.XMLHttpRequest||c.css("top",$(document).scrollTop()+b)}function detailSlides(){var a=$(".j_routePhotoList");a.get(0)&&(a.each(function(a){var b=$(this),c=b.find(".item").length;c>1&&(b.find(".slides-prev").show(),b.find(".slides-next").show(),b.slides({preload:!0,preloadImage:"//r.uzaicdn.com/content/v1/images/common/preload.gif",currentClass:"on",next:"slides-next",prev:"slides-prev",slideSpeed:300,slideEasing:"easeOutQuad",effect:"slide",hoverPause:!1,pause:1e3,play:0,generateNextPrev:!1,generatePagination:!1,slidesLoaded:function(a){var c=b.find(".slides-prev,.slides-next");c.on("click",function(){var a=$(this),b=a.parents().find(".slides_container"),c=b.find("img");c.each(function(){var a=$(this),b=a.attr("data-original");b!=a.attr("src")&&a.attr("src",b)})})}}))}),fixScreen())}function fixScreen(){var a=screen.width,b=$(".j_routePhotoList"),c=b.find(".slides_container").find(".item"),d=b.eq(0).width();1152>=a?d&&c.width(d+4):d&&c.width(d+5)}function imgPreview(a,b){var c;c=$("#imgPreviewContainer").get(0)?$("#imgPreviewContainer"):$("<div/>").attr("id","imgPreviewContainer").append("<img/>").hide().css("position","absolute").appendTo("body");var d=$("img",c),e=a.find("img["+b+"]");e.on("mousemove",function(a){var b=$(window).width()-c.width()-50,d=a.pageX>b?b:a.pageX+10;c.css({top:a.pageY+10,left:d,zIndex:99})}).hover(function(){var a=$(this);c.show(),d.load(function(){d.show().animate({opacity:1},300)}).attr("src",a.attr(b))},function(){c.hide(),d.unbind("load").attr("src","").hide().stop().css({opacity:0})})}$(function(){uzLazy(["album-mod","line-pic","j_routePhotoList","viewed-list"]),getProductPrice(),sjCloneTemplate(),detailTab("j_jobTypeTab"),navFix(),lightspotNav(),routeNav(),routeSum(),detailPop(),detailSlides(),imgPreview($(".slides_container"),"data-original")});var getProductPrice=function(){var a=0|Number($.trim($("#txtOdProductID").val()));a>0&&$.ajax({type:"GET",url:"/GetProductPrice/"+a,success:function(a){var b="0",c=0;if(a){var d=a.split("#");c=d.length>0?d[0]:"0",b=d.length>1?d[1]:"0"}var e=0|Number(b),f=0|Number(c);if(f>0&&e>0){var g="<p class='price-mod f14'><i class='price'>￥<em class='f24 b'>"+e+"</em></i>起/人</p>";g+="<p class='btn-bar pt5'><a href='javascript:void(0);' class='btn-order tc'>立即预订</a></p>",$("#pdtpriceone").html(g);var h="<a href='javascript:void(0);' class='btn-order'>立即预订</a>";$("#j_sjProeuctNav").find(".btn-order").length<=0&&$("#j_sjProeuctNav").prepend(h);var i="<a href='javascript:void(0);' class='btn-order btn-item yahei tc'>立即预订</a>";$("#pdtbtnbar").find(".btn-order").length<=0&&$("#pdtbtnbar").prepend(i),$(".main-cont, #j_infoMain").on("click",".btn-order",function(){return detailPop(),$("#j_sjProeuctNav").find(".btn-order").click(),!1})}else $("#pdtpriceone").html("<p class='price-mod f14 yahei'><em class='f24 b'>请来电咨询</em></p>"),$("#j_sjProeuctNav").find(".btn-order").remove(),$("#pdtbtnbar").find(".btn-order").remove()},error:function(){}})};
//# sourceMappingURL=/sourcemaps/content/v1/scripts/sijia/detail.js.map