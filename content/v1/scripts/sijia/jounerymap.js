/*! uzai - v0.1.11 - 2017 */

function findByLngLat(a,b,c){var d=null;if(a&&a.length)for(var e=0;e<a.length;e++){var f=a[e];if(f&&f.Lng&&f.Lat&&f.Lng==b&&f.Lat==c){d=f;break}}return d}function ascLngLatArr(a){a&&a.length&&a.sort(function(a,b){return a.CommonID>b.CommonID?1:-1})}function ascLngLatArrByDays(a){a&&a.length&&a.sort(function(a,b){return a.Days>b.Days?1:-1})}function deleteByLngLat(a,b,c){if(a&&a.length)for(var d=0;d<a.length;d++){var e=a[d];e&&e.Lng&&e.Lat&&e.Lng==b&&e.Lat==c&&a.splice(d,1)}}function jouneryMapInit(){function addMarker(a,b){var c="",d=0;if(b&&b.DayList&&b.DayList.length){for(var e=0;e<b.DayList.length;e++)c+="<div class='amap-csicon fl' data-day='"+b.DayList[e]+"'><img src='//r.uzaicdn.com/content/v1/images/sijia/D"+b.DayList[e]+".png'></div>";b.DayList.length>1&&(d=30*b.DayList.length);var f=new AMap.Marker({map:mapObj,position:new AMap.LngLat(b.Lng,b.Lat),topWhenClick:!0,offset:new AMap.Pixel(-14,-37),content:"<div class='location-wrap' style='width:"+d+"px;'><div class='location-"+b.CommonKey+" clearfix'>"+c+"</div><div class='location-inner'><div class='decorate-bar'></div></div></div>"});markerArr.push(new AMap.LngLat(b.Lng,b.Lat)),markerCustomArr.push({Index:a,Lng:b.Lng,Lat:b.Lat});var g=new AMap.InfoWindow({content:'<h3><font color="#00a6ac">  '+b.LocationName+"</font></h3>",size:new AMap.Size(200,0),autoMove:!0,offset:new AMap.Pixel(-0,-30)});windowsArr.push(g);var h=function(a){mapObj.setZoomAndCenter(mapObj.getZoom(),new AMap.LngLat(b.Lng,b.Lat)),setTimeout(function(){g.open(mapObj,f.getPosition())},100)};AMap.event.addListener(f,"click",h)}}var windowsArr=[],markerArr=[],markerCustomArr=[],i=0,j=0,jouneryItem,jouneryTravelType,centerL,centerW,hdJouneryPointJson=document.getElementById("hdJouneryPointJson").value,jouneryPointArray=eval("("+hdJouneryPointJson+")");if(jouneryPointArray&&jouneryPointArray.length)for(ascLngLatArrByDays(jouneryPointArray),i=0;i<jouneryPointArray.length;i++)if(jouneryItem=jouneryPointArray[i],jouneryItem.ProductTravelTypes&&jouneryItem.ProductTravelTypes.length){var isbreak=!1;for(j=0;j<jouneryItem.ProductTravelTypes.length;j++)if(jouneryTravelType=jouneryItem.ProductTravelTypes[j],jouneryTravelType&&jouneryTravelType.Longitude&&jouneryTravelType.Latitude&&$.trim(jouneryTravelType.Longitude)&&$.trim(jouneryTravelType.Latitude)){centerL=jouneryTravelType.Latitude,centerW=jouneryTravelType.Longitude,isbreak=!0;break}if(isbreak)break}centerL&&centerW||(centerL="121.49967",centerW="31.239866");var mapObj,route,toolBar,view,opt={doubleClickZoom:!1,scrollWheel:!0,view:new AMap.View2D({center:new AMap.LngLat(centerL,centerW),zoom:3.8})};mapObj=new AMap.Map("jounerymap",opt);var path=[],lnglatObjArr=[];if(jouneryPointArray&&jouneryPointArray.length){var k=1;for(i=0;i<jouneryPointArray.length;i++)if(jouneryItem=jouneryPointArray[i],jouneryItem.ProductTravelTypes&&jouneryItem.ProductTravelTypes.length)for(j=0;j<jouneryItem.ProductTravelTypes.length;j++)if(jouneryTravelType=jouneryItem.ProductTravelTypes[j],jouneryTravelType&&jouneryTravelType.Longitude&&jouneryTravelType.Latitude&&$.trim(jouneryTravelType.Longitude)&&$.trim(jouneryTravelType.Latitude)){path.push(new AMap.LngLat(jouneryTravelType.Latitude,jouneryTravelType.Longitude));var fdItem=findByLngLat(lnglatObjArr,jouneryTravelType.Latitude,jouneryTravelType.Longitude);if(fdItem){var newObj={};newObj.Lng=jouneryTravelType.Latitude,newObj.Lat=jouneryTravelType.Longitude,newObj.StartDay=jouneryItem.Days,newObj.CommonKey=k,newObj.LocationName=jouneryTravelType.TreeName,newObj.Total=1,newObj.DayList=[],newObj.DayList.push(jouneryItem.Days),lnglatObjArr.push(newObj),k++}else deleteByLngLat(lnglatObjArr,fdItem.Lng,fdItem.Lat),fdItem.DayList.existByInt(jouneryItem.Days)||(fdItem.Total=fdItem.Total+1,jouneryItem.Days<fdItem.StartDay&&(fdItem.StartDay=jouneryItem.Days),fdItem.DayList.noRepeatPush(jouneryItem.Days),fdItem.DayList.ascSort(),lnglatObjArr.push(fdItem),ascLngLatArr(lnglatObjArr))}var lnglatObjArrCopy=lnglatObjArr;if(lnglatObjArr&&lnglatObjArr.length)for(i=0;i<lnglatObjArr.length;i++){var lnglatObj=lnglatObjArr[i];addMarker(i,lnglatObj)}mapObj.plugin(["AMap.ToolBar"],function(){toolBar=new AMap.ToolBar,mapObj.addControl(toolBar)}),polyline=new AMap.Polyline({path:path,strokeColor:"#3E6D02",strokeOpacity:1,strokeWeight:2,strokeStyle:"solid",strokeDasharray:[10,5]}),polyline.setMap(mapObj),$(".jny-address").on("click",function(){var a=$(this);a.css({"background-color":"#c59f4c"});var b=a.attr("lng"),c=a.attr("lat"),d=findByLngLat(markerCustomArr,b,c);d&&(mapObj.setZoomAndCenter(mapObj.getZoom(),new AMap.LngLat(d.Lng,d.Lat)),setTimeout(function(){windowsArr[d.Index].open(mapObj,new AMap.LngLat(d.Lng,d.Lat))},200))}),$(".jny-address").on("mouseover",function(){var a=$(this);a.css({"background-color":"#c59f4c"})}),$(".jny-address").on("mouseout",function(){var a=$(this);a.css({"background-color":"#209bad"})})}}function hotelMapInit(a,b,c,d){var e,f;if(!a||!a){var g={doubleClickZoom:!1,scrollWheel:!0,view:new AMap.View2D({center:new AMap.LngLat(b,c),zoom:9})};a=new AMap.Map("hotelmap",g),a.plugin(["AMap.ToolBar"],function(){f=new AMap.ToolBar,mapObj.addControl(f)})}e=new AMap.Marker({map:a,position:new AMap.LngLat(b,c),offset:new AMap.Pixel(-14,-37),content:"<div class='amap-icon' style='position:absolute;width: 26px;height:37px;opacity: 1;'><img src='http://webapi.amap.com/images/1.png' style='top: 0px; left: 0px;'/></div><div style='position:absolute;left:28px;color:black;font-size:12px;white-space:nowrap;'>"+d+"</div>"})}Array.prototype.noRepeatPush=function(a){var b=!1,c=this;if(c&&c.length)for(var d=0;d<c.length;d++)if(c[d]==a){b=!0;break}b||c.push(a)},Array.prototype.existByInt=function(a){var b=!1,c=this;if(c&&c.length)for(var d=0;d<c.length;d++)if(c[d]==a){b=!0;break}return b},Array.prototype.ascSort=function(){var a=this;a.sort(function(a,b){return a>b?1:-1})};
//# sourceMappingURL=/sourcemaps/content/v1/scripts/sijia/jounerymap.js.map