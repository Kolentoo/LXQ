/*! uzai - v0.1.11 - 2017 */

function roomTab(){var a=$("#j_cabinTab");a.find(".cabin-tab-hd").find("li").on("click",function(){var a=$(this),b=a.index(),c=a.siblings("li");c.removeClass("on"),a.addClass("on");var d=a.parent(".cabin-tab-hd").next(".cabin-tab-bd"),e=d.children(".item");e.hide(),e.eq(b).show()}),a.find(".item-a").find("a").on("click",function(){var a=$(this),b=a.find("i"),c=a.parents("tr").next(".cabin-detail");b.hasClass("arrow-on")?(b.removeClass("arrow-on"),c.hide()):(b.addClass("arrow-on"),c.show())})}function numControl(){var a=function(){k(),g(),h()},b=($("#j_products"),$("#j_statisticBar")),c=$("#j_cabinTab"),d=$("#j_orderList"),e=function(a){a.find("tbody").on("click",".btn-down",function(){var b=$(this),c=b.siblings(".num-box"),d=parseInt(c.val(),10),e=b.parents(".item-row"),f=e.data("max"),i=e.find(".item-people-num").find(".adult").find(".num-box"),j=e.find(".item-people-num").find(".child").find(".num-box");j.get(0)||(j=e.find(".item-child-num").find(".child").find(".num-box"));var l=e.find(".item-room-num").find(".room").find(".num-box"),m=parseInt(i.val(),10),n=parseInt(j.val(),10),o=parseInt(l.val(),10);m=m||0,n=n||0,o=o||0;var p=b.parent("span"),q="";p.hasClass("adult")?q="adult":p.hasClass("child")?q="child":p.hasClass("room")&&(q="room");var r=function(){var a=i.val(),b=j.val(),c=parseInt(a,10)+parseInt(b,10);0!==c&&(f>c?l.val(1):c%f===0?l.val(c/f):c%f>0&&l.val(parseInt((c/f).toString().split(".")[0],10)+1))};if("adult"==q)d>=1&&(1===d&&(j.val("0"),l.val("0")),c.val(d-1)),r();else if("child"===q)d>=1&&c.val(d-1),r();else if("room"===q&&d>=1){var s=i.val(),t=j.val(),u=parseInt(s,10)+parseInt(t,10),v=0;v=u%f===0?u/f:parseInt((u/f).toString().split(".")[0],10)+1,d>v&&c.val(d-1)}"j_cabinTab"===a.attr("id")?(k(),g(),h()):"j_orderList"===a.attr("id")})},f=function(a){a.find("tbody").on("click",".btn-up",function(){var b=$(this),c=b.siblings(".num-box"),d=parseInt(c.val(),10),e=b.parents(".item-row"),f=e.data("max"),i=e.find(".item-people-num").find(".adult").find(".num-box"),j=e.find(".item-people-num").find(".child").find(".num-box");j.get(0)||(j=e.find(".item-child-num").find(".child").find(".num-box"));var l=e.find(".item-room-num").find(".num-box"),m=parseInt(i.val(),10),n=parseInt(j.val(),10),o=parseInt(l.val(),10);m=m||0,n=n||0,o=o||0;var p=b.parent("span"),q="";p.hasClass("adult")?q="adult":p.hasClass("child")?q="child":p.hasClass("room")&&(q="room");var r,s=i.val(),t=j.val(),u=function(){var a=i.val(),b=j.val(),c=parseInt(a,10)+parseInt(b,10);0!==c&&(f>c?l.val(1):c%f===0?l.val(c/f):c%f>0&&l.val(parseInt((c/f).toString().split(".")[0],10)+1))};if("adult"==q)99>=d&&c.val(d+1),u();else if("child"===q){if(0===m)return;if(m>0){var v=parseInt(l.val(),10)*f;r=parseInt(s,10)+parseInt(t,10),v>r&&(c.val(d+1),u())}}else if("room"==q){if(0===m)return;r=parseInt(s,10)+parseInt(t,10),s>o&&c.val(d+1)}"j_cabinTab"===a.attr("id")?(k(),g(),h()):"j_orderList"===a.attr("id")})},g=function(){var a=[];c.find(".item-people-num").each(function(){var b=$(this),c=(b.find(".adult"),parseInt(b.find(".adult").find(".num-box").val(),10)),d=parseInt(b.find(".child").find(".num-box").val(),10),e=parseInt($.trim(b.siblings(".item-room-num").find(".num-box").val()),10),f=b.parent(".item-row").data("key"),g=b.parent(".item-row").data("max");if(c){var h=parseInt($.trim(b.siblings(".item-people").text()).replace("人",""),10),i=parseInt($.trim(b.siblings(".item-adult").text()).replace("￥",""),10),j=parseInt($.trim(b.siblings(".item-adult-ext").text()).replace("￥","").replace("--",""),10),k=parseInt($.trim(b.siblings(".item-child").text()).replace("￥","").replace("--",""),10),l=parseInt($.trim(b.siblings(".item-room-num").find(".num-box").val()),10);h=h||0,i=i||0,j=j||0,k=k||0,l=l||0;var m=b.siblings(".item-a").text(),n=c+d,o=2*e,p=0;o>=n?p=1===h?i*e:2*i*e:n>o&&(p=c>o?2*i*e+(c-o)*j+d*k:2*i*e+(d-(o-c))*k),i===j&&i===k&&(p=i*h*l),a.push("<tr class='item-row item-row-off' data-max='"+g+"' data-key='"+f+"' >"),a.push("<td>"+m+"</td>"),a.push("<td class='item-people-num'><span class='num-bar vm adult'><a class='btn-down' href='javascript:void(0);'>-</a><input type='text' readonly='readonly' maxlength='2' class='num-box tc' value='"+c+"'><a class='btn-up' href='javascript:void(0);'>+</a></span></td>"),a.push("<td class='item-child-num'><span class='num-bar vm child'><a class='btn-down' href='javascript:void(0);'>-</a><input type='text' readonly='readonly'  maxlength='2' class='num-box tc' value='"+d+"'><a class='btn-up' href='javascript:void(0);'>+</a></span></td>"),a.push("<td class='item-room-num'><span class='num-bar vm room'><a class='btn-down' href='javascript:void(0);'>-</a><input type='text' readonly='readonly'  maxlength='2' class='num-box tc' value='"+e+"'><a class='btn-up' href='javascript:void(0);'>+</a></span></td>"),a.push("<td class='verdana item-adult'>￥"+i+"</td>"),a.push("<td class='verdana item-adult-ext'>￥"+j+"</td>"),a.push("<td class='verdana item-child'>￥"+k+"</td>"),a.push("<td class='orange verdana unit-price'>￥"+p+"</td>"),a.push("<td><p class='operate-a'><a href='javascript:;' class='amend green vm'>修改</a><a href='javascript:void(0);' class='delete green vm'>删除</a></p></td>"),a.push("</tr>")}}),d.find("tbody").html(a.join(""))},h=function(){var a=d.find("tbody").find(".unit-price"),c=0;a.each(function(){var a=$(this);c+=parseInt(a.text().replace("￥",""),10)}),b.find(".total").text(c)},i=function(){var a=d.find("tbody");a.on("click",".amend",function(){var a=$(this),b=a.parents(".item-row"),d=b.data("key");if("修改"==a.text())b.removeClass("item-row-off"),b.addClass("item-row-on"),a.text("确定"),a.next(".delete").text("取消");else{b.removeClass("item-row-on"),b.addClass("item-row-off"),a.text("修改"),a.next(".delete").text("删除");var e=b.find(".adult").find(".num-box").val(),f=b.find(".child").find(".num-box").val(),i=b.find(".room").find(".num-box").val(),j=(b.data("max"),c.find(".item-row[data-key='"+d+"']"));j.find(".adult").find(".num-box").val(e),j.find(".child").find(".num-box").val(f),j.find(".room").find(".num-box").val(i),k(),g(),h()}})},j=function(){var a=d.find("tbody");a.on("click",".delete",function(){var a=$(this),b=a.parents(".item-row"),d=b.data("key");"删除"==a.text()?(b.remove(),c.find(".item-row[data-key='"+d+"']").find(".num-box").val("0"),k(),h()):(b.removeClass("item-row-on"),b.addClass("item-row-off"),a.prev(".amend").text("修改"),a.text("删除"))})},k=function(){var a=function(a){var b=0;return c.find("."+a).find(".num-box").each(function(a,c){var d=$(this);b+=parseInt(d.val(),10)}),b},d=0,e=0,f=0;d=a("adult"),e=a("child"),f=a("room"),b.find(".adult").find("b").text(d),b.find(".child").find("b").text(e),b.find(".room").find("b").text(f);var g=parseInt($("#hidStartOrderPersonNum").val(),10)||1;d>=g?$("#j_youlunSubmit").addClass("submit-order-on"):$("#j_youlunSubmit").removeClass("submit-order-on")};e(c),e(d),f(c),f(d),i(),j(),a()}function pOrderNumCheck(){var a=$("#j_cabinTab"),b=function(b){var c=a.find(".item-row[data-key='"+b+"']"),d=c.find(".item-room-num"),e=d.offset().left,f=d.offset().top,g=[];g.push("<div class='tip-box' id='j_youlunOrderNumTip'>"),g.push("<div class='tip-arrow'><em class='e1'>◆</em><em class='e2'>◆</em></div>"),g.push("<div class='tip-con'>成人数必须大于或等于所选房型房间数</div>"),g.push("</div>"),$("#j_youlunOrderNumTip").get(0)||$("body").append(g.join("")),$("#j_youlunOrderNumTip").css({top:f+53,left:e-65,display:"block"})},c=function(){var c=!0;return a.find(".item-row").each(function(){var a=$(this),d=a.attr("data-key"),e=a.find(".room").find(".num-box").val(),f=a.find(".adult").find(".num-box").val();return parseInt(e,10)>=1&&parseInt(e,10)>parseInt(f,10)?(c=!1,b(d),!0):void 0}),c};return c()}function productRouteDayScroll(){var a=$("#j_routeListWrap"),b=a.find(".route-list"),c=b.find("dl").length,d=6,e=function(a){if(b.stop(),c>d){var e=c-d,f=b.find("dl").eq(0).outerHeight(),g=e*f,h=function(){var c=b.css("margin-top").replace("px","");return"next"==a&&parseInt(c,10)<="-"+g?!1:"prev"==a&&parseInt(c,10)>=0?!1:void b.stop().animate({marginTop:("next"==a?"-=":"+=")+f+"px"},250,function(){})};h()}};a.parent().find(".next").on("click",function(){e("next")}),a.parent().find(".prev").on("click",function(){e("prev")})}$(function(){});
//# sourceMappingURL=/sourcemaps/content/v1/scripts/product/youlun.js.map