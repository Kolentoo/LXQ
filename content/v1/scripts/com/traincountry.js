/*! uzai - v0.1.11 - 2017 */

function comTrainCountry(){var a=$("input[data-countries-trigger]");if(a.get(0)){var b="uzwTrainCountries",c=function(){return $.ajax({url:_uzw.domain.wapi+"/api/uzaipassticket/countrylist",cache:!1,dataType:"jsonp"})};_util.localStorage.cache(b,1,c,function(a){a&&a.length&&(listRealTrainCountry=a)});var d=function(){$(".countries-select-mod").hide(),trainCountrySelect.remove()},e=function(a,b){var c=a.siblings(".countries-select-mod"),e=$.trim(a.val().toUpperCase());if(!e)return trainCountrySelect.hide(),void c.show();c.hide(),trainCountrySelect.show();var f=b.keyCode?b.keyCode:b.which;if("38"!=f&&"40"!=f){for(var g=[],h=0;h<listRealTrainCountry.length;h++){var i=listRealTrainCountry[h],j=i.a.toUpperCase(),k=i.b.toUpperCase(),l=i.c.toUpperCase();if((0===j.indexOf(e)||0===l.indexOf(e)||0===k.indexOf(e))&&(l?g.push('<li data-code="'+j+'"><span class="s1">'+l+'</span><span class="s2">'+j+"</span></li>"):g.push('<li data-code="'+j+'"><span class="s1">'+j+'</span><span class="s2">'+k+"</span></li>")),g.length>=10)break}trainCountrySelect.html(g.join(""))}trainCountrySelect.find("li").on("mouseenter",function(){var a=$(this),b=a.siblings("li");b.removeClass("on"),a.addClass("on")}).on("click",function(){var b=$(this),c=b.find(".s1").text(),e=b.attr("data-code");a.val(c),a.next("input").val(e),d()}),trainCountrySelect.find("li").not(".li-none").length<=0?(trainCountrySelect.empty(),trainCountrySelect.append("<li class='li-none'>找不到'"+e+"'</li>"),a.siblings("input:hidden").val("")):trainCountrySelect.find(".li-none").remove()},f=function(a){var b=trainCountrySelect.find("li").not(".li-none"),c=a.next("input"),e=b.filter(".on");e.get(0)||(e=b.eq(0));var f=e.find(".s1");a.val(f.text()),c.val(e.attr("data-code")),d()};a.on("blur",function(a){var b=$(this);if($.trim(b.val())){var c=b.next("input"),e=trainCountrySelect.find("li").not(".li-none");(1==e.length||e.eq(0).find(".s1").text()==b.val())&&(b.val(e.eq(0).find(".s1").text()),c.val(e.eq(0).attr("data-code")),d())}}),a.on("keyup",function(a){var b=$(this),c=b.next("input");c.val(""),e(b,a)});var g=function(a,b){var c=trainCountrySelect.find("li");if("down"===b)if(c.filter(".on").length){var e=c.filter(".on").next("li");c.removeClass("on"),e.get(0)?e.addClass("on"):c.eq(0).addClass("on")}else c.removeClass("on"),c.eq(0).addClass("on");else if("up"===b)if(c.filter(".on").length){var g=c.filter(".on").prev("li");c.removeClass("on"),g.get(0)?g.addClass("on"):c.last("li").addClass("on")}else c.removeClass("on"),c.last("li").addClass("on");else if("enter"===b)return f(a),d(),a.blur(),!1};a.on("keydown",function(a){var b=$(this),c=a.keyCode?a.keyCode:a.which;if("9"==c||"16"==c||"17"==c||"18"==c)return void $(".hot-city").hide();if("38"==c)g(b,"up");else if("40"==c)g(b,"down");else if("13"==c)return g(b,"enter"),!1});var h=function(){var a=(location.href.toLowerCase(),$("input[data-countries-trigger]").next("input:hidden"));a.each(function(a,b){var c=$(this),d=c.prev("input[data-countries-trigger]"),e=getCountryByCode(c.val());d.val(e)})};h()}}function getCountryByCode(a){if(a){for(var b="",c=0;c<listRealTrainCountry.length;c++){var d=listRealTrainCountry[c],e=d.a,f=d.b,g=d.c;if(f.toLowerCase()==a.toLowerCase()){b=g||e;break}}return b}return""}var listRealTrainCountry=[];
//# sourceMappingURL=/sourcemaps/content/v1/scripts/com/traincountry.js.map