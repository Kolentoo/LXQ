/*! uzai - v0.1.11 - 2017 */

function comGlobalCity(){var a=$("input[data-cities-trigger]");if(a.get(0)){var b="uzwGlobalCities",c=function(){return $.ajax({url:_uzw.domain.wapi+"/api/UzaiFlight/flightcitylist",cache:!1,dataType:"jsonp"})};_util.localStorage.cache(b,1,c,function(a){a&&a.length&&(listRealGlobalCity=a)});var d=function(){$(".cities-select-mod").hide(),globalCitySelect.remove()},e=function(a,b){var c=a.siblings(".cities-select-mod"),e=$.trim(a.val().toUpperCase());if(!e)return globalCitySelect.hide(),void c.show();c.hide(),globalCitySelect.show();var f=b.keyCode?b.keyCode:b.which;if("38"!=f&&"40"!=f){for(var g=[],h=0;h<listRealGlobalCity.length;h++){var i=listRealGlobalCity[h],j=i.a.toUpperCase(),k=i.b.toUpperCase(),l=i.c.toUpperCase(),m=i.d.toUpperCase();if((0===k.indexOf(e)||0===m.indexOf(e)||0===l.indexOf(e))&&g.push('<li data-code="'+j+'"><span class="s0 hide">'+m+'</span><span class="s1">'+k+'</span><span class="s2">'+(l||m)+"</span></li>"),g.length>=10)break}globalCitySelect.html(g.join(""))}globalCitySelect.find("li").on("mouseenter",function(){var a=$(this),b=a.siblings("li");b.removeClass("on"),a.addClass("on")}).on("click",function(){var b=$(this),c=b.find(".s1").text(),e=b.attr("data-code");a.val(c),a.next("input").val(e),d()}),globalCitySelect.find("li").not(".li-none").length<=0?(globalCitySelect.empty(),globalCitySelect.append("<li class='li-none'>找不到'"+e+"'</li>"),a.siblings("input:hidden").val("")):globalCitySelect.find(".li-none").remove()},f=function(a){var b=(a.val().toUpperCase(),globalCitySelect.find("li").not(".li-none")),c=a.next("input"),e=b.filter(".on");e.get(0)||(e=b.eq(0));var f=e.find(".s1");a.val(f.text()),c.val(e.attr("data-code")),d()};a.on("blur",function(a){var b=$(this);if($.trim(b.val())){var c=b.next("input"),e=globalCitySelect.find("li").not(".li-none");(1==e.length||e.eq(0).find(".s1").text()==b.val())&&(b.val(e.eq(0).find(".s1").text()),c.val(e.eq(0).attr("data-code")),d())}}),a.on("keyup",function(a){var b=$(this),c=b.next("input");c.val(""),e(b,a)});var g=function(a,b){var c=globalCitySelect.find("li");if("down"===b)if(c.filter(".on").length){var e=c.filter(".on").next("li");c.removeClass("on"),e.get(0)?e.addClass("on"):c.eq(0).addClass("on")}else c.removeClass("on"),c.eq(0).addClass("on");else if("up"===b)if(c.filter(".on").length){var g=c.filter(".on").prev("li");c.removeClass("on"),g.get(0)?g.addClass("on"):c.last("li").addClass("on")}else c.removeClass("on"),c.last("li").addClass("on");else if("enter"===b)return f(a),d(),a.blur(),!1};a.on("keydown",function(a){var b=$(this),c=a.keyCode?a.keyCode:a.which;if("9"==c||"16"==c||"17"==c||"18"==c)return void $(".hot-city").hide();if("38"==c)g(b,"up");else if("40"==c)g(b,"down");else if("13"==c)return g(b,"enter"),!1});var h=function(){var a=(location.href.toLowerCase(),$("input[data-cities-trigger]").next("input:hidden"));a.each(function(a,b){var c=$(this),d=c.prev("input[data-cities-trigger]"),e=getCityByCode(c.val());d.val(e)})};h()}}function getCityByCode(a){if(a){for(var b="",c=0;c<listRealGlobalCity.length;c++){var d=listRealGlobalCity[c],e=d.a,f=d.b,g=d.d;if(e.toLowerCase()==a.toLowerCase()){b=f||g;break}}return b}return""}var listRealGlobalCity=[];
//# sourceMappingURL=/sourcemaps/content/v1/scripts/com/globalcity.js.map