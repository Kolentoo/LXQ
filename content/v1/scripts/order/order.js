/*! uzai - v0.1.11 */

"use strict";function fixInputErr(){$(document).on("blur",".input-err",function(){var a=$(this);a.removeClass("input-err");var b=$("#j_lrfTips");b.text("")})}function orderSide(){var a=$("#j_side"),b=a.siblings(".main-box").height(),c=a.find(".order-listing-box"),d=a.find(".ycs-mod");a.find(".ycs-info-mod");if(c.get(0)&&!d.get(0)){var e=c.find(".deposit-bar"),f=0;e.get(0)&&(f=e.outerHeight(!0));var g=c.find(".order-listing"),h=$(".order-footer"),i=g.height(),j=c.offset().top,k=document.documentElement.clientHeight,l=k-117-f,m=0,n=0;i>l?g.height(l):"",n=c.outerHeight(),m=h.get(0)?h.offset().top-n-25:0,$(window).scroll(function(){o()});var o=function(){var a=$(window),d=a.scrollTop();b>n&&(d>=j?0!==m&&d>=m?c.css({position:"absolute",top:m}):_util.check.isIE6?c.css({top:d,position:"absolute"}):c.css({top:0,position:"fixed"}):c.css({top:0,position:"static"}))};o()}}function tab(a,b){var c=$("#"+a);if(c.get(0)?"":c=$("."+a),c.get(0)){var d=c.children(".hd");d.get(0)?"":d=c.children().children(".hd"),d.find("li").on("click",function(){var a=$(this),c=a.index(),d=a.siblings("li"),e=a.parents(".hd").siblings(".bd"),f=e.children(".item");d.removeClass("on"),a.addClass("on"),f.hide().eq(c).show(),b&&b()})}}function tipsInfo(){var a=function(a){var b=$("."+a);b.get(0)&&(b.each(function(){var a=$(this),b=a.height();a.find(".tips-close").css({"line-height":b+"px"})}),b.find(".tips-close").on("click",function(){var a=$(this);a.parents(".j_tipsBar").detach()}))};a("j_tipsBar");var b=function(){$(".travel-order").on("mouseover",".hover-wrap",function(){var a=$(this);a.addClass("hover-wrap-on")}).on("mouseout",".hover-wrap",function(){var a=$(this);a.removeClass("hover-wrap-on")})};b(),$(".important-tips").on("click",".close-wrap",function(){var a=$(this);a.parents(".important-tips").detach()});var c=$(".J_powerFloat");c.get(0)&&c.powerFloat({reverseSharp:!0})}function selectList(){var a=$(".j_selectItems"),b=$(".datalist-box"),c=b.width();a.find("li").on("click",function(){var a=$(this),b=a.siblings();b.removeClass("on"),a.addClass("on")}),b.find(".textbox").on("focus",function(){var a=$(this),c=b.find(".select-list-on");c.hide(),b.css({"z-index":"auto"}),a.siblings(".select-list").show().addClass("select-list-on"),a.parent().css({"z-index":100})}).on("change",function(){var a=$(this);a.siblings(".select-list").hide().removeClass("select-list-on"),a.parent().css({"z-index":"auto"})}).width(c-10)}function multiCalendar(){$("input[data-multi-calendar]").on("focus",function(){var a=$(this),b=location.href.toLowerCase();$(".after-calendar").hide();var c=a.parent(),d=c.find(".after-calendar");if(!d.get(0)){a.after('<div class="after-calendar ca-norm ca-norm-multi"></div>'),d=c.find(".after-calendar");var e={jsonpUrl:"",latestDate:"",skipDays:b.indexOf("otrains.uzai.com")>-1?7:0,extCallBack:function(b,c){d.find(".item").on("click",function(){var b=$(this),c=b.hasClass("item-expiry")||b.hasClass("item-gray")||b.hasClass("item-unused");if(!c){var e=b.attr("data-year"),f=b.attr("data-month"),g=b.attr("data-day");a.val(e+"-"+f+"-"+g),d.hide()}})},preCallback:function(a,b){}};d.jsonMultiCalendar(e)}d.show(),blankFix("j_afterCalendarWrap","after-calendar")})}function countryControl(){var a=$("#j_jpCountryListNode");$(".main-box").on("focus","input[data-countries-trigger]",function(){var b=$(this),c=b.next("input[type=hidden]");$(".countries-select-mod").hide(),$("#j_jpAllCountryFilter").remove();var d=b.parent(".countries-select-wrap"),e=b.siblings(".countries-select-mod");e.after('<ul class="hide city-filter-mod" id="j_jpAllCountryFilter"></ul>'),globalCountrySelect=$("#j_jpAllCountryFilter");var f=e.find(".countries-select-tab");f.get(0)||(e.html(a.html()),_uzw.ui.tab("countries-select-tab"),e.find(".select-item").on("click",function(){var a=$(this),f=a.find(".s1").text(),g=a.attr("data-code"),h=a.parents(".tips"),i=h.Validform();b.val(f),c.val(g),e.hide(),d.css({"z-index":"auto"}),i.check(!1,"input[data-countries-trigger]")&&h.find(".Validform_checktip").removeClass("Validform_wrong").addClass("Validform_right").text("")})),e.show(),d.css({"z-index":10}),blankFix("countries-select-wrap","countries-select-mod",function(){d.css({"z-index":"auto"}),$.trim(b.val())&&globalCountrySelect.find("li").not(".li-none").eq(0).click(),globalCountrySelect.remove()}),e.find(".close-wrap").on("click",function(){e.hide(),d.css({"z-index":"auto"})})}).on("blur","input[data-countries-trigger]",function(){var a=$(this),b=a.attr("nullmsg"),c=a.parent(".countries-select-wrap"),d=(a.next("input[type=hidden]").val(),$("#j_jpAllCountryFilter")),e=c.Validform();d.find(".li-none").get(0)&&a.val(""),c.css({"z-index":"auto"}),e.check(!1,"input[data-countries-trigger]")||c.find(".Validform_checktip").removeClass("Validform_right").addClass("Validform_wrong").text(b)})}function orderInvoice(){var a=document.getElementById("noNeedInvoice");a&&(a.checked=!0),$("#needInvoice").on("focus",function(){var a=$(this);a.parents(".info-listing").find(".hide").show()}),$("#noNeedInvoice").on("focus",function(){var a=$(this);a.parents(".info-listing").find(".hide").hide()});var b=document.getElementById("whetherInvoice");b&&(b.checked=!1),$("#whetherInvoice").on("change",function(){var a=$(this),c=a.parents(".invoice-info").find(".info-listing");b.checked?c.show():c.hide()});var c=document.getElementById("sameContacts");c&&(c.checked=!0),$("#sameContacts").on("focus",function(){var a=$(this);a.parents("li").find(".hide").hide()}),$("#notSameContacts").on("focus",function(){var a=$(this);a.parents("li").find(".hide").show()})}function orderRefund(){var a=$(".refund-main");if(a.get(0)){var b=a.find(".side").outerHeight(),c=a.find(".refund-box");b>c.outerHeight()&&c.outerHeight(b)}}function orderStore(){var a=$("#j_popStoreInfo"),b=$("#j_selectingStore"),c=$("#j_storeChoose"),d=$("#selectedStore"),e=c.find(".selecting-cont"),f=e.siblings(".btn-modify"),g=$(".store-item"),h=null,i=function(){_uzw.ui.mask.show(),a.show().on("click",".j_popClose",function(){_uzw.ui.mask.hide(),a.hide()}),fixIe6("j_popStoreInfo")};$("#j_btnStore").on("click",function(){i()}),f.on("click",function(){i()}),g.on("click",function(){var a=$(this);g.removeClass("on"),a.addClass("on")}),c.on("click",".store-item",function(){var a=$(this),b=a.find(".store-hd").text();e.text(b),h=a.find("input[name=cbStore]").val(),d.val(h),f.hasClass("hide")&&f.removeClass("hide")}),a.on("click",".store-item",function(){var a=$(this),c=a.find(".store-hd").text();b.val(c),h=a.find("input[name=cbStore]").val()}).on("click",".btn-confirm",function(){var a=($(this),$.trim(b.val()));a&&e.text(a),d.val(h),f.hasClass("hide")&&f.removeClass("hide")})}function contentSwitch(){var a=$("#j_side");a.find(".order-listing-box").find(".switch").on("click",function(){var a=$(this),b=a.find(".border-arrow"),c=a.parents(".mod-item-hd").next(".mod-item-bd").find(".order-listing-wrap");b.hasClass("on")?(b.removeClass("on"),c.hide()):(b.addClass("on"),c.show())}),a.find(".side-jipiao").find(".switch").on("click",function(){var a=$(this),b=a.find(".border-arrow"),c=a.parents(".mod-item-hd").next(".mod-item-bd").find(".line-item");b.hasClass("on")?(b.removeClass("on"),c.hide()):(b.addClass("on"),c.show())});var b=$("#j_addrInfoListing");if(b.get(0)){var c=b.find("input[name=addr]"),d=b.find("table.hide"),e=function(a){a.on("focus",function(){var a=$(this),b=a.parents("li");this.checked=!0,b.find(".hide-cont").show(),b.siblings("li").find(".hide-cont").hide()})};c[1].checked&&d.show().parents("li").siblings("li").find(".hide-cont").hide(),e(c.eq(0)),e(c.eq(1))}var f=document.getElementById("whetherVoucher");f&&(f.checked=!1),$("#whetherVoucher").on("change",function(){var a=$(this),b=a.parents(".reimburse-info").find(".hide");f.checked?b.show():b.hide()});var g=$("#j_changePassengerBar"),h=g.find(".err-tips"),i=$("#selAdult"),j=$("#selChild");i.on("focus",function(){h.text("")}),j.on("focus",function(){h.text("")}),g.on("click",".btn-change",function(){g.addClass("change-passenger-on")}).on("click",".btn-cancel",function(){g.removeClass("change-passenger-on")}).on("click",".btn-confirm",function(){var a,b=parseInt($.trim(i.val()),10),c=parseInt($.trim(j.val()),10),d=$("#hidParamaters"),e=!0;if(g.find(".select-box").each(function(){var a=$(this);a.val()!==a.attr("data-init-num")&&(e=!1)}),e)g.removeClass("change-passenger-on");else{if(!b&&!c)return h.text("请选择出行人数！"),!1;if(!b&&c)return h.text("儿童单独乘机需直接向航空公司购票！"),!1;if(b){if(b+c>9)return h.text("乘客人数须小于等于9人！"),!1;if(c/2>b)return h.text("目前只支持1个成人最多携带2名儿童！"),!1;a=window.confirm("乘客发生变动，需重新查询"),a&&(window.location.href="/UzaiFlight/List?startcity="+d.attr("data-startcity")+"&endcity="+d.attr("data-endcity")+"&fromDate="+d.attr("data-fromDate")+"&retDate="+d.attr("data-retDate")+"&adult="+b+"&child="+c+"&cabin="+d.attr("data-cabin"))}}})}function unitGanged(){var a=$("#j_addrInfoListing");if(a.get(0)){var b=a.find("select[name=sltCity]"),c=b.siblings("select[name=sltArea]"),d=b.siblings("select[name=sltShop]");$.ajax({type:"GET",cache:"false",url:"/mall/GetAddressList",dataType:"json",success:function(a){var e=a.listCity,f=e.length,g=b.siblings("address"),h=g.find(".addr-name"),i=[],j=[],k="",l=0,m=function(a,b){var c=b.length,d="";a[0].length=0;for(var e=0;c>e;e++)d+='<option value="'+b[e]+'">'+b[e]+"</option>";return d},n=function(a,b){var d=a[b].listArea,e=[];for(var f in d)e[f]=d[f].AreaName;var g=m(c,e);c.append(g),o(d,0)},o=function(a,b){var c=a[b].listStore,e=[];for(var f in c)e[f]=c[f].StoreName;var g=m(d,e);d.append(g),p(c,0)},p=function(a,b){h.val(a[b].StoreAddress)};if(e){for(var q=0;f>q;q++)a.IPAddress.indexOf(e[q].cityName)>=0&&(l=q),k+='<option value="'+e[q].cityName+'">'+e[q].cityName+"</option>";b.append(k).on("change",function(){var a=this.selectedIndex;i=e[a].listArea,n(e,a)}),c.on("change",function(){var a=this.selectedIndex;!i.length&&(i=e[l].listArea),j=i[a].listStore,o(i,a)}),d.on("change",function(){var a=this.selectedIndex;!i.length&&(i=e[l].listArea),!j.length&&(j=i[0].listStore),p(j,a)}),n(e,l),b.find("option").eq(l).prop("selected","selected")}},error:function(a){}})}}function fixIe8(a){_util.check.isIE678&&(a.hasClass("visibility-fix")?a.removeClass("visibility-fix"):a.addClass("visibility-fix"))}function fixIe6(a,b){var c=$("#"+a);c=c.get(0)?c:$("."+a),b=b||$(window).height()/2,_util.check.isIE6&&(c.css("top",$(document).scrollTop()+b),$(window).on("scroll",function(){c.css("top",$(document).scrollTop()+b)}))}function loadStoreDialogCity(){var a=$("#selectedStore").val();if(a>0){var b=$($("#j_popStoreInfo").find('input[name="cbStore"][value="'+a+'"]').parent()[0]),c=b.attr("data-city"),d=b.attr("data-area");c>0&&($("#selectStoreCity").val(c),setTimeout(function(){$("#selectStoreArea").val(d),document.getElementById("selectStoreArea").onchange(),b.click()},500))}}var globalCountrySelect=null,_orderCheckTips={show:function(a,b,c){var d=a.parent(".tb-wrap"),e="",f="";d.get(0)?(b&&d.find(".err-tips-cont").text(b),d.find(".err-tips").show()):(a.hasClass("ml10")?(a.removeClass("ml10"),e="ml10"):a.hasClass("ml5")&&(a.removeClass("ml5"),e="ml5"),f+='<span class="err-tips">',f+='<span class="err-tips-cont f666 f12">'+b+"</span>",f+='<span class="arrow-icon f14 songti lh1"><em>◆</em><i>◆</i></span>',f+="</span>",a.wrap('<span class="tb-wrap '+e+'"></span>'),a.parent(".tb-wrap").append(f)),c&&c()},hide:function(a,b){a.parent(".tb-wrap").find(".err-tips").hide(),b&&b()}};$(function(){orderSide(),tab("j_orderTab",function(){var a=$(".j_orderTab");if(_util.check.isIE678&&a.hasClass("store-tab")){var b=a.parents(".main-box");b.css({visibility:"visible"})}}),tipsInfo(),selectList(),multiCalendar(),countryControl(),orderInvoice(),orderRefund(),orderStore(),contentSwitch(),unitGanged(),"undefined"!=typeof window.comGlobalCountry&&window.comGlobalCountry(),fixInputErr(),"function"==typeof PCAS&&(new PCAS("province","city","area"),$("select[name=area1]").get(0)&&new PCAS("province1","city1","area1")),loadStoreDialogCity()});var orderLoading={show:function(){$(".order-loading").remove(),$("body").append("<div class='order-loading'><img src='"+_uzw.ui.preloader+"' </div>");var a=$(".order-loading");if(_util.check.isIE6){var b=$(window),c=function(){a.css({top:b.scrollTop()+b.height()/2-15})};a.show(),c(),$(window).scroll(function(){c()})}else a.show()},hide:function(){$(".order-loading").hide()}};
//# sourceMappingURL=/sourcemaps/content/v1/scripts/order/order.js.map