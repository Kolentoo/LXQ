/*! uzai - v0.1.11 - 2017 */

/*!
* 李云 2014-01-13 列表日历
* CODE:加私家团数据获取方式
* Copyright 2014,http://www.uzai.com/ JoJo
*/
function Calendars(){function GetBit(a,b){return a>>b&1}function showCal(a,b){(b===!1||"false"===b)&&(unlockNum=!1,numString="一二三四五六七八九十",monString="正二三四五六七八九十冬腊");var c=a.getFullYear(),d=a.getMonth()+1,e=a.getDate();a.getDay(),parseInt(a.getTime()/1e3,10);return 100>c&&(c="19"+c),GetLunarDay(c,d,e)}function GetLunarDay(a,b,c){return 1921>a||a>2020?"":(b=parseInt(b,10)>0?b-1:11,e2c(a,b,c),GetcDateString())}function e2c(){TheDate=3!==arguments.length?new Date:new Date(arguments[0],arguments[1],arguments[2]);var a,b,c,d,e=!1,f=TheDate.getYear();for(1900>f&&(f+=1900),a=365*(f-1921)+Math.floor((f-1921)/4)+madd[TheDate.getMonth()]+TheDate.getDate()-38,TheDate.getYear()%4===0&&TheDate.getMonth()>1&&a++,b=0;;b++){for(d=CalendarData[b]<4095?11:12,c=d;c>=0;c--){if(a<=29+GetBit(CalendarData[b],c)){e=!0;break}a=a-29-GetBit(CalendarData[b],c)}if(e)break}cYear=1921+b,cMonth=d-c+1,cDay=a,12==d&&(cMonth==Math.floor(CalendarData[b]/65536)+1&&(cMonth=1-cMonth),cMonth>Math.floor(CalendarData[b]/65536)+1&&cMonth--)}function GetcDateString(){var a=[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448],b="";return b+=tgString.charAt((cYear-4)%10),b+=dzString.charAt((cYear-4)%12),b+="(",b+=sx.charAt((cYear-4)%12),b+=")年 ",b="",1>cMonth?unlockNum===!1?(b+="(闰)",b+=monString.charAt(-cMonth-1)):b+=10>cMonth?"0"+(cMonth-2):cMonth-2:b+=unlockNum===!1?monString.charAt(cMonth-1):10>cMonth?"0"+cMonth:cMonth,unlockNum===!1?(b+="月",b+=11>cDay?"初":20>cDay?"十":30>cDay?"廿":"三十",(cDay%10!==0||10===cDay)&&(b+=numString.charAt((cDay-1)%10))):(b+=10>cDay?"0"+cDay:cDay,12===cMonth&&cDay==(16&a[cYear-1900]?30:29)&&(b="0100")),b}var ui,$this=this,$date=new Date,$weeks=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],$days=[31,28,31,30,31,30,31,31,30,31,30,31],$id=0,mineObject=function(){this.firstShow=!1,this.sjt=!1},regzhongwen=/[A-Za-z_\-\~\!\@\#\$\%\^\&\*\(\)\|\0-9]+/,SolarTermStr=new Array("小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"),DifferenceInMonth=new Array(1272060,1275495,1281180,1289445,1299225,1310355,1321560,1333035,1342770,1350855,1356420,1359045,1358580,1355055,1348695,1340040,1329630,1318455,1306935,1297380,1286865,1277730,1274550,1271556),V={"0101":"*1元旦","0214":"情人节","0305#":"学雷锋纪念日","0308":"妇女节","0312#":"植树节","0315#":"消费者权益日","0401#":"愚人节","0501":"*1劳动节","0504":"青年节","0601":"儿童节","0701":"建党节","0801":"建军节","0910":"教师节",1001:"*3国庆节",1224:"平安夜",1225:"圣诞节"},T={"0101":"*2春节","0115":"元宵节","0505":"*1端午节","0815":"*1中秋节","0707":"七夕","0909":"重阳节","1010#":"感恩节","1208#":"腊八节","0100":"除夕"};this.year=$date.getFullYear(),this.month=$date.getMonth()+1,this.date=$date.getDate(),this.isSolarTerm=!0,Calendars.isLeapYear=function(a){return a%4===0&&a%100!==0||a%400===0},this.createUI=function(){var a=document.createElement("TABLE"),b=document.createElement("TBODY"),c=document.createElement("A"),d=document.createElement("A");a.className="calendar",a.style.display="none",c.innerHTML=c.textContent="&lt;",c.className="subPrev",c.href="#",c.onclick=function(a){a=a||window.event;var b=new Date($this.year,$this.month,1);$this.year=$this.year,$this.month=$this.month-1,$this.date=b.getDate(),0===$this.month&&($this.year=$this.year-1,$this.month=12),mineObject.firstShow=!1,$this.change($this.year,$this.month,$this.date)},d.innerHTML=d.textContent="&gt;",d.className="subNext",d.href="#",d.onclick=function(a){a=a||window.event;var b=new Date($this.year,$this.month,1);$this.year=b.getFullYear(),$this.month=b.getMonth()+1,mineObject.firstShow=!1,$this.change($this.year,$this.month,$this.date)},a.appendChild(b);for(var e=0;8>e;++e){var f=document.createElement("TR");switch(e){case 0:f.className="calendar-title";break;case 1:f.className="calendar-weeks";break;default:f.className="calendar-week-days"}for(var g=0;7>g;++g){var h=document.createElement("TD");switch(0===g&&(h.className="calendar-td-sunday"),6===g&&(h.className="calendar-td-saturday"),e){case 0:switch(g){case 0:h.appendChild(c);break;case 1:g=5,h.colSpan="5",h.className="calendar-title-current-month";break;default:h.appendChild(d)}break;case 1:h.innerText=h.textContent=$weeks[g];break;default:h.innerText=h.textContent=" "}f.appendChild(h)}b.appendChild(f)}return a},this.change=function(year,month,date){var ToUrl="http://sh.uzai.com/outbound/calendar201208031417/"+year+"-"+month+"-01_"+$id+"_"+Math.random();mineObject.sjt&&(ToUrl="http://sijia.uzai.com/ashx/calendar.ashx?pid="+$id+"&pdate="+year+"-"+month+"-01&ran="+Math.random()),$.getScript(ToUrl,function(){$(".calendar").siblings(".loader").remove(),$(".calendar").show();var itinerary=eval("("+objCalendarDataArr+")");if(itinerary&&itinerary.data.length>=1){var dtime=itinerary.data[0].pdatetime.split("-");dtime.length>=2&&mineObject.firstShow&&(year=dtime[0],$this.year=year,month=Number(dtime[1]),$this.month=month)}ui.rows[0].children[1].innerText=ui.rows[0].children[1].textContent=year+" 年 "+month+" 月";for(var m=2;m<ui.rows.length;++m)for(var n=0;7>n;++n){var urc=ui.rows[m].children[n];urc.innerText=urc.textContent=""}for(var date=new Date(year,month-1,1),dayOfWeek=date.getDay(),day=1,days=$days[month-1]+(2==month&&Calendars.isLeapYear(year)?1:0),i=2;i<ui.rows.length;++i)for(var j=2==i?dayOfWeek:0;7>j;++j){var isToday=year==$date.getFullYear()&&month==$date.getMonth()+1&&day==$date.getDate(),nde=ui.rows[i].children[j];if(nde){nde.className=isToday?"calendar-box calendar-today":"calendar-box";var dayT="";if($this.isSolarTerm===!0){var tdate=new Date(date.getFullYear(),date.getMonth(),day);if(dayT=T[showCal(tdate,!0)],dayT=dayT?dayT:"",!dayT){var dayV=V[(parseInt(month,10)<10?"0"+parseInt(month,10):month.toString())+(10>day?"0"+day:day.toString())];if(dayT=dayV?dayV:"",!dayT){var dayJ=$this.jieqi(tdate);dayJ&&(dayT=dayJ?dayJ:"")}}dayT=dayT?dayT.replace(regzhongwen,""):""}var nDayT=dayT?"<i class='v-day' title='"+dayT+"'>"+dayT+"</i>":"";if(itinerary)for(var itr=0;itr<itinerary.data.length;itr++){var otime=itinerary.data[itr].pdatetime.split("-"),_day=new Date(otime[1]+"/"+otime[2]+"/"+otime[0]).getDate(),_month=new Date(otime[1]+"/"+otime[2]+"/"+otime[0]).getMonth()+1,_year=new Date(otime[1]+"/"+otime[2]+"/"+otime[0]).getFullYear();if(_day==day&&month==_month&&_year==year){nde.className=isToday?"calendar-box calendar-tag":"calendar-box";var time1=new Date(itinerary.data[itr].pdatetime.replace(/-/,"/").replace("-","/")),time2=new Date((new Date).setDate(parseInt((new Date).getDate(),10)+parseInt(itinerary.data[itr].hour,10)/24)),flag=time2>time1;if(flag)nde.textContent="<div class='item-data'>"+nDayT+"<i class='day'>"+day+"</i><i class='price'>￥"+itinerary.data[itr].price+"</font><i class='man'>已满</i></div>",nde.innerHTML=nde.textContent;else{var calTag="";if(itinerary.data[itr].CalendarTag){for(var arrTag=itinerary.data[itr].CalendarTag.split(","),k=0;k<arrTag.length;k++)"1"==arrTag[k]&&(calTag+="成团,");calTag&&(calTag=calTag.substring(0,calTag.length-1))}"-1"==itinerary.data[itr].price?(nde.textContext="<div class='item-data'>"+nDayT+"<i class='day'>"+day+"</i><a class='telephone' href=\""+$url+' " target="_blank" >请电询</a><i class=\'chengtuan\'>'+calTag+"</i></div>",nde.innerHTML=nde.textContext):"0"==itinerary.data[itr].cuteNum?(nde.textContext="<div class='item-data'>"+nDayT+"<i class='day'>"+day+"</i><a class='price' href=\""+$url+' " target="_blank" >'+(mineObject.sjt?"":"￥"+itinerary.data[itr].price)+"</a><i class='search'>"+(mineObject.sjt?"可以预定":"实时查询")+"</i><i class='chengtuan'>"+calTag+"</i></div>",nde.innerHTML=nde.textContext):"-1"==itinerary.data[itr].cuteNum?(nde.textContext="<div class='item-data'>"+nDayT+"<i class='day'>"+day+"</i><a class='price' href=\""+$url+' " target="_blank" >￥'+itinerary.data[itr].price+"</a><i class='chengtuan'>"+calTag+"</i></div>",nde.innerHTML=nde.textContext):(nde.innerHTML=nde.textContext="<div class='item-data'>"+nDayT+"<i class='day'>"+day+"</i><a class='price' href=\""+$url+'" target="_blank" >￥'+itinerary.data[itr].price+"</a><i class='chengtuan'>"+calTag+"</i><i class='yuwei'>余位",itinerary.data[itr].cuteNum>9?nde.textContext+=">9</i>":nde.textContext+=":"+itinerary.data[itr].cuteNum+"</i>",nde.innerHTML=nde.textContext+"</div>")}}}nde.innerHTML||(nde.innerHTML=nde.textContent="<td class='calendar-box'><div class='item-null'>"+nDayT+"<i class='day'>"+day+"</i></div></td>")}if(++day,day>days)return}})},this.jieqi=function(a){var b=31556926,c=new Date(1901);for(c.setTime(94712046e4);a.getFullYear()<c.getFullYear();)c.setTime(c.getTime()-1e3*b);for(;a.getFullYear()>c.getFullYear();)c.setTime(c.getTime()+1e3*b);for(var d=0;a.getMonth()>c.getMonth();d++)c.setTime(c.getTime()+1e3*DifferenceInMonth[d]);a.getDate()>c.getDate()&&(c.setTime(c.getTime()+1e3*DifferenceInMonth[d]),d++),a.getDate()>c.getDate()&&(c.setTime(c.getTime()+1e3*DifferenceInMonth[d]),23==d?d=0:d++);var e="";return a.getDate()==c.getDate()&&(e+=SolarTermStr[d]),e};var CalendarData=new Array(100),unlockNum=!0,madd=new Array(12),tgString="甲乙丙丁戊己庚辛壬癸",dzString="子丑寅卯辰巳午未申酉戌亥",numString="1234567890",monString="123456789",weekString="日一二三四五六",sx="鼠牛虎兔龙蛇马羊猴鸡狗猪",cYear,cMonth,cDay,TheDate;CalendarData=new Array(2635,333387,1701,1748,267701,694,2391,133423,1175,396438,3402,3749,331177,1453,694,201326,2350,465197,3221,3402,400202,2901,1386,267611,605,2349,137515,2709,464533,1738,2901,330421,1242,2651,199255,1323,529706,3733,1706,398762,2741,1206,267438,2647,1318,204070,3477,461653,1386,2413,330077,1197,2637,268877,3365,531109,2900,2922,398042,2395,1179,267415,2635,661067,1701,1748,398772,2742,2391,330031,1175,1611,200010,3749,527717,1452,2742,332397,2350,3222,268949,3402,3493,133973,1386,464219,605,2349,334123,2709,2890,267946,2773,592565,1210,2651,395863,1323,2707,265877),madd[0]=0,madd[1]=31,madd[2]=59,madd[3]=90,madd[4]=120,madd[5]=151,madd[6]=181,madd[7]=212,madd[8]=243,madd[9]=273,madd[10]=304,madd[11]=334,this.show=function(a,b,c,d,e){ui=ui||this.createUI(),$id=b,$url=c,mineObject.firstShow=!0,mineObject.sjt=c.lastIndexOf("sijia.uzai.com")>=1,!mineObject.sjt&&$(d).attr("data-url")&&(mineObject.sjt=$(d).attr("data-url").lastIndexOf("sijia.uzai.com")>=1);var f=a.id,g=f+"Mask",h=document.createElement("a");h.title="关闭",h.className="close",h.innerHTML=h.htmlContent="&times",h.onclick=function(){return $("#"+f).remove(),$("#"+g).remove(),!1},a.appendChild(h);var i=document.createElement("div");i.className="hd",i.innerHTML=i.htmlContent="请选择班期",a.appendChild(i);var j=document.createElement("div");j.className="bd",a.appendChild(j);var k=$("body").height();screen.width;if(e){var l=(document.documentElement.clientWidth+document.documentElement.scrollLeft,document.documentElement.clientHeight+document.documentElement.scrollTop,document.createElement("div"));l.id=g,l.style.position="absolute",l.style.top="0px",l.style.left="0px",l.style.height=k+"px",l.style.width="100%",l.style.opacity=".3",l.style.backgroundColor="#000000",l.style.zIndex=9998,l.style.filter+="progid:DXImageTransform.Microsoft.Alpha(opacity=30)",document.body.appendChild(l)}var m=document.createElement("div");m.className="loader",m.style.height="300px",m.style.backgroundImage="url("+_uzw.ui.preloader+")",m.style.backgroundRepeat="no-repeat",m.style.backgroundPosition="center center",i.appendChild(m),i.appendChild(ui),this.change(this.year,this.month,this.date)},this.toString=function(){}}
//# sourceMappingURL=/sourcemaps/content/libs/plugin/uzcalendar/uzcalendar.min.js.map