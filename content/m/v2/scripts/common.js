'use strict';var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};_uzm.web={init:function init(){_uzm.user.login();this.gdownapp();this.gDEV();this.gCheckTerminal();this.gPageScale();this.gFixTap();this.gTel();this.gMlinks();this.gTrackSource();this.gNotice();this.gBackAction();this.gUesrLoginStatus();this.gTopDownloadTip()},gdownapp:function gdownapp(){var source=_util.url.get('source'),devicetype=_util.url.get('devicetype'),downbtn=$('.com-footer-nav .block:last-child');if(downbtn.length!==0){downbtn.click(function(){var mlinks,code='AADe';var _terminal='wap';var _isWeixin=navigator.userAgent.toLowerCase().match(/micromessenger/i)=='micromessenger';if(_isWeixin){_terminal='weixin'}if(source==='android'||source==='iphone'||devicetype==='android'||devicetype==='iphone'){_terminal='app'}window.location.href='https://a.mlinks.cc/'+code+'?channel='+_terminal+'&&mw_ck='+_terminal})}},gDEV:function gDEV(){winLoadFix(function(){var ucc=_util.url.get('ucache');var evtArr=[];if(ucc){var uArr=ucc.split('|');for(var i=0;i<uArr.length;i++){var item=uArr[i];var ievt;if(item.indexOf(':')>-1){var ita=item.split(':')[0];var itb=item.split(':')[1];var evList=itb.split(',');for(var j=0;j<evList.length;j++){var sub=evList[j];if(ita==='cookie'){(function(evtArr,sub){evtArr.push(function(){window.alert(_uzm.cookie.get(sub))})})(evtArr,sub)}else if(ita==='delcookie'){_uzm.cookie.del(sub);(function(evtArr,sub){evtArr.push(function(){window.alert(sub+'\u7684cookie\u5DF2\u5220\u9664\uFF01')})})(evtArr,sub)}else if(ita==='param'){(function(evtArr,sub){evtArr.push(function(){var wsb=window[sub];if(wsb&&(typeof wsb==='undefined'?'undefined':_typeof(wsb))==='object'){window.alert(JSON.stringify(wsb))}else{if(!wsb){window.alert('\u6CA1\u6709\u627E\u5230\u53D8\u91CF'+sub)}else{window.alert(window[sub])}}})})(evtArr,sub)}}}else{switch(item){case'reload':location.reload(true);break;case'ua':ievt=function ievt(){window.alert(navigator.userAgent)};break;case'href':case'url':ievt=function ievt(){window.alert(decodeURIComponent(location.href))};break;case'css':ievt=function ievt(){_util.cdn.clear()};break;case'cookie':ievt=function ievt(){window.alert(document.cookie)};break;case'viewport':ievt=function ievt(){window.alert($('meta[name=viewport]').attr('content'))};break;}}evtArr.push(ievt)}}if(evtArr.length){for(var m=0;m<evtArr.length;m++){var msub=evtArr[m];msub&&msub()}}})},gBarCheck:{show:function show(){$('.fn-header').show();$('.fn-footer').show()},hide:function hide(){var hd=$('.fn-header');$('.fn-footer').hide();hd.hide();hd.next('section').css({'margin-top':'0'});var hdn=hd.next();if(hdn.css('position')==='absolute'){hdn.css({'top':0})}}},gCheckTerminal:function gCheckTerminal(){var apps=['iphone','ipad','android','wp'];var u=document.location.href.toLowerCase();var sce=_util.url.get('source');if(_uzm.mobile.isWeiXin){_terminal='weixin'}if(apps.indexOf(sce)>-1){_terminal='app';_uzm.terminal.version=_util.url.get('version');_uzm.terminal.channel=_util.url.get('channel');_uzm.terminal.phoneid=_util.url.get('phoneid');_uzm.terminal.from=_util.url.get('from');_uzm.terminal.userid=_util.url.get('userid');_uzm.terminal.token=_util.url.get('token');_uzm.terminal.city=_util.url.get('city');_uzm.terminal.tamper=_util.url.get('tamper')}if(sce){_uzm.cookie.set('uzmSource',sce,1)}else{if(_uzm.mobile.isWeiXin){_uzm.cookie.set('uzmSource',_terminal,1)}else{var ck=_uzm.cookie.get('uzmSource');if(ck){if(apps.indexOf(ck)>-1){_terminal='app'}}else{}}}if(_terminal=='app'||_terminal=='weixin'){this.gBarCheck.hide()}else if(_terminal==='wap'){this.gBarCheck.show()}},gPageScale:function gPageScale(){try{if(_scale){$('body').addClass('body-on');var ow=$('.w');var sh=0;var sw=_scale.width||640;var rem=_scale.rem||false;var width=window.screen.width||sw;var scale=width/sw;document.querySelector('meta[name=viewport]').setAttribute('content','target-densitydpi=device-dpi,width='+sw+',user-scalable=\'no\',initial-scale='+scale);sh=window.innerHeight||window.outerHeight||document.body.clientHeight||screen.height;if(_terminal=='app'&&_uzm.mobile.isAndroid){width<sw&&ow.width(sw);ow.height()<sh&&ow.height(sh)}if(rem){(function(doc,win){var docEl=doc.documentElement;var resizeEvt='orientationchange'in window?'orientationchange':'resize';var fts=[];var mps=[];var sigma=[5,10];for(var i=10;i<=36;i++){fts.push('.f'+i+'{font-size:'+i/10+'rem}')}for(var j=0;j<2;j++){var sig=sigma[j];mps.push('.m'+sig+'{margin:'+sig/10+'rem}');mps.push('.mt'+sig+'{margin-top:'+sig/10+'rem}');mps.push('.mr'+sig+'{margin-right:'+sig/10+'rem}');mps.push('.mb'+sig+'{margin-bottom:'+sigma[j]/10+'rem}');mps.push('.ml'+sig+'{margin-left:'+sigma[j]/10+'rem}');mps.push('.p'+sig+'{padding:'+sigma[j]/10+'rem}');mps.push('.pt'+sig+'{padding-top:'+sigma[j]/10+'rem}');mps.push('.pr'+sig+'{padding-right:'+sigma[j]/10+'rem}');mps.push('.pb'+sig+'{padding-bottom:'+sigma[j]/10+'rem}');mps.push('.pl'+sig+'{padding-left:'+sigma[j]/10+'rem}')}$('body').append('<style>'+(fts.join('')+mps.join(''))+'</style>');var recalc=function recalc(){var clientWidth=docEl.clientWidth;if(!clientWidth){return}docEl.style.fontSize=10*(clientWidth/sw)+'px'};if(!doc.addEventListener){return}if(_uzm.mobile.isPC){recalc()}win.addEventListener(resizeEvt,recalc,false);doc.addEventListener('DOMContentLoaded',recalc,false)})(document,window)}}}catch(ee){}},gFixTap:function gFixTap(){if(typeof Zepto=='function'){_tap=_uzm.mobile.isPC()?'click':'tap'}else{_tap='click'}},gTel:function gTel(){var gtl=$('.j_Gtel');if(!gtl.get(0)){}var dfr=function dfr(){return $.ajax({url:_uzm.domain.wapi+'/api/UzaiHotline/GetUzaiHotline',type:'GET',dataType:'jsonp',cache:true})};var ur=location.href.toLowerCase();try{ur=decodeURIComponent(ur)}catch(e){ur=unescape(ur)}var refer=document.referrer;ur=ur.replace(location.hash,'').replace('#','');ur=ur.split('?')[1];ur='?'+ur;var ckName='uzmCooperateSource';var unitCK=function unitCK(ckv){if(ckv){var ckArr=ckv.split(':');gtl.text(ckArr[1]||_hotline)}};var unitFixHotline=function unitFixHotline(item){if(window._uzw!=='undefined'){gtl.text(item.d||_hotline)}else{gtl.html('<a href="tel:'+(item.d||_hotline)+'" >'+(item.d||_hotline)+'</a>')}_uzm.cookie.set(ckName,item.a+':'+item.d+':'+item.e,1)};var unitEvt=function unitEvt(){if(ur){_util.localStorage.cache('uzmGtel',1,dfr,function(data){if(data){var lst=data.listUzaiDicTable;var items=[];var i,j,k,nt,ntArr,ntc,urlsid,iMin;urlsid=_util.url.get('sourceid');if(urlsid){for(i=0;i<lst.length;i++){var sid=lst[i].e;if(sid&&sid.toLowerCase()===urlsid.toLowerCase()){unitFixHotline(lst[i]);return}}}for(i=0,k=0;i<lst.length;i++){nt=decodeURIComponent(lst[i].b).toLowerCase();ntArr=nt.split('|');for(j=0;j<ntArr.length;j++){ntc=ntArr[j];if(ur.indexOf(ntc)>-1&&ur.toLowerCase().indexOf('reurl')<0){items[k]=lst[i];k++;break}}}iMin=items[0];if(iMin){for(i=0;i<items.length-1;i++){iMin=items[i].c<items[i+1].c?items[i]:items[i+1]}unitFixHotline(iMin);return}}unitCK(_uzm.cookie.get(ckName))})}else{unitCK(_uzm.cookie.get(ckName))}};if(!refer&&!ur){_uzm.cookie.del(ckName)}var sourceid=_util.url.get('sourceid');if(sourceid){_uzm.cookie.set(ckName,'::'+sourceid)}unitEvt()},gTrackSource:function gTrackSource(){var refer=document.referrer;var url=document.location.href.replace('#','').toLowerCase();var ckRName='uzmURLRefer';var vc=_uzm.cookie.get(ckRName);var cid,wi;if(refer){if(vc&&(vc.indexOf('utm_source=')>-1||vc.indexOf('utm_medium=')>-1)){if(url.indexOf('utm_source=')>-1||url.indexOf('utm_medium=')>-1){_uzm.cookie.set(ckRName,url,1)}}else{if(url.indexOf('utm_source=')>-1||url.indexOf('utm_medium=')>-1){_uzm.cookie.set(ckRName,url,1)}else{if(refer.indexOf('.uzai.com')<=-1){_uzm.cookie.set(ckRName,refer,1)}}}}else{if(!vc){_uzm.cookie.set(ckRName,url,1)}else{if(url.indexOf('utm_source=')>-1||url.indexOf('utm_medium=')>-1){_uzm.cookie.set(ckRName,url,1)}}}var cnl=_util.url.get('channel');var src=_util.url.get('src');if(cnl&&src){cid=_util.url.get('cid');wi=_util.url.get('wi');url=_util.url.get('url');_uzm.cookie.set('wapcps','{"src":"'+src+'","cid":"'+cid+'","wi":"'+wi+'","channel":"'+cnl+'","url":"'+url+'"}',30)}},gMlinks:function gMlinks(){if(_terminal==='app'){return}var pages=['//mdingzhi.uzai.com','//m.uzai.com/sale','//m.uzai.com/waptour-','//m.uzai.com/trip/wap/','//m.uzai.com/wd/?word=','//m.uzai.com/sh/youlun','//m.uzai.com/navlink/','//m.uzai.com/subject','//m.uzai.com/sh/outbound/','//m.uzai.com/bj/outbound/',_uzm.domain.m+'/'];var pagescode=['AA2v','AA2u','AA28','AA28','AA2s','AA2s','AA2t','AA2r','AA2s','AA2s','AADe'];var pageidx=-1;var gacode=['udesign','temai','detail','detail','list','youlun','shelf','campaign','main'];var pagelen=pagescode.length;var pagepfx='http://a.mlinks.cc/';var pagelink='';var ur=location.href.toLowerCase();var inArr=pages.some(function(item,idx,arr){if(idx!==pagelen-1){if(ur.indexOf(item)>-1){pagelink=pagepfx+pagescode[idx];pageidx=idx;return true}}else{if(location.origin+location.pathname+location.search===item){pagelink=pagepfx+pagescode[idx];pageidx=idx;return true}}});if(inArr){var gtip=$('.g-download-tip');var ck=_uzm.cookie.get('uzmGdownloadTip');if(!ck){if(!gtip.get(0)){var sb='';sb+='<div class=\'g-download-tip clearfix\'>';sb+='    <div class=\'fl\'>';sb+='    <div class=\'box clearfix\'>';sb+='        <div class=\'fl b\'><i class=\'close\'>&times;</i><img alt=\'\u4F17\u4FE1\u60A0\u54C9\u65C5\u6E38APP\' src=\''+_uzm.domain.cdnRandom()+'/content/v1/images/common/logo-icon.png\' class=\'logo\'></div>';sb+='        <div class=\'fl txt\'>';sb+='            <p class=\'p1 b\'>6999\u62A2\u6B27\u6D32\u6E38\uFF01</p>';sb+='            <p class=\'p2\'>\u4E0B\u8F7D\u4F17\u4FE1\u60A0\u54C9\u65C5\u6E38APP</p>';sb+='        </div>';sb+='    </div>';sb+='</div>';sb+='<div class=\'fr j_gAppDownload\' ></div>';sb+='</div>';$('body').prepend(sb);gtip=$('.g-download-tip');gtip.find('.close').on('click',function(){gtip.remove();$('#j_list').css({'top':$('#j_fnHeader').is(':visible')?$('#j_fnHeader').outerHeight():0});_uzm.cookie.set('uzmGdownloadTip','1',1);return false})}}if(typeof _scale!=='undefined'&&_scale.rem){gtip.addClass('g-download-tip-rem');$('.fn-header').addClass('fn-header-rem')}if(pagelink){pagelink+='?channel='+_terminal+'?mw_ck='+_terminal;if(window.mlPKG){var mlpkg=$.param(window.mlPKG);if(mlpkg){pagelink+='&'+mlpkg}}else{if(ur.indexOf('m.uzai.com/subject')>-1){var pdTemp=window.pageData||{};var cdis=$('meta[name="description"]').attr('content')||'';var cpic=$('meta[name="weixin-pic"]').attr('content')||'';var imgUrl=pdTemp.imgUrl||cpic||_uzm.domain.cdn+'/content/v1/images/common/logo-icon.png';imgUrl=location.protocol.toLowerCase()+imgUrl.replace('https://','').replace('http://','');var obj={isShare:1,topicName:pdTemp.title||document.title||'\u4F17\u4FE1\u60A0\u54C9\u65C5\u6E38',shareContent:pdTemp.desc||cdis||'\u4F17\u4FE1\u60A0\u54C9\u65C5\u6E38',activityUrl:pdTemp.link||location.href,topicsImgUrl:imgUrl};pagelink+='&'+$.param(obj)}}}var dlist=$('.j_gAppDownload');if(dlist.get(0)){if(_uzm.mobile.isWeiXin){dlist.html('<a  data-mlink="'+pagelink+'" href='+_uzm.domain.m+'/download" >\u6253\u5F00APP</a>')}else if(_uzm.mobile.isIphone){dlist.html('<a data-mlink="'+pagelink+'" href="'+_uzm.pkg.iphone+'"  onclick="ga(\'send\', \'event\' ,\''+(gacode[pageidx]||'')+'\' , \'click\', \'iphone_download\');">\u6253\u5F00APP</a>')}else if(_uzm.mobile.isIpad){dlist.html('<a data-mlink="'+pagelink+'" href="'+_uzm.pkg.ipad+'"  onclick="ga(\'send\', \'event\' ,\''+(gacode[pageidx]||'')+'\' , \'click\', \'iphone_download\');">\u6253\u5F00APP</a>')}else{dlist.html('<a data-mlink="'+pagelink+'" href="'+_uzm.pkg.android+'" onclick="ga(\'send\', \'event\' ,\''+(gacode[pageidx]||'')+'\' , \'click\', \'iphone_download\');">\u6253\u5F00APP</a>')}}}var mlprot=location.protocol.toLowerCase()==='https:'?'s':'a';if(!$('a[data-mlink]').get(0)){return}var unitEvent=function unitEvent(){var arr=[];$('a[data-mlink]').each(function(k,v){var o=$(this);var oh=o.attr('data-mlink');if(oh){var cnl=_util.url.get(oh,'mw_ck')||_util.url.get(oh,'channel');if(!cnl){var spe=oh.indexOf('?')>-1?'&':'?';cnl=spe+'mw_ck='+_terminal+'&channel='+_terminal}else{cnl=''}o.attr('href','javascript:void(0)');var obj={mlink:oh+cnl,button:o.get(0),autoRedirect:false};arr.push(obj)}});if(arr.length){new Mlink(arr)}};if(typeof Mlink==='function'){unitEvent()}else{_util.file.load('//'+mlprot+'.mlinks.cc/scripts/dist/mlink.min.js',function(){unitEvent()})}},gNotice:function gNotice(){var _gNoticePreScope={start:'2016/01/15 18:00:00',end:'2016/01/16 06:00:00'};var _gNoticeScope={start:'2016/01/15 23:00:00',end:'2016/01/16 06:00:00'};var _gNoticeInGAP=function _gNoticeInGAP(timeScope){var nd=Date.parse(new Date);var ndstart=Date.parse(timeScope.start);var ndend=Date.parse(timeScope.end);if(nd>=ndstart&&nd<=ndend){return true}return false};if(_gNoticeInGAP(_gNoticePreScope)){var _gNoticePop=function _gNoticePop(){var ckName='uzmNoticePop114';if(_uzm.cookie.get(ckName)){return}var words='<div class=\'tl\'><div class=\'tc f18 pb5\' style=\'line-height:20px;\'>\u7CFB\u7EDF\u7EF4\u62A4\u901A\u77E5</div><span class=\'red\'>1\u670815\u65E523:00\u81F31\u670816\u65E56:00</span>\u671F\u95F4\u8FDB\u884C\u7CFB\u7EDF\u7EF4\u62A4\uFF0C\u5C4A\u65F6\u90E8\u5206\u4EA7\u54C1\u5C06\u65E0\u6CD5\u8D2D\u4E70\uFF08\u4F46\u53EF\u6536\u85CF\uFF09\u3002\u7ED9\u60A8\u5E26\u6765\u4E0D\u4FBF\uFF0C\u656C\u8BF7\u8C05\u89E3\u3002</div>';_uzm.mask.show();_uzm.pop.confirm(words,function(){$('#g_toptipPop').hide();_uzm.mask.hide();_uzm.cookie.set(ckName,'1',7)})};_gNoticePop();if(_gNoticeInGAP(_gNoticeScope)){var zxFlag=$('#hidSupplierFlag').val();if(zxFlag=='008'){var btnos=$('#ordersubmit');btnos.hide();btnos.after('<input class=\'btn-order-maintain lh3 fr btn g5\' type=\'button\' value=\'\u7EF4\u62A4\u4E2D...\' />')}}}},gBackAction:function gBackAction(){var refer=document.referrer;$('.fn-header .back').on('click',function(){var o=$(this);var odis=o.attr('data-disable');if(!odis){var ourl=o.attr('data-url');if(ourl){location.href=ourl}else{if(refer.indexOf('.uzai.com')<=-1){location.href=_uzm.domain.m}else if(refer.indexOf('m.uzai.com/product')>-1){location.href='http://m.uzai.com/'}else{history.go(-1)}}}})},gUesrLoginStatus:function gUesrLoginStatus(){var o=$('#login-status');if(_uzm.cookie.get('user')){o.html('<a href=\''+_uzm.domain.u+'/mobile/order\'>'+_uzm.user.userName+'</a><a href=\''+_uzm.domain.u+'/mobile/logout\'>\u9000\u51FA</a>')}else{o.html('<a href=\''+_uzm.domain.u+'/mobile/login\'>\u767B\u5F55</a><a href=\''+_uzm.domain.u+'/mobile/reg\'>\u6CE8\u518C</a>')}},gTopDownloadTip:function gTopDownloadTip(){var status='hide';var b=_uzm.cookie.get('uzmTopDownTip');status=b?'hide':'show';if(_uzm.mobile.isUC){status='hide'}if(_terminal!=='wap'){status='hide'}var url=document.location.href.replace('#','');if(url.indexOf('waptour')>-1){status='hide'}if(url.indexOf('source=weixin')>-1||url.indexOf('source=pctour')>-1){status=b?'hide':'show'}if(_terminal!=='wap'){status='hide'}if(status=='hide')$('#smartBanner').hide();else $('#smartBanner').show();$('#smartBanner .sb-close').on('click',function(){_uzm.cookie.set('uzmTopDownTip','true',7);$('#smartBanner').hide()})}};$(function(){FastClick&&FastClick.attach(document.body);_uzm.web.init()});function blankFix(node,targetNode,callback){var evt=function evt(e){var nodeTag=$('#'+node).get(0)?'#tag,#tag *':'.tag,.tag *';nodeTag=_util.string.replaceAll(nodeTag,'tag',node);if(!$(e.target).is(nodeTag)){console.log(nodeTag);var tNode=$('#'+targetNode);if(!tNode.get(0)){tNode=$('.'+targetNode)}tNode.hide();$(document).unbind('click',evt);callback&&callback()}};$(document).bind('click',evt)}function winLoadFix(fn){if(fn){if(window.addEventListener){window.addEventListener('load',fn,false)}else{window.attachEvent('onload',fn)}}}
