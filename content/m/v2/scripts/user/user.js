'use strict';var ccFlag=false;var userexports={};userexports.init=function(){_util.file.load(_uzm.domain.cdnRandom()+'/content/m/v2/scripts/com/tab.js',function(){tab.init('j_forget');tab.init('j_depositCard');tab.init('j_myUb');tab.init('j_usuallyInfoTab');tab.init('j_loginTab')});userexports.login();userexports.reg();userexports.findPwd();userexports.updPwd();userexports.pwdSwitch();userexports.invitationCode();userexports.quickRegister();userexports.usuallyInfo();$('.user-form').on('submit',function(){return false})};var checkCaptcha=function checkCaptcha(o){var ov=o.val();var intR='^([+-]?)\\d*\\.?\\d+$';var nv=_util.string.replaceAll(ov,' ','');if(!ov){_uzm.pop.toast('\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801\uFF01');o.focus();ccFlag=false}else if(nv.match(intR)){$.ajax({type:'POST',url:'/mobile/validatePassCode',dataType:'json',cache:false,async:false,data:{'txtPassCode':nv},success:function success(data){if(data.status===1){ccFlag=true}else{_uzm.pop.toast(data.msg);o.focus();ccFlag=false}}})}else{_uzm.pop.toast('\u56FE\u5F62\u9A8C\u8BC1\u7801\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01');o.focus();ccFlag=false}};userexports.pwdSwitch=function(){$('.pwd-switch').on('click',function(){var oThis=$(this);var pwd=oThis.parent().find('[name=password]');if(oThis.hasClass('pwd-switch-on')){pwd.attr('type','password');oThis.removeClass('pwd-switch-on')}else{pwd.attr('type','text');oThis.addClass('pwd-switch-on')}})};userexports.addValidator=function(obj){var cbar=$('.check-bar');if(!obj.find('.check-bar').get(0)){var cbLen=cbar.length;var sHtml='';sHtml+='<li class="list-item clearfix">'+'<i class="icon-pen fl"></i>';if(cbLen>1){sHtml+='<label class="item-bd"><input type="tel" class="textbox check-bar f14 g10" id="txtPassCode'+(cbLen-1)+'" name="txtPassCode" placeholder="\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801" maxlength="4"></label>'}else{sHtml+='<label class="item-bd"><input type="tel" class="textbox check-bar f14 g10" id="txtPassCode" name="txtPassCode" placeholder="\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801" maxlength="4"></label>'}sHtml+='<span class="change-code item-side"><img src="/code" alt="\u770B\u4E0D\u6E05\uFF0C\u6362\u4E00\u5F20" onclick="javascript: this.src = \'/code?\' + Math.random()" /></span>'+'</li>';obj.find('.forms-listing').append(sHtml);$('.check-bar').focus()}};userexports.reg=function(){var reg=/^\d{4}$/;$('#j_regSubmit').on('click',function(){var oThis=$(this);var un=$('#username').val();var cp=$('#captcha').val();var pw=$('#password').val();var MRegToken=$('#MRegToken').val();if(!un){_uzm.pop.toast('\u8BF7\u8F93\u5165\u624B\u673A\u53F7');return false}else if(!new RegExp(_uzm.regex.mobile).test(un)){_uzm.pop.toast('\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165');return false}else if(!cp){_uzm.pop.toast('\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801');return false}else if(!reg.test(cp)){_uzm.pop.toast('\u9A8C\u8BC1\u7801\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165');return false}else if(!pw){_uzm.pop.toast('\u8BF7\u8F93\u5165\u5BC6\u7801');return false}$.ajax({cache:false,async:false,type:'POST',data:{'username':un,'captcha':cp,'password':pw,'MRegToken':MRegToken},url:'/mobile/UserRegReset',beforeSend:function beforeSend(XMLHttpRequest){oThis.attr('disabled','true').addClass('btn-off')},success:function success(data){if(data=='success'){var url=window.unescape(location.href.toLowerCase());_uzm.user.refresh();var id=_uzm.user.userid;var p=url.split('reurl=')[1];_uzm.pop.confirm('\u6CE8\u518C\u6210\u529F',function(){if(p){window.location.href=p.replace('*.',id+'.')}else{window.location.href=_uzm.domain.m}})}if(data&&data!='success'){_uzm.pop.toast(data);oThis.removeAttr('disabled').removeClass('btn-off')}},error:function error(XMLHttpRequest,textStatus,errorThrown){_uzm.pop.toast('\u72B6\u6001\uFF1A'+textStatus+'\uFF1B\u51FA\u9519\u63D0\u793A\uFF1A'+errorThrown);oThis.removeAttr('disabled').removeClass('btn-off')}})});$('#j_bindReg').find('.btn-item[type=submit]').on('click',function(){var oThis=$(this);var op=oThis.parents('.user-form');var un=op.find('input[name=username]').val();var cp=op.find('input[name=captcha]').val();var pwd=op.find('input[name=password]').val();var otpc=op.find('input[name=txtPassCode]');var MLoginToken=op.find('input[name=MLoginToken]').val();var tpc=otpc.val();if(!un){_uzm.pop.toast('\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01');return false}else if(!_uzm.regexForm.mobile(un)){_uzm.pop.toast('\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01');return false}else if(!cp){_uzm.pop.toast('\u8BF7\u8F93\u5165\u52A8\u6001\u5BC6\u7801\uFF01');return false}else if(!pwd){_uzm.pop.toast('\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01');return false}else if(pwd.length<6||pwd.length>16){_uzm.pop.toast('\u8BF7\u8F93\u51656-16\u4F4D\u5BC6\u7801\uFF01');return false}if(otpc.get(0)){ccFlag=false;checkCaptcha(otpc);if(!ccFlag){return false}}else{tpc=''}$.ajax({cache:false,async:false,type:'POST',url:'/mobile/UnionBindRegisterMobile',data:{'txtPhone':un,'pwd':cp,'txtPwd1':pwd,'txtPassCode':tpc},dataType:'json',beforeSend:function beforeSend(XMLHttpRequest){oThis.attr('disabled','true').addClass('btn-off')},success:function success(data){if(data.status===2){_uzm.pop.toast(data.msg)}else if(data.status===1){var url=window.unescape(location.href.toLowerCase());_uzm.user.refresh();var id=_uzm.user.userid;var p=url.split('reurl=')[1];_uzm.pop.confirm('\u6CE8\u518C\u6210\u529F',function(){if(p){window.location.href=p.replace('*.',id+'.')}else{window.location.href=data.msg}})}else{_uzm.pop.toast(data.msg)}oThis.removeAttr('disabled').removeClass('btn-off')},error:function error(XMLHttpRequest,textStatus,errorThrown){oThis.removeAttr('disabled').removeClass('btn-off')}})})};userexports.login=function(){$('#j_userLogin').find('.btn-item[type=submit]').on('click',function(){var oThis=$(this);var op=oThis.parents('.user-form');var un=op.find('input[name=username]').val();var pwd=op.find('input[name=password]').val();var otpc=op.find('input[name=txtPassCode]');var MLoginToken=op.find('input[name=MLoginToken]').val();var tpc=otpc.val();if(!un){_uzm.pop.toast('\u8BF7\u8F93\u5165\u624B\u673A\u53F7/\u90AE\u7BB1/\u4F17\u4FE1\u8D26\u53F7\uFF01');return false}else if(!pwd){_uzm.pop.toast('\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01');return false}else if(pwd.length<6||pwd.length>16){_uzm.pop.toast('\u8BF7\u8F93\u51656-16\u4F4D\u5BC6\u7801\uFF01');return false}if(otpc.get(0)){ccFlag=false;checkCaptcha(otpc);if(!ccFlag){return false}}else{tpc=''}$.ajax({cache:false,async:false,type:'POST',url:'/mobile/loginuserNew',data:{'username':un,'password':pwd,'txtPassCode':tpc,'MLoginToken':MLoginToken},dataType:'json',beforeSend:function beforeSend(XMLHttpRequest){oThis.attr('disabled','true').addClass('btn-off')},success:function success(data){if(data.status===2){_uzm.pop.toast(data.msg)}else if(data.status===1){var url=window.unescape(location.href.toLowerCase());_uzm.user.refresh();var id=_uzm.user.userid;var p=url.split('reurl=')[1];if(p){window.location.href=p.replace('*.',id+'.')}else{window.location.href=data.msg}}else{_uzm.pop.toast(data.msg)}oThis.removeAttr('disabled').removeClass('btn-off')},error:function error(XMLHttpRequest,textStatus,errorThrown){oThis.removeAttr('disabled').removeClass('btn-off')}})});$('#j_dynamicLogin').find('.btn-item[type=submit]').on('click',function(){var oThis=$(this);var op=oThis.parents('.user-form');var un=op.find('input[name=username]').val();var cp=op.find('input[name=captcha]').val();var otpc=op.find('input[name=txtPassCode]');var tpc=otpc.val();if(!un){_uzm.pop.toast('\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01');return false}else if(!_uzm.regexForm.mobile(un)){_uzm.pop.toast('\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01');return false}else if(!cp){_uzm.pop.toast('\u8BF7\u8F93\u5165\u52A8\u6001\u5BC6\u7801\uFF01');return false}if(!otpc.get(0)){tpc=''}$.ajax({cache:false,async:false,type:'POST',url:'/mobile/MobileDynamicLogin',data:{'txtPhone':un,'pwd':cp,'txtPassCode':tpc},dataType:'json',beforeSend:function beforeSend(XMLHttpRequest){oThis.attr('disabled','true').addClass('btn-off')},success:function success(data){if(data.status===1){var url=window.unescape(location.href.toLowerCase());_uzm.user.refresh();var id=_uzm.user.userid;var p=url.split('reurl=')[1];if(p){window.location.href=p.replace('*.',id+'.')}else{window.location.href=data.msg}}else{_uzm.pop.toast(data.msg)}oThis.removeAttr('disabled').removeClass('btn-off')},error:function error(XMLHttpRequest,textStatus,errorThrown){oThis.removeAttr('disabled').removeClass('btn-off')}})});$('#j_bindLogin').find('.btn-item[type=submit]').on('click',function(){var oThis=$(this);var op=oThis.parents('.user-form');var un=op.find('input[name=username]').val();var pwd=op.find('input[name=password]').val();var otpc=op.find('input[name=txtPassCode]');var tpc=otpc.val();if(!un){_uzm.pop.toast('\u8BF7\u8F93\u5165\u624B\u673A\u53F7/\u90AE\u7BB1/\u4F17\u4FE1\u8D26\u53F7\uFF01');return false}else if(!pwd){_uzm.pop.toast('\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01');return false}else if(pwd.length<6||pwd.length>16){_uzm.pop.toast('\u8BF7\u8F93\u51656-16\u4F4D\u5BC6\u7801\uFF01');return false}if(otpc.get(0)){ccFlag=false;checkCaptcha(otpc);if(!ccFlag){return false}}else{tpc=''}$.ajax({cache:false,async:false,type:'POST',url:'/mobile/UnionBindLoginMobile',data:{'txtPhoneMail':un,'txtPwd2':pwd,'txtPassCode':tpc,'subBind':false},dataType:'json',beforeSend:function beforeSend(XMLHttpRequest){oThis.attr('disabled','true').addClass('btn-off')},success:function success(data){if(data.status===-1){window.location.href=data.msg}else if(data.status===-3){_uzm.pop.toast(data.msg)}else if(data.status===-6){_uzm.pop.prompt(data.msg,function(flag){if(flag){$.ajax({cache:false,async:false,type:'POST',url:'/mobile/UnionBindLoginMobile',data:{'txtPhoneMail':un,'txtPwd2':pwd,'txtPassCode':tpc,'subBind':flag},dataType:'json',success:function success(data){if(data.status===-1){window.location.href=data.msg}else if(data.status===1){var url=window.unescape(location.href.toLowerCase());_uzm.user.refresh();var id=_uzm.user.userid;var p=url.split('reurl=')[1];if(p){window.location.href=p.replace('*.',id+'.')}else{window.location.href=data.msg}}else{_uzm.pop.toast(data.msg)}}})}})}else if(data.status===1){var url=window.unescape(location.href.toLowerCase());_uzm.user.refresh();var id=_uzm.user.userid;var p=url.split('reurl=')[1];if(p){window.location.href=p.replace('*.',id+'.')}else{window.location.href=data.msg}}else{_uzm.pop.toast(data.msg)}oThis.removeAttr('disabled').removeClass('btn-off')},error:function error(XMLHttpRequest,textStatus,errorThrown){oThis.removeAttr('disabled').removeClass('btn-off')}})})};userexports.findPwd=function(){var _countdown=function _countdown(obj){var btnRegain=obj.next('.btn-regain');var iTime=btnRegain.find('i');var _CI=0;if(_CI){clearInterval(_CI)}obj.hide();btnRegain.show();_CI=setInterval(function(){if(iTime.get(0)){var t=parseInt(iTime.text(),10);if(t<=0){obj.show();btnRegain.hide();iTime.text(60);clearInterval(_CI)}else{iTime.text(t-=1)}}},1000)};var _unitCountdown=function _unitCountdown(obj){var ot=obj.val();var iTime=60;var _CI=0;if(_CI){clearInterval(_CI)}_CI=setInterval(function(){if(iTime<=1){iTime=60;obj.removeClass('btn-off').val(ot);clearInterval(_CI)}else{iTime=--iTime;obj.addClass('btn-off').val(iTime+'\u540E\u91CD\u65B0\u53D1\u9001')}},1000)};$('#j_sendCheckCode').on('click',function(){var oThis=$(this);var un=$('#username').val();if(oThis.parents('.user-form').get(0)){return}var graphic=$('input[name=verificationCode]').val();if(!graphic){_uzm.pop.toast('\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801');return}if(!un){_uzm.pop.toast('\u8BF7\u8F93\u5165\u624B\u673A\u53F7');return}else if(_uzm.regexForm.mobile(un)){$.ajax({type:'POST',cache:false,async:false,data:{'username':un,'verificationCode':graphic},url:'/mobile/SendMobileRegCheckCode',success:function success(data){if(data=='success'){_uzm.pop.toast('\u9A8C\u8BC1\u7801\u5DF2\u901A\u8FC7\u77ED\u4FE1\u53D1\u7ED9\u60A8\uFF0C\u8BF7\u6CE8\u610F\u67E5\u6536');_countdown(oThis)}else{_uzm.pop.toast(data)}}})}else{_uzm.pop.toast('\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01');return false}});$('#j_sendCheckCode').on('click',function(){var oThis=$(this);var op=oThis.parents('.user-form');if(!op.get(0)||oThis.hasClass('btn-off')){return}var dt=oThis.attr('data-type');var oun=op.find('input[name=username]');var un=oun.val();var otpc=op.find('input[name=txtPassCode]');var tpc=otpc.val();var graphic=$('input[name=verificationCode]').val();if(!graphic){_uzm.pop.toast('\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801');return}var _sendCheckCode=function _sendCheckCode(){$.ajax({type:'POST',cache:false,async:false,data:{'txtPhone':un,'type':dt,'txtPassCode':tpc,'verificationCode':graphic},dataType:'json',url:'/mobile/SendMobileCode',success:function success(data){if(data.status===2){_uzm.pop.toast(data.msg)}else if(data.status===1){_uzm.pop.toast('\u52A8\u6001\u5BC6\u7801\u5DF2\u901A\u8FC7\u77ED\u4FE1\u53D1\u7ED9\u60A8\uFF0C\u8BF7\u6CE8\u610F\u67E5\u6536');_unitCountdown(oThis)}else{_uzm.pop.toast(data.msg)}}})};if(!oun.get(0)){un=op.find('.mobile-bar').find('em').text()}if(!un){_uzm.pop.toast('\u8BF7\u8F93\u5165\u624B\u673A\u53F7!');return}else if(_uzm.regexForm.mobile(un)){if(otpc.get(0)){ccFlag=false;checkCaptcha(otpc);ccFlag&&_sendCheckCode()}else{tpc='';_sendCheckCode()}}else{_uzm.pop.toast('\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01');return}});$('#j_sendCheck').on('click',function(){var oThis=$(this);var un=$('#username').val();var mobile=_uzm.regex.mobile;var email=_uzm.regex.email;var isValid1=new RegExp(mobile).test(un);var isValid2=new RegExp(email).test(un);var graphic=$('input[name=verificationCode]').val();if(!graphic){_uzm.pop.toast('\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801');return}if(!un){_uzm.pop.toast('\u8BF7\u8F93\u5165\u624B\u673A\u53F7/\u90AE\u7BB1');return}else if(isValid1){$.ajax({type:'POST',cache:false,async:false,data:{'username':un,'verificationCode':graphic},url:'/mobile/SendMobileFindPasswordCheckCode',beforeSend:function beforeSend(XMLHttpRequest){$('#j_sendCheck').attr('disabled','true');$('#j_sendCheck').addClass('btn-off')},success:function success(data){if(data=='success'){$('#j_sendCheck').removeClass('btn-off');$('#j_sendCheck').removeAttr('disabled');_uzm.pop.confirm('\u9A8C\u8BC1\u7801\u5DF2\u901A\u8FC7\u77ED\u4FE1\u53D1\u7ED9\u60A8\uFF0C\u8BF7\u6CE8\u610F\u67E5\u6536',function(){location.href='/mobile/UpdateMobilePassword?txtPhone='+un});_countdown($('#j_gainCheckCode'))}else{_uzm.pop.toast(data);$('#j_sendCheck').removeClass('btn-off');$('#j_sendCheck').removeAttr('disabled')}},error:function error(XMLHttpRequest,textStatus,errorThrown){_uzm.pop.toast('\u72B6\u6001\uFF1A'+textStatus+'\uFF1B\u51FA\u9519\u63D0\u793A\uFF1A'+errorThrown);$('#j_sendCheck').removeClass('btn-off');$('#j_sendCheck').removeAttr('disabled')}})}else if(isValid2){$.ajax({type:'POST',cache:false,async:false,data:{'username':un},url:'/mobile/SendEmailResetPassword',beforeSend:function beforeSend(XMLHttpRequest){$('#j_sendCheck').attr('disabled','true');$('#j_sendCheck').addClass('btn-off')},success:function success(data){if(data=='success'){_uzm.pop.toast('\u9A8C\u8BC1\u94FE\u63A5\u5DF2\u901A\u8FC7\u90AE\u4EF6\u53D1\u9001\u7ED9\u60A8\uFF0C\u8BF724\u5C0F\u65F6\u5185\u901A\u8FC7\u90AE\u4EF6\u5185\u7684\u9A8C\u8BC1\u94FE\u63A5\u4FEE\u6539\u5BC6\u7801')}else{_uzm.pop.toast(data)}$('#j_sendCheck').removeClass('btn-off');$('#j_sendCheck').removeAttr('disabled')},error:function error(XMLHttpRequest,textStatus,errorThrown){_uzm.pop.toast('\u72B6\u6001\uFF1A'+textStatus+'\uFF1B\u51FA\u9519\u63D0\u793A\uFF1A'+errorThrown);$('#j_sendCheck').removeClass('btn-off');$('#j_sendCheck').removeAttr('disabled')}})}else{_uzm.pop.toast('\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165');return false}});$('#j_gainCheckCode').on('click',function(){var oThis=$(this);var un=$('#hidPhone').val();var mobile=_uzm.regex.mobile;var isValid1=new RegExp(mobile).test(un);var graphic=$('input[name=verificationCode]').val();if(!graphic){_uzm.pop.toast('\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801');return}if(!un){_uzm.pop.toast('\u8BF7\u8F93\u5165\u624B\u673A\u53F7');return}else if(isValid1){$.ajax({type:'POST',cache:false,async:false,data:{'username':un,'verificationCode':graphic},url:'/mobile/SendMobileFindPasswordCheckCode',success:function success(data){if(data=='success'){_uzm.pop.toast('\u9A8C\u8BC1\u7801\u5DF2\u901A\u8FC7\u77ED\u4FE1\u53D1\u7ED9\u60A8\uFF0C\u8BF7\u6CE8\u610F\u67E5\u6536');_countdown(oThis)}else{_uzm.pop.toast(data)}},error:function error(XMLHttpRequest,textStatus,errorThrown){_uzm.pop.toast('\u72B6\u6001\uFF1A'+textStatus+'\uFF1B\u51FA\u9519\u63D0\u793A\uFF1A'+errorThrown)}})}else{_uzm.pop.toast('\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01');return false}})};userexports.updPwd=function(){$('#j_resetPwdMobile').on('click',function(){var reg=/^\d{4}$/;var username=$('#hidPhone').val();var cp=$('#captcha').val();var pw=$('#password').val();var MResetToken=$('#MResetToken').val();if(!username){_uzm.pop.toast('\u8F93\u5165\u624B\u673A\u53F7\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u627E\u56DE\u5BC6\u7801');return false}else if(!cp){_uzm.pop.toast('\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801');return false}else if(!reg.test(cp)){_uzm.pop.toast('\u9A8C\u8BC1\u7801\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165');return false}else if(!pw){_uzm.pop.toast('\u8BF7\u8F93\u5165\u5BC6\u7801');return}$.ajax({type:'POST',cache:false,async:false,data:{'username':username,'password':pw,'captcha':cp,'MResetToken':MResetToken},url:'/mobile/UpdateMobilePassword',success:function success(data){if(data=='success'){_uzm.pop.confirm('\u91CD\u7F6E\u5BC6\u7801\u6210\u529F',function(){window.location.href='/mobile/order'})}else{_uzm.pop.toast(data)}},error:function error(XMLHttpRequest,textStatus,errorThrown){_uzm.pop.toast('\u72B6\u6001\uFF1A'+textStatus+'\uFF1B\u51FA\u9519\u63D0\u793A\uFF1A'+errorThrown)}})});$('#j_resetPwdMail').on('click',function(){var email=$('#username').val();var pw=$('#password').val();if(!pw){_uzm.pop.toast('\u8BF7\u8F93\u5165\u5BC6\u7801');return}$.ajax({type:'POST',cache:false,async:false,data:{'email':email,'password':pw},url:'/mobile/EmailResetPassword',beforeSend:function beforeSend(XMLHttpRequest){$('#j_resetPwdMail').attr('disabled','true');$('#j_resetPwdMail').addClass('btn-off')},success:function success(data){if(data=='success'){_uzm.pop.confirm('\u91CD\u7F6E\u5BC6\u7801\u6210\u529F',function(){window.location.href=_uzm.domain.u+'/mobile/login'})}else{_uzm.pop.toast(data);$('#j_resetPwdMail').removeClass('btn-off');$('#j_resetPwdMail').removeAttr('disabled')}},error:function error(XMLHttpRequest,textStatus,errorThrown){_uzm.pop.toast('\u72B6\u6001\uFF1A'+textStatus+'\uFF1B\u51FA\u9519\u63D0\u793A\uFF1A'+errorThrown);$('#j_resetPwdMail').removeClass('btn-off');$('#j_resetPwdMail').removeAttr('disabled')}})});$('#j_mcPwdModify').on('click',function(){var oldPwd=$('#oldPwd').val();var newPwd=$('#newPwd').val();var rePwd=$('#rePwd').val();if(!oldPwd){_uzm.pop.toast('\u8BF7\u8F93\u5165\u65E7\u5BC6\u7801');return}else if(!newPwd){_uzm.pop.toast('\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801');return}else if(!rePwd){_uzm.pop.toast('\u8BF7\u8F93\u5165\u786E\u8BA4\u5BC6\u7801');return}else if(newPwd!=rePwd){_uzm.pop.toast('\u8BF7\u8F93\u5165\u786E\u8BA4\u5BC6\u7801');return}$.ajax({type:'POST',cache:false,async:false,data:{'oldPwd':oldPwd,'newPwd':newPwd,'rePwd':rePwd},url:'',success:function success(data){if(data=='success'){_uzm.pop.confirm('\u4FEE\u6539\u6210\u529F\uFF01')}else{_uzm.pop.toast(data)}}})});$('#j_dcPwdModify').on('click',function(){var cardNum1=$('#cardNum1').val();var oldPwd=$('#oldPwd').val();var newPwd=$('#newPwd').val();var rePwd=$('#rePwd').val();if(!cardNum1){_uzm.pop.toast('\u8BF7\u8F93\u5165\u5361\u53F7');return}else if(!oldPwd){_uzm.pop.toast('\u8BF7\u8F93\u5165\u65E7\u5BC6\u7801');return}else if(!newPwd){_uzm.pop.toast('\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801');return}else if(!rePwd){_uzm.pop.toast('\u8BF7\u8F93\u5165\u786E\u8BA4\u5BC6\u7801');return}else if(newPwd!=rePwd){_uzm.pop.toast('\u8BF7\u8F93\u5165\u786E\u8BA4\u5BC6\u7801');return}$.ajax({type:'POST',cache:false,async:false,data:{'cardNum1':cardNum1,'oldPwd':oldPwd,'newPwd':newPwd,'rePwd':rePwd},url:'',success:function success(data){if(data=='success'){_uzm.pop.confirm('\u4FEE\u6539\u6210\u529F\uFF01')}else{_uzm.pop.toast(data)}}})});$('#j_verifyOldMobile').find('.btn-item[type=submit]').on('click',function(){var oThis=$(this);var op=oThis.parents('.user-form');var un=op.find('.mobile-bar').find('em').text();var cp=op.find('input[name=captcha]').val();var otpc=op.find('input[name=txtPassCode]');var tpc=otpc.val();if(!cp){_uzm.pop.toast('\u8BF7\u8F93\u5165\u52A8\u6001\u5BC6\u7801\uFF01');return false}else{if(otpc.get(0)){ccFlag=false;checkCaptcha(otpc);if(!ccFlag){return false}}else{tpc=''}$.ajax({type:'POST',cache:false,async:false,data:{'txtPhone':un,'validateCode':cp,'txtPassCode ':tpc},dataType:'json',url:'/mobile/ModifyMobileStep1',beforeSend:function beforeSend(XMLHttpRequest){oThis.attr('disabled','true').addClass('btn-off')},success:function success(data){if(data.status===2){_uzm.pop.toast(data.msg)}else if(data.status===1){window.location.href=data.msg}else{_uzm.pop.toast(data.msg)}oThis.removeAttr('disabled').removeClass('btn-off')},error:function error(XMLHttpRequest,textStatus,errorThrown){oThis.removeAttr('disabled').removeClass('btn-off')}})}});$('#j_modifyMobile').find('.btn-item[type=submit]').on('click',function(){var oThis=$(this);var op=oThis.parents('.user-form');var un=op.find('input[name=username]').val();var cp=op.find('input[name=captcha]').val();var otpc=op.find('input[name=txtPassCode]');var tpc=otpc.val();if(!un){_uzm.pop.toast('\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01');return false}else if(!_uzm.regexForm.mobile(un)){_uzm.pop.toast('\u624B\u673A\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165\uFF01');return false}else if(!cp){_uzm.pop.toast('\u8BF7\u8F93\u5165\u52A8\u6001\u5BC6\u7801\uFF01');return false}else{if(otpc.get(0)){ccFlag=false;checkCaptcha(otpc);if(!ccFlag){return false}}else{tpc=''}$.ajax({type:'POST',cache:false,async:false,data:{'txtPhone':un,'validateCode':cp,'txtPassCode ':tpc},dataType:'json',url:'/mobile/ValidateOrModifyMobile',beforeSend:function beforeSend(XMLHttpRequest){oThis.attr('disabled','true').addClass('btn-off')},success:function success(data){if(data.status===-1){window.location.href=data.msg}else if(data.status===2){_uzm.pop.toast(data.msg)}else if(data.status===1){_uzm.pop.confirm('\u4FEE\u6539\u624B\u673A\u6210\u529F',function(){window.location.href=data.msg})}else{_uzm.pop.toast(data.msg)}oThis.removeAttr('disabled').removeClass('btn-off')},error:function error(XMLHttpRequest,textStatus,errorThrown){oThis.removeAttr('disabled').removeClass('btn-off')}})}})};userexports.findBalance=function(){$('#j_findBalance').on('click',function(){var cardNum=$('#cardNum').val();var password=$('#password').val();if(!cardNum){_uzm.pop.toast('\u8BF7\u8F93\u5165\u5361\u53F7');return}else if(!password){_uzm.pop.toast('\u8BF7\u8F93\u5165\u5BC6\u7801');return}$.ajax({type:'POST',cache:false,async:false,data:{'cardNum':cardNum,'password':password},url:'',success:function success(data){if(data=='success'){}else{_uzm.pop.toast(data)}}})})};userexports.invitationCode=function(){$('#j_invitation').on('click',function(){_uzm.pop.prompt('<p class="invitation-code"><input type="text" class="textbox tc" placeholder="\u8BF7\u8F93\u5165\u9080\u8BF7\u7801"></p>')})};userexports.quickRegister=function(){var rb=$('#j_registerBox');var pri=$('#j_popRegisterInfo');var regSpan=$('.air-success');var regDiv=$('.popup-success');var _CI=0;var _ajaxLoader={show:function show(){var css={'opacity':1,'z-index':1000};$('#j_ajaxLoader').remove();$('body').append('<div id="j_ajaxLoader"></div>');$('#j_ajaxLoader').css(css)},hide:function hide(){$('#j_ajaxLoader').css({'opacity':0,'z-index':-1})}};rb.find('.btn-gain').on('click',function(){var oThis=$(this);var mobile=$('input[name=mobile]').val();var r=_uzm.regex.mobile;var isValid=new RegExp(r).test(mobile);var graphic=$('input[name=verificationCode]').val();if(!graphic){_uzm.pop.toast('\u8BF7\u8F93\u5165\u56FE\u5F62\u9A8C\u8BC1\u7801');return}if(oThis.hasClass('btn-disabled')){return}if(!mobile){_uzm.pop.toast('\u8BF7\u8F93\u5165\u624B\u673A\u53F7');return}else if(!isValid){_uzm.pop.toast('\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7');return}_uzm.mask.show();_ajaxLoader.show();var _countdown=function _countdown(){var regainBar=rb.find('.regain-bar');var iTime=regainBar.find('i');if(_CI){clearInterval(_CI)}oThis.attr('disabled','disabled').addClass('btn-disabled');regainBar.show();_CI=setInterval(function(){if(iTime.get(0)){var t=parseInt(iTime.text(),10);iTime.text(t-=1)}},1000);setTimeout(function(){oThis.removeAttr('disabled').removeClass('btn-disabled');regainBar.hide();iTime.text(60);clearInterval(_CI)},60000)};$.ajax({type:'POST',cache:false,async:false,data:{'txtPhone':mobile,'type':'register','txtCheckCode':'none','verificationCode':graphic},url:'/SendMobileCheckCode',success:function success(data){_uzm.mask.hide();_ajaxLoader.hide();switch(data){case'-5':_uzm.pop.toast('\u9A8C\u8BC1\u7801\u4E0D\u80FD\u4E3A\u7A7A');break;case'-6':_uzm.pop.toast('\u9A8C\u8BC1\u7801\u9519\u8BEF');break;case'-2':goToLogin();break;case'-1':_uzm.pop.toast('\u9A8C\u8BC1\u7801\u53D1\u9001\u8FC7\u4E8E\u9891\u7E41\uFF0C\u8BF7\u660E\u5929\u518D\u8BD5');break;case'true':_uzm.pop.toast('\u9A8C\u8BC1\u7801\u5DF2\u53D1\u9001');_countdown();break;default:_uzm.pop.toast('\u53D1\u9001\u5931\u8D25');break;}},error:function error(){_uzm.mask.hide();_ajaxLoader.hide();_uzm.pop.toast('\u7F51\u7EDC\u5F02\u5E38');return}})});rb.find('.btn-submit').on('click',function(){$(this).focus();var mobile=$('input[name=mobile]').val();var valCode=$('input[name=validateCode]').val();var actCode=$('input[name=activityCode]').val();var verificationCode=$('input[name=verificationCode]').val();var r=_uzm.regex.mobile;var isValid=new RegExp(r).test(mobile);var sb=[];if(!mobile){_uzm.pop.toast('\u8BF7\u8F93\u5165\u624B\u673A\u53F7');return false}else if(!isValid){_uzm.pop.toast('\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7');return false}_uzm.mask.show();_ajaxLoader.show();var u='/mobile/ActivityRegAsy';$.ajax({url:u,type:'POST',data:'mobile='+mobile+'&validateCode='+valCode+'&activityCode='+actCode+'&verificationCode='+verificationCode,success:function success(data){_uzm.mask.hide();_ajaxLoader.hide();if(data&&data=='success'){_uzm.mask.show();$('.fn-mask').css({'height':'100%'});regSpan.show();regDiv.show();setTimeout(function(){_uzm.mask.hide();regSpan.hide();regDiv.hide();location.href=_uzm.domain.m},3000);regDiv.on('click',function(){_uzm.mask.hide();regSpan.hide();regDiv.hide();location.href=_uzm.domain.m})}else{_uzm.pop.toast(data)}},error:function error(){_uzm.mask.hide();_ajaxLoader.hide();_uzm.pop.toast('\u6CE8\u518C\u5931\u8D25')}});return false})};userexports.usuallyInfo=function(){$('.usually-info').on('click','.certify-item .side-del',function(){var oThis=$(this);oThis.parent('.certify-item').remove()});$('#j_addCertify').on('click',function(){var oThis=$(this);var sHtml='';sHtml+='<div class="certify-item slice-mod mt10 clearfix">'+'<span class="side-del fl"><i class="del-icon"></i></span>'+'<ul class="forms-listing f14">'+'<li class="list-item clearfix">'+'<label class="select-wrap">'+'<select name="" id="" class="select-box f14">'+'<option value="">\u62A4\u7167</option>'+'<option value="">\u8EAB\u4EFD\u8BC1</option>'+'<option value="">\u6E2F\u6FB3\u901A\u884C\u8BC1</option>'+'<option value="">\u53F0\u80DE\u8BC1</option>'+'<option value="">\u56DE\u4E61\u8BC1</option>'+'<option value="">\u519B\u4EBA\u8BC1</option>'+'</select>'+'</label>'+'<span class="side-tips f999 fr">\u987B\u4E0E\u8BC1\u4EF6\u4E00\u81F4</span>'+'</li>'+'<li class="list-item"><label class="item-bd"><em class="info-hd f666">\u8BC1\u4EF6\u6709\u6548\u671F</em><input type="date" class="textbox f14 tr g10" placeholder="\u987B\u4E0E\u8BC1\u4EF6\u4E00\u81F4"></label></li>'+'<li class="list-item"><label class="item-bd"><em class="info-hd f666">\u8BC1\u4EF6\u7B7E\u53D1\u5730</em><input type="text" class="textbox f14 tr g10" placeholder="\u987B\u4E0E\u8BC1\u4EF6\u4E00\u81F4"></label></li>'+'</ul>'+'</div>';oThis.parent().before(sHtml)})};$(function(){userexports.init()});
